

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction to Ada &mdash; intro-to-ada  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="intro-to-ada  documentation" href="index.html"/>
        <link rel="prev" title="Welcome to intro-to-ada" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> intro-to-ada
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction to Ada</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#history">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ada-today">Ada today</a></li>
<li class="toctree-l2"><a class="reference internal" href="#philosophy">Philosophy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#imperative-language">Imperative language</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imperative-language-loops">Imperative language - Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#for-loops">For loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bare-loops">Bare loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#while-loops">While loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#imperative-language-if-else">Imperative language - If/Else</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imperative-language-case-statement">Imperative language - Case statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imperative-language-declarative-regions">Imperative language - Declarative regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imperative-language-control-expressions">Imperative language - control expressions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#if-expressions">If expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-expressions">Case expressions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#strongly-typed-language">Strongly typed language</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-a-type">What is a type?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integers">Integers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operational-semantics">Operational semantics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#unsigned-types">Unsigned types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enumerations">Enumerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#floating-point-and-fixed-point-types">Floating-point and fixed-point types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#floating-point-types">Floating-point types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#precision-of-floating-point-types">Precision of floating-point types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#range-of-floating-point-types">Range of floating-point types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decimal-fixed-point-types">Decimal fixed-point types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fixed-point-types">Fixed-point types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#strong-typing">Strong typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#character-types">Character types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#new-types">New types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subtypes">Subtypes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#records">Records</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#record-type-declaration">Record type declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregates">Aggregates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#component-selection">Component selection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#arrays">Arrays</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#array-type-declaration">Array type declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#indexation">Indexation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simpler-array-declarations">Simpler array declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#range-attribute">Range attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unconstrained-arrays">Unconstrained arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predefined-array-type-string">Predefined array type: String</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#declaring-arrays-2">Declaring arrays (2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#array-slices">Array slices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#modular-structured-programming">Modular/Structured programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#packages">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-package">Using a package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#package-body">Package body</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#subprograms">Subprograms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Subprograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subprogram-calls">Subprogram calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-calls">Function calls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parameters-modes">Parameters modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Subprogram calls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#in-parameters">In parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#in-out-parameters">In-out parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#out-parameters">Out parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forward-declaration-of-subprograms">Forward declaration of subprograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nested-subprograms">Nested subprograms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#more-about-types">More about types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aggregates-a-primer">Aggregates: A primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overloading-and-qualified-expressions">Overloading and qualified expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access-types-pointers">Access types (pointers)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#allocation-by-type">Allocation (by type)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dereferencing">Dereferencing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-deallocation">Automatic deallocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-features">Other features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mutually-recursive-types">Mutually recursive types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-about-records">More about records</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dynamically-sized-record-types">Dynamically sized record types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#records-with-discriminant">Records with discriminant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#records-with-variant">Records with variant</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#privacy">Privacy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-encapsulation">Basic encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#abstract-data-types">Abstract data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limited-types">Limited types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#generics">Generics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#formal-type-declaration">Formal type declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formal-object-declaration">Formal object declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generic-body-definition">Generic body definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generic-instantiation">Generic instantiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generic-packages">Generic packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formal-subprograms">Formal subprograms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples-of-using-generics">Examples of using generics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#application-adts">Application: ADTs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abstracting-a-swap-algorithm">Abstracting a swap algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abstracting-a-reversing-algorithm">Abstracting a reversing algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abstracting-the-test-application">Abstracting the test application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#exceptions">Exceptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#exception-declaration">Exception declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raising-an-exception">Raising an exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-an-exception">Handling an exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predefined-exceptions">Predefined exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#tasking">Tasking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tasks">Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-task">Simple task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-synchronization">Simple synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delay">Delay</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synchronization-rendez-vous">Synchronization: rendez-vous</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-loop">Select loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cycling-tasks">Cycling tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#protected-objects">Protected objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-object">Simple object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#entries">Entries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#task-and-protected-types">Task and protected types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-types">Task types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protected-types">Protected types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#interfacing-with-c-and-c">Interfacing with C and C++</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#multi-language-project">Multi-language project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-convention">Type convention</a></li>
<li class="toctree-l2"><a class="reference internal" href="#foreign-subprograms">Foreign subprograms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calling-c-subprograms-in-ada">Calling C subprograms in Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calling-ada-subprograms-in-c">Calling Ada subprograms in C</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#foreign-variables">Foreign variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-c-global-variables-in-ada">Using C global variables in Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-ada-variables-in-c">Using Ada variables in C</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generating-bindings">Generating bindings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adapting-bindings">Adapting bindings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interfacing-with-c">Interfacing with C++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c-symbol-mangling">C++ symbol mangling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-classes">C++ classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#object-oriented-programming">Object oriented programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#newtypes">Newtypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tagged-types">Tagged types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classwide-types">Classwide types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dispatching-operations">Dispatching operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dot-notation">Dot notation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#standard-library">Standard library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#standard-package">Standard package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#containers">Containers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vectors">Vectors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#instantiation">Instantiation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#appending-and-prepending-elements">Appending and prepending elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-first-and-last-elements">Accessing first and last elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iterating">Iterating</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finding-and-changing-elements">Finding and changing elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inserting-elements">Inserting elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#removing-elements">Removing elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-operations">Other Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sets">Sets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialization-and-iteration">Initialization and iteration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operations-on-elements">Operations on elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Other Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#indefinite-maps">Indefinite maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hashed-maps">Hashed maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ordered-maps">Ordered maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complexity">Complexity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dates-times">Dates &amp; Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="#strings">Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#files-and-streams">Files and streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamic-allocation-and-reclamation">Dynamic allocation and reclamation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#appendices">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#appendix-a-generic-formal-types">Appendix A: Generic Formal Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#indefinite-version">Indefinite version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-b-containers">Appendix B: Containers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">intro-to-ada</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction to Ada</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro_to_ada.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-to-ada">
<h1>Introduction to Ada<a class="headerlink" href="#introduction-to-ada" title="Permalink to this headline">¶</a></h1>
<p>This document is a concise introduction to the Ada language, for people
who already have some experience with programming. It will go over the
important concepts of Ada in the order that made the most sense writing
it.</p>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<p>In the seventies, the American department of Defense suffered from an
explosion of the number of languages, each team using a different set of
idioms/scripts. The DOD decided to solve this by issuing a request for
proposal to big companies of the time. The proposal that was selected by
the DOD in the end was Jean Ichbiah’s proposal, on behalf of HoneyWell
bull.</p>
<p>The first standard for the language was issued in 1983, with revisions
being made in 1995, 2005 and 2012, each time adding major features to
the language.</p>
<p>This tutorial will focus on Ada 2012 as a whole, rather than teach
different versions of the language.</p>
</div>
<div class="section" id="ada-today">
<h2>Ada today<a class="headerlink" href="#ada-today" title="Permalink to this headline">¶</a></h2>
<p>Today, Ada is mainly used in real-time/safety critical systems, with a
general focus on embedded systems. While Ada is and can be used as a
general purpose language, it will really shine in low level
applications:</p>
<ul class="simple">
<li>Embedded systems with low memory requirements (no garbage collector
allowed).</li>
<li>Direct interfacing with hardware.</li>
<li>Soft or hard real-time systems.</li>
<li>Low level systems programming.</li>
</ul>
<p>This list is intentionally abstract. Today,  Ada has certain domains /
niches where it is used a lot, like Aerospace &amp; Defense, civil aviation,
public transportation, etc. These are domains that require a high degree
of safety: a software defect in this kind of applications are not just an
annoyance, but may have severe consequences. Ada provides safety features
that allow for detecting defects at an early stage — usually, at
compilation time or using static analysis tools. In addition, Ada can also
be used in to create applications in varied categories, such as:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/AdaDoom3/AdaDoom3">Video game programming</a></li>
<li><a class="reference external" href="http://www.electronicdesign.com/embedded-revolution/assessing-ada-language-audio-applications">Real-time audio</a></li>
<li><a class="reference external" href="http://www.nihamkin.com/tag/kernel.html">Kernel modules</a></li>
</ul>
<p>This is a non-comprehensive list that hopefully sheds light on which
kind of programming Ada is good at.</p>
<p>In terms of modern languages, the closest in terms of targets and level
of abstraction are probably
<a class="reference external" href="https://fr.wikipedia.org/wiki/C%2B%2B">C++</a> and
<a class="reference external" href="https://www.rust-lang.org/en-US/">Rust</a>.</p>
</div>
<div class="section" id="philosophy">
<h2>Philosophy<a class="headerlink" href="#philosophy" title="Permalink to this headline">¶</a></h2>
<p>A word should be said about Ada’s philosophy, because it is very
different from the one of a lot of other languages. In Ada it is
considered that:</p>
<ul>
<li><p class="first">Readability is more important than conciseness. Syntactically this
shows through the fact that keywords are preferred to symbols, that no
keyword is an abbreviation, etc.</p>
</li>
<li><p class="first">Very strong typing. It is very easy to introduce new types in Ada,
sometimes more than reusing existing ones.</p>
<blockquote>
<div><p>It is in the same ball-park as many functional languages in that regard,
except that the programmer has to be much more explicit about typing, because
there is almost no type inference.</p>
</div></blockquote>
</li>
</ul>
<ul class="simple">
<li>Explicit is better than implicit: Although weirdly this is a
<a class="reference external" href="www.TODOpython.com">Python</a> commandment, Ada takes it way further
than any language we know of:<ul>
<li>There is mostly no structural typing, and most types need to be
explicitly named by the programmer.</li>
<li>As previously said, mostly no type inference.</li>
<li>Semantics are very well defined, and undefined behavior is limited
to an absolute minimum.</li>
<li>The programmer can generally give a <em>lot</em> of information about
what his program means to the compiler (and other programmers).
This allows the compiler to be extremely helpful (read: strict)
with the programmer.</li>
</ul>
</li>
</ul>
<p>During this course, we will explain the individual language features that
are building blocks for that philosophy.</p>
</div>
</div>
<div class="section" id="imperative-language">
<h1>Imperative language<a class="headerlink" href="#imperative-language" title="Permalink to this headline">¶</a></h1>
<p>Ada is a multi-paradigm language, but at it’s core, it contains a
simple, coherent procedural/imperative language akin to C or Pascal.</p>
<blockquote>
<div>One important distinction with a language like C is that statements
and expressions are very clearly distinguished.</div></blockquote>
<div class="section" id="hello-world">
<h2>Hello world<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<p>Let’s go over a very simple imperative Ada program:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="c1">--  Print &quot;Hello, World!&quot; to the screen</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>If you compile that source with the GNAT compiler, you will get a pretty
unsurprising result.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ gprbuild greet.adb
using project file <span class="o">[</span>...<span class="o">]</span>_default.gpr
Compile
   <span class="o">[</span>Ada<span class="o">]</span>          greet.adb
Bind
   <span class="o">[</span>gprbind<span class="o">]</span>      greet.bexch
   <span class="o">[</span>Ada<span class="o">]</span>          greet.ali
Link
   <span class="o">[</span>link<span class="o">]</span>         greet.adb

 $ ./greet
Hello, World!
 %
</pre></div>
</div>
<p>There are several note worthy things in the above program:</p>
<ul class="simple">
<li>A subprogram in Ada can be either a procedure or a function. A
procedure, as used above, does not return a value when called. This is
similar to functions in C/C++ that return <code class="code c docutils literal notranslate"><span class="keyword type"><span class="pre">void</span></span></code>. We’ll see later how
to declare functions in Ada.</li>
<li><code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code> and <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> are used to reference external packages in
the procedure. This is similar to <code class="docutils literal notranslate"><span class="pre">import</span></code> in various languages or
roughly similar to <code class="code c docutils literal notranslate"><span class="comment preproc"><span class="pre">#include</span></span></code> in C/C++.
We’ll see later how they work in detail. Here, we are requesting a
standard library module which contains a procedure to print text on the
screen: <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Put_Line</span></span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">Greet</span></code> is a procedure, and the main entry point for our first
program. Unlike in C or C++, it can be named anything you prefer. The
builder will determine the entry point. In our simple example,
<code class="docutils literal notranslate"><span class="pre">gprbuild</span></code>, GNAT’s builder, will use the file you passed as
parameter.</li>
<li><code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Put_Line</span></span></code> is a procedure, just like <code class="docutils literal notranslate"><span class="pre">Greet</span></code>, except it is
imported from the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Ada</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Text_IO</span></span></code> module. It is the Ada equivalent
of C’s <code class="code c docutils literal notranslate"><span class="name"><span class="pre">printf</span></span></code>.</li>
<li>Comments start with <code class="code ada docutils literal notranslate"><span class="comment single"><span class="pre">–</span></span></code> and go to the end of the line. There is
no multi-line comment syntax, that is, it is not possible to start a
comment in one line and continue it in the next line. The only way to
create multiple lines of comments in Ada is by using <code class="code ada docutils literal notranslate"><span class="comment single"><span class="pre">–</span></span></code> on each
line. For example:</li>
</ul>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="c1">--  We start a comment in this line...</span>
<span class="c1">--  and we continue on the second line...</span>
</pre></div>
</div>
</div>
<div class="section" id="imperative-language-loops">
<h2>Imperative language - Loops<a class="headerlink" href="#imperative-language-loops" title="Permalink to this headline">¶</a></h2>
<p>Ada has three ways of specifying loops. None of them behave like the
C/Java/Javascript for-loop though. Their semantic is much more restricted,
which is in line with Ada’s philosophy.</p>
<div class="section" id="for-loops">
<h3>For loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h3>
<p>The first kind of loop is the for loop. It allows to iterate through a
discrete range.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span> <span class="c1">-- Procedure call</span>
      <span class="c1">--        ^ Procedure parameters</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>A few things to note:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">..</span> <span class="pre">10</span></code> is a discrete range, from <code class="docutils literal notranslate"><span class="pre">1</span></code> to <code class="docutils literal notranslate"><span class="pre">10</span></code> included.</li>
<li>It is bound to the name <code class="docutils literal notranslate"><span class="pre">I</span></code> in the body of the loop.</li>
<li>Here, <code class="docutils literal notranslate"><span class="pre">I</span></code> is like a variable declaration, so you cannot refer to <code class="docutils literal notranslate"><span class="pre">I</span></code>
after the loop.</li>
<li><code class="docutils literal notranslate"><span class="pre">I</span></code> is constant. You cannot change its value.</li>
</ul>
<p>You cannot change the “step” of the loop (iterate two by two for
example), and if you want to iterate from <code class="docutils literal notranslate"><span class="pre">10</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code>, you have to
use the reverse keyword.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="kr">reverse</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span> <span class="c1">--  10 .. 1 would not work.</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>For loops are more powerful and complicated than what we showcased here,
more on that later.</p>
</div>
<div class="section" id="bare-loops">
<h3>Bare loops<a class="headerlink" href="#bare-loops" title="Permalink to this headline">¶</a></h3>
<p>Even though we started with the for loop, for familiarity, the purest,
form of loop in Ada is the bare loop. In some sense, every other loop kind
builds up on this one.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">I</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">-- Variable declaration</span>
   <span class="c1">--  ^ Type</span>
   <span class="c1">--             ^ Default value</span>
<span class="kr">begin</span>
   <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
      <span class="kr">exit</span> <span class="kr">when</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">--  Exit statement</span>
      <span class="c1">--        ^ Boolean condition</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>This example introduces a few new concepts and Ada specificities:</p>
<ul class="simple">
<li>We see that we declared a variable, between the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">is</span></span></code> and the
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">begin</span></span></code>. This constitutes a declarative region. In Ada, you can
only declare objects, types, and anything that is considered a
declaration, in a declarative region. Trying to declare a variable
inline in the middle of your statements will result in a compilation
error. More on that later.</li>
<li>The bare loop statement is introduced by the keyword <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">loop</span></span></code> on
its own and, like every kind of loop statement, terminated by the
combination of keywords <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">end</span></span> <span class="keyword reserved"><span class="pre">loop</span></span></code>. On its own, it is an infinite
loop. You can break out of it with an <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">exit</span></span></code> statement.</li>
<li>The operator for assignment is <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">:=</span></span></code>, and the one for equality is
<code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">=</span></span></code>. There is no way to confuse them, because as previously said,
in Ada, statements and expressions are distinct, and expressions are
not valid statements.</li>
</ul>
</div>
<div class="section" id="while-loops">
<h3>While loops<a class="headerlink" href="#while-loops" title="Permalink to this headline">¶</a></h3>
<p>Ada has a last loop kind, while loops.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">I</span> <span class="p">:</span> <span class="kt">Natural</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Condition. *Must* be of type Boolean (no Integers). Operator &lt;</span>
   <span class="c1">--  returns a Boolean</span>
   <span class="kr">while</span> <span class="n">I</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>

      <span class="c1">--  Assignment</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Here we see what assignment to a variable looks like. There is no
<code class="docutils literal notranslate"><span class="pre">I++</span></code> short form to increment, as there is in many languages.</p>
<p>Something important to note: Trying to treat any value other than a
Boolean as a Boolean condition will result in a compile time error. This
is a result of Ada’s static strong typing.</p>
</div>
</div>
<div class="section" id="imperative-language-if-else">
<h2>Imperative language - If/Else<a class="headerlink" href="#imperative-language-if-else" title="Permalink to this headline">¶</a></h2>
<p>Ada has an if statement. It is pretty unsurprising in form and function:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">I</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kr">loop</span>
      <span class="kr">if</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">5</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>As for the while loop, the Boolean condition must be of strict type
<code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Boolean</span></span></code>. Every relational operator in Ada returns a <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Boolean</span></span></code>
by default.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">I</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kr">loop</span>
      <span class="kr">if</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">5</span> <span class="kr">then</span>
         <span class="kr">exit</span><span class="p">;</span>
         <span class="c1">--  Exit can be unconditional</span>
      <span class="kr">elsif</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Starting...&quot;</span><span class="p">);</span>
      <span class="kr">else</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>What we can see here is that Ada features an <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">elsif</span></span></code> keyword. For
those interested, this is a way of avoiding the classical <a class="reference external" href="https://en.wikipedia.org/wiki/Dangling_else">dangling
else</a> problem.</p>
</div>
<div class="section" id="imperative-language-case-statement">
<h2>Imperative language - Case statement<a class="headerlink" href="#imperative-language-case-statement" title="Permalink to this headline">¶</a></h2>
<p>Ada has a case statement, which is a very interesting beast, as it quite
differs from, for example, C/C++’s case statement.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">I</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kr">loop</span>
      <span class="c1">--  Expression must be of a discrete type. All the</span>
      <span class="c1">--  values must be covered.</span>
      <span class="kr">case</span> <span class="n">I</span> <span class="kr">is</span>
         <span class="kr">when</span> <span class="mi">0</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Starting...&quot;</span><span class="p">);</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;No really&quot;</span><span class="p">);</span>
            <span class="c1">--  You can put several statements in a branch.</span>
            <span class="c1">--  There is no break.</span>

         <span class="kr">when</span> <span class="mi">3</span> <span class="p">..</span> <span class="mi">5</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>

         <span class="kr">when</span> <span class="mi">7</span> <span class="p">|</span> <span class="mi">9</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">);</span>

         <span class="kr">when</span> <span class="mi">10</span> <span class="p">=&gt;</span>
            <span class="kr">exit</span><span class="p">;</span>  <span class="c1">-- This exits out of the loop ! Not equivalent to break !</span>

         <span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span> <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;I in (1, 2, 6, 8)&quot;</span><span class="p">);</span>
         <span class="c1">--  ‘when others’ must be the last one and alone (if</span>
         <span class="c1">--  present)</span>
      <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Notable points about Ada’s case statement:</p>
<ul class="simple">
<li>The parameter of the case statement needs to be of a discrete type.
More later about what <a class="reference external" href="TODO:linktodiscretetypes">discrete
types</a> are, but for the
moment, it is enough to know that they cover integer and enumeration types.</li>
<li>Every possible value needs to be covered by the case statement. This
will be checked at compile time. When using it on a value which has a
cumbersome number of possible values, you will use the special
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">others</span></span></code> branch to cover the default case.</li>
<li>A value cannot be covered twice. This will also result in a compile
time error.</li>
<li>There are syntactic sugars that you can use to cover several values
in a branch, such as ranges (<code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">..</span> <span class="pre">5</span></code>) and disjoint sets
(<code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">|</span> <span class="pre">9</span></code>).</li>
</ul>
</div>
<div class="section" id="imperative-language-declarative-regions">
<h2>Imperative language - Declarative regions<a class="headerlink" href="#imperative-language-declarative-regions" title="Permalink to this headline">¶</a></h2>
<p>We mentioned declarative regions before. Those are very important in
Ada. What is important to know at this stage:</p>
<ul class="simple">
<li>In any subprogram (procedures for the moment), the region between the
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">is</span></span></code> and the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">begin</span></span></code> is a declarative region.</li>
<li>You can potentially declare anything there: Variables, constants,
types, other subprograms. This is valid for example:</li>
</ul>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Nested</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Nested</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Nested</span><span class="p">;</span>
   <span class="c1">--  Call to Nested</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li>You cannot declare anything outside of a declarative region. If you
need to scope variables in a subprogram, you can introduce a new
declarative region with the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">declare</span></span></code> block</li>
</ul>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In statements&quot;</span><span class="p">);</span>

   <span class="kr">declare</span>
      <span class="n">I</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">12</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In declare block, I = &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
   <span class="kr">end</span><span class="p">;</span>

   <span class="c1">--  I is undefined here</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="imperative-language-control-expressions">
<h2>Imperative language - control expressions<a class="headerlink" href="#imperative-language-control-expressions" title="Permalink to this headline">¶</a></h2>
<p>Ada, since the 2012 revision, features equivalent expressions for most
control statements except loops. We will go over those here because
they’re control-flow, albeit not in the traditional form.</p>
<div class="section" id="if-expressions">
<h3>If expressions<a class="headerlink" href="#if-expressions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="p">(</span><span class="kr">if</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">12</span> <span class="kr">then</span> <span class="mi">15</span>
                   <span class="kr">elsif</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">13</span> <span class="kr">then</span> <span class="mi">15</span>
                   <span class="kr">else</span> <span class="mi">18</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>  <span class="c1">--  When a subprogram is empty, null statement is mandatory</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Ada’s if expression are similar to if statements. However, there are a few
differences that stems from the fact that it is an expression:</p>
<ul class="simple">
<li>All branches’ expressions must be of the same type</li>
<li>An else branch is mandatory.</li>
<li>They <em>must</em> be surrounded by parentheses, but only if the surrounding
expression does not already contain them</li>
</ul>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
      <span class="c1">--  Syntactically correct</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="kr">if</span> <span class="n">I</span> <span class="ow">mod</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">0</span> <span class="kr">then</span> <span class="s">&quot;Even&quot;</span> <span class="kr">else</span> <span class="s">&quot;Odd&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="case-expressions">
<h3>Case expressions<a class="headerlink" href="#case-expressions" title="Permalink to this headline">¶</a></h3>
<p>Even more of a rarity, Ada also has case expressions. They work just as
you would expect.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="kr">case</span> <span class="n">I</span> <span class="kr">is</span>
                <span class="kr">when</span> <span class="mi">1</span> <span class="p">|</span> <span class="mi">3</span> <span class="p">|</span> <span class="mi">5</span> <span class="p">|</span> <span class="mi">7</span> <span class="p">|</span> <span class="mi">9</span> <span class="p">=&gt;</span> <span class="s">&quot;Odd&quot;</span><span class="p">,</span>
                <span class="kr">when</span> <span class="mi">2</span> <span class="p">|</span> <span class="mi">4</span> <span class="p">|</span> <span class="mi">6</span> <span class="p">|</span> <span class="mi">8</span> <span class="p">|</span> <span class="mi">10</span> <span class="p">=&gt;</span> <span class="s">&quot;Even&quot;</span><span class="p">,</span>
                <span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span> <span class="s">&quot;Cannot happen&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>The syntax differs from case statements, because branches are separated
by commas. Also, something to note in the above example is that the
compiler does not know that <code class="docutils literal notranslate"><span class="pre">I</span></code> can only take values between 1 and 10,
so we still need to have an <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">others</span></span></code> branch. We will delve into
why when talking about <a class="reference external" href="TODO:putlinkabouttypes">types</a> in
more details.</p>
</div>
</div>
</div>
<div class="section" id="strongly-typed-language">
<h1>Strongly typed language<a class="headerlink" href="#strongly-typed-language" title="Permalink to this headline">¶</a></h1>
<p>Ada is a strongly typed language. It is interestingly modern in that
aspect: Strong static typing is going through a popularity rise, due to
multiple factors: Popularity of statically typed functional programming,
a big push from the academic community in the typing domain, many
practical languages with strong type systems emerging, etc.</p>
<div class="section" id="what-is-a-type">
<h2>What is a type?<a class="headerlink" href="#what-is-a-type" title="Permalink to this headline">¶</a></h2>
<p>In statically typed languages, a type is mainly (but not only) a
<em>compile time</em> construct. It is a construct commonly used in programming
languages to enforce invariants about the behavior of a program.
Invariants can be described as unchangeable properties that hold true for
all variable of a given type. Enforcing them allows for ensuring that
variables of a data type never have invalid values.</p>
<p>A type is used to reason about <em>values</em> a program manipulates. The aim
is to classify values by what you can accomplish with them, and this way
you can reason about the correctness of your values.</p>
</div>
<div class="section" id="integers">
<h2>Integers<a class="headerlink" href="#integers" title="Permalink to this headline">¶</a></h2>
<p>A nice feature of Ada is that the user can define its own integer types.
In fact, the Integer types provided by the language are defined with the
same mechanisms. There is no “magical” built-in type in that regard,
which is unlike most languages, and arguably very elegant.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="c1">--  Declare a signed integer type, and give the bounds</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="o">-</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">20</span><span class="p">;</span>
   <span class="c1">--                         ^ High bound</span>
   <span class="c1">--                   ^ Low bound</span>

   <span class="c1">--  Like variables, type declarations can only happen in</span>
   <span class="c1">--  declarative regions</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">My_Int</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
      <span class="c1">--              ^ &#39;Image attribute, converts a value to a</span>
      <span class="c1">--                 String</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we showcase the creation of a signed integer type, and
several things we can do with them.</p>
<p>Every type definition in Ada (<a class="reference external" href="TODOTASKTYPES">well almost</a>) starts
with the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">type</span></span></code> keyword. After the type, we can see a range that
looks a lot like the ranges that we use in for loops, that defines the
low and high bound of the type. Every integer in the inclusive range of
the bounds is a valid value for the type.</p>
<blockquote>
<div>In Ada, Integer types are not specified with regards to their
machine representation, but with regards to their range. The
compiler will then choose the most appropriate representation.</div></blockquote>
<p>Another interesting thing that we can notice in the above example is the
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">My_Int</span></span><span class="punctuation"><span class="pre">’</span></span><span class="name attribute"><span class="pre">Image</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">I</span></span><span class="punctuation"><span class="pre">)</span></span></code> expresssion. In Ada, the
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Expr</span></span><span class="punctuation"><span class="pre">’</span></span><span class="name attribute"><span class="pre">Attribute</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">optional</span></span> <span class="name"><span class="pre">params</span></span><span class="punctuation"><span class="pre">)</span></span></code> notation is used for what is
called <a class="reference external" href="TODOLINKATTRS">attributes</a> in Ada. Attributes are built-in
operations on types or on values. They are accessed by using a <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span></code>
(the tick sign).</p>
<p>Ada makes a few types available as “built-ins”. <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> is one of
them. Here is how <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> is defined:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Integer</span> <span class="kr">is</span> <span class="kr">range</span> <span class="o">-</span><span class="p">(</span><span class="nv">2</span> <span class="o">**</span> <span class="nv">31</span><span class="p">)</span> <span class="p">..</span> <span class="o">+</span><span class="p">(</span><span class="nv">2</span> <span class="o">**</span> <span class="nv">31</span> <span class="o">-</span> <span class="nv">1</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">**</span></span></code> is the exponent operator, which means that the first valid
value for <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> is <span class="math notranslate">\(-2^{31}\)</span>, and the last valid value is
<span class="math notranslate">\(2^{31-1}\)</span>. In a fit of luck, this coincides with what you can fit
in a 32 bit signed integer on modern platforms :).</p>
<div class="section" id="operational-semantics">
<h3>Operational semantics<a class="headerlink" href="#operational-semantics" title="Permalink to this headline">¶</a></h3>
<p>Unlike in unsafe languages like C and C++, Ada specifies that operations
on integers should be checked for overflows.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
   <span class="c1">--  This operation will overflow, eg. it will</span>
   <span class="c1">--  raise an exception at runtime.</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>However, mainly for efficiency reasons, overflow only happens at
specific boundaries, like assignment:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">20</span><span class="p">;</span>
   <span class="n">A</span> <span class="p">:</span> <span class="n">My_Int</span> <span class="p">:=</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="n">My_Int</span> <span class="p">:=</span> <span class="mi">15</span><span class="p">;</span>
   <span class="n">M</span> <span class="p">:</span> <span class="n">My_Int</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
   <span class="c1">--  No overflow here, overflow checks are done at</span>
   <span class="c1">--  specific boundaries.</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="n">M</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Overflow will only be checked by the compiler at specific points in the
execution. The result, as we see above, is that you might have an operation
that overflows in an intermediate computation, but no error will be raised
because the final result does not overflow. For more information, see <a class="reference external" href="TODOLINKOVERFLOW">the
detailed rules here</a>.</p>
</div>
</div>
<div class="section" id="unsigned-types">
<h2>Unsigned types<a class="headerlink" href="#unsigned-types" title="Permalink to this headline">¶</a></h2>
<p>Ada also features unsigned Integer types. They’re called modular types in Ada
parlance. The reason for this designation is due to their behavior in case of
overflow: They simply “wrap around”, as if a modulo operation was applied.</p>
<p>For machine sized modular types, this mimics the most common implementation
defined behavior of unsigned types. However, the main advantage is that
this works for any modular type:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Mod_Int</span> <span class="kr">is</span> <span class="ow">mod</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">5</span><span class="p">;</span>
   <span class="c1">--                  ^ Max value is 32</span>

   <span class="n">A</span> <span class="p">:</span> <span class="n">Mod_Int</span> <span class="p">:=</span> <span class="mi">20</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="n">Mod_Int</span> <span class="p">:=</span> <span class="mi">15</span><span class="p">;</span>
   <span class="n">M</span> <span class="p">:</span> <span class="n">Mod_Int</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">;</span>
   <span class="c1">--  No overflow here, M = 20 + 15 mod 32 = 3</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="n">M</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello, World!&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Unlike in C/C++, since this behavior is guaranteed by the Ada specification,
you can rely on it to implement portable code. Also, being able to leverage the
wrapping on arbitrary bounds is very useful to implement certain algorithms and
data structures, such as
<a class="reference external" href="https://en.m.wikipedia.org/wiki/Circular_buffer">ring buffers</a>.</p>
</div>
<div class="section" id="enumerations">
<h2>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this headline">¶</a></h2>
<p>Enumeration types are another nicety of Ada’s type system. Unlike C’s enums,
they are <em>not</em> integers, and each new enum type is incompatible with other enum
types. Enum types are part of the bigger family of discrete types, which makes
them usable in certain situations that we will disclose later (<a href="#id4"><span class="problematic" id="id5">`here
&lt;TODOLINKTODISCRETEFEATURES`__</span></a>, here and here) but one that we already know is
that you can use them as a target to a case expression.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>
   <span class="c1">--  An enumeration type</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Days</span> <span class="kr">loop</span>
      <span class="kr">case</span> <span class="n">I</span> <span class="kr">is</span>
         <span class="kr">when</span> <span class="n">Saturday</span> <span class="p">..</span> <span class="n">Sunday</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Week end!&quot;</span><span class="p">);</span>

         <span class="c1">--  Completeness checking on enums</span>
         <span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello on &quot;</span> <span class="o">&amp;</span> <span class="n">Days</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
            <span class="c1">--  &#39;Image attribute, works on enums too</span>
      <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Enum types are powerful enough that, unlike in most languages, they’re used to
represent the standard Boolean type, that is so defined:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Boolean</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">True</span><span class="p">,</span> <span class="nv">False</span><span class="p">);</span>
</pre></div>
</div>
<p>As mentioned previously, every “built-in” type in Ada is defined with facilities
generally available to the user.</p>
</div>
<div class="section" id="floating-point-and-fixed-point-types">
<h2>Floating-point and fixed-point types<a class="headerlink" href="#floating-point-and-fixed-point-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="floating-point-types">
<h3>Floating-point types<a class="headerlink" href="#floating-point-types" title="Permalink to this headline">¶</a></h3>
<p>As in most languages, Ada support floating-point types. The default
floating-point type is <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Float</span></span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Floating_Point_Demo</span> <span class="kr">is</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">Float</span> <span class="p">:=</span> <span class="mf">2.1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="kt">Float</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Floating_Point_Demo</span><span class="p">;</span>
</pre></div>
</div>
<p>The application will show that the value of <code class="docutils literal notranslate"><span class="pre">A</span></code> is <code class="docutils literal notranslate"><span class="pre">2.1</span></code>.</p>
<p>All common operations that could be expected for floating-point types are
available, including retrieving the absolute-value and the power function.
For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Floating_Point_Operations</span> <span class="kr">is</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">Float</span> <span class="p">:=</span> <span class="mf">2.1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="kr">abs</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mf">4.1</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="kt">Float</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="kt">Float</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Floating_Point_Operations</span><span class="p">;</span>
</pre></div>
</div>
<p>The value of <code class="docutils literal notranslate"><span class="pre">A</span></code> is 2.0 after the first operation and 5.0 after the
second operation.</p>
<p>In addition to <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Float</span></span></code>, Ada offers data types with higher precision:
<code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Long_Float</span></span></code> and <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Long_Long_Float</span></span></code>. However, the standard does
not indicate the exact precision of these types: it only guarantees that
the type <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Long_Float</span></span></code>, for example, has at least the same precision
of <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Float</span></span></code> or higher. In order to guarantee that a certain precision
requirement is met, we can define custom floating-point types, as we will
see in the next section.</p>
</div>
<div class="section" id="precision-of-floating-point-types">
<h3>Precision of floating-point types<a class="headerlink" href="#precision-of-floating-point-types" title="Permalink to this headline">¶</a></h3>
<p>Ada allows for specifying the exact precision required for a
floating-point type. The precision is expressed in terms of decimal
digits. This guarantees that the operations on these custom types will
have at least the specified precision. The syntax for this is
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">digits</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">number_of_decimal_digits</span></span><span class="operator"><span class="pre">&gt;</span></span></code>. In the background,
the compiler will choose a floating-point representation that matches the
required precision. For example:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Custom_Floating_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T3</span>  <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">3</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">T15</span> <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">15</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">T18</span> <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">18</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;T3  requires &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T3</span><span class="p">&#39;</span><span class="na">Size</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; bits&quot;</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;T15 requires &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T15</span><span class="p">&#39;</span><span class="na">Size</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; bits&quot;</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;T18 requires &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T18</span><span class="p">&#39;</span><span class="na">Size</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; bits&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Custom_Floating_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, the attribute <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">Size</span></span></code> is used to retrieve the number
of bits used for the specified data type. As we can see by running this
example, the compiler allocates 32 bits for <code class="docutils literal notranslate"><span class="pre">T3</span></code>, 64 bits for <code class="docutils literal notranslate"><span class="pre">T15</span></code>
and 128 bits for <code class="docutils literal notranslate"><span class="pre">T18</span></code>.</p>
<p>The number of digits specified in the data type is also used in the format
when displaying floating-point variables. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Display_Custom_Floating_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T3</span>  <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">3</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">T18</span> <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">18</span><span class="p">;</span>

   <span class="no">C1</span> <span class="p">:</span> <span class="kr">constant</span> <span class="p">:=</span> <span class="mf">1.0</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="p">;</span>

   <span class="n">A</span> <span class="p">:</span> <span class="n">T3</span>  <span class="p">:=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">C1</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="n">T18</span> <span class="p">:=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">C1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">T3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of B is &quot;</span> <span class="o">&amp;</span> <span class="n">T18</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">B</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Display_Custom_Floating_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>As expected, the application will display the variables according to
specified precision (1.00E+00 and 1.00010000000000000E+00).</p>
</div>
<div class="section" id="range-of-floating-point-types">
<h3>Range of floating-point types<a class="headerlink" href="#range-of-floating-point-types" title="Permalink to this headline">¶</a></h3>
<p>Ranges can also be specified floating-point types. The syntax is similar
to the one used for integer data types — using the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">range</span></span></code> keyword.
This simple example creates a new floating-point type based on the
<code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Float</span></span></code> for a normalized range between -1.0 and 1.0:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Floating_Point_Range</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T_Norm</span>  <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Float</span> <span class="kr">range</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">..</span> <span class="mf">1.0</span><span class="p">;</span>
   <span class="n">A</span>  <span class="p">:</span> <span class="n">T_Norm</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="mf">1.0</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">T_Norm</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Floating_Point_Range</span><span class="p">;</span>
</pre></div>
</div>
<p>The application makes sure that the normalized range is observed for all
variables of this type. If the value is out of range, an exception is
raised. In this example, an exception (<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Constraint_Error</span></span></code>) is raised
when assigning 2.0 to the variable <code class="docutils literal notranslate"><span class="pre">A</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Floating_Point_Range_Exception</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T_Norm</span>  <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Float</span> <span class="kr">range</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">..</span> <span class="mf">1.0</span><span class="p">;</span>
   <span class="n">A</span>  <span class="p">:</span> <span class="n">T_Norm</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="mf">2.0</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">T_Norm</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Floating_Point_Range_Exception</span><span class="p">;</span>
</pre></div>
</div>
<p>Ranges can also be specified for custom floating-point types. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Numerics</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Numerics</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Custom_Range_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T6_Inv_Trig</span>  <span class="kr">is</span> <span class="kr">digits</span> <span class="mi">6</span> <span class="kr">range</span> <span class="o">-</span><span class="n">Pi</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="p">..</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Custom_Range_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we are defining a type called <code class="docutils literal notranslate"><span class="pre">T6_Inv_Trig</span></code>, which has
a range from <span class="math notranslate">\(-\pi/2\)</span> to <span class="math notranslate">\(\pi/2\)</span> with a minimum precision of 6
digits.</p>
</div>
<div class="section" id="decimal-fixed-point-types">
<h3>Decimal fixed-point types<a class="headerlink" href="#decimal-fixed-point-types" title="Permalink to this headline">¶</a></h3>
<p>In addition to specifying the least required precision of a floating-point
type, it is also possible to go one step further and specify the exact
accuracy of a floating-point type. This category of data types is called
decimal fixed-point types.</p>
<p>The syntax for decimal fixed-point types is
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">delta</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">delta_value</span></span><span class="operator"><span class="pre">&gt;</span></span> <span class="keyword reserved"><span class="pre">digits</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">number_of_decimal_digits</span></span><span class="operator"><span class="pre">&gt;</span></span></code>.
In this case, the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delta</span></span></code> and the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">digits</span></span></code> will be used by the
compiler to derive a range. This will become clear in the next example.</p>
<p>We will use three attributes of the language in our example:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute Name</th>
<th class="head">Documentation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>First</td>
<td>Returns the first value of the type</td>
</tr>
<tr class="row-odd"><td>Last</td>
<td>Returns the last value of the type</td>
</tr>
<tr class="row-even"><td>Delta</td>
<td>Returns the delta value of the type</td>
</tr>
</tbody>
</table>
<p>In the example below, we declare two data types: <code class="docutils literal notranslate"><span class="pre">T3_D3</span></code> and <code class="docutils literal notranslate"><span class="pre">T6_D3</span></code>.
For both types, the delta value is the same: 0.001.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Decimal_Fixed_Point_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T3_D3</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">3</span><span class="p">)</span> <span class="kr">digits</span> <span class="mi">3</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">T6_D3</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">3</span><span class="p">)</span> <span class="kr">digits</span> <span class="mi">6</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The delta    value of T3_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Delta</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The minimum  value of T3_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">First</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The maximum  value of T3_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">));</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The delta    value of T6_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">Delta</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The minimum  value of T6_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">First</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The maximum  value of T6_D3 is &quot;</span> <span class="o">&amp;</span> <span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T6_D3</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Decimal_Fixed_Point_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>When running the application, we see that the delta value of both
types is indeed the same: 0.001. However, because <code class="docutils literal notranslate"><span class="pre">T3_D3</span></code> is restricted
to 3 digits, its range is -0.999 to 0.999. For the <code class="docutils literal notranslate"><span class="pre">T6_D3</span></code>, we have
defined a precision of 6 digits, so the range is -999.999 to 999.999.</p>
<p>Similar to the type definition using the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">range</span></span></code> syntax, because we
have an implicit range, the application will check that the variables
contain values that are not out-of-range. Also, if the result of a
multiplication or division on decimal fixed-point types is smaller than
the delta value specified for the data type, the actual result will be
zero. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Decimal_Fixed_Point_Smaller</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T3_D3</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">3</span><span class="p">)</span> <span class="kr">digits</span> <span class="mi">3</span><span class="p">;</span>
   <span class="n">A</span> <span class="p">:</span> <span class="n">T3_D3</span> <span class="p">:=</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Delta</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="n">T3_D3</span> <span class="p">:=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A     is &quot;</span> <span class="o">&amp;</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The value of A * B is &quot;</span> <span class="o">&amp;</span> <span class="n">T3_D3</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Decimal_Fixed_Point_Smaller</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, the result of the operation <span class="math notranslate">\(0.001 * 0.5\)</span> is
0.0005. Since this value is not representable for the <code class="docutils literal notranslate"><span class="pre">T3_D3</span></code> type
because the delta value is 0.001, the actual value stored in variable
<code class="docutils literal notranslate"><span class="pre">A</span></code> is zero.</p>
</div>
<div class="section" id="fixed-point-types">
<h3>Fixed-point types<a class="headerlink" href="#fixed-point-types" title="Permalink to this headline">¶</a></h3>
<p>Ordinary fixed-point types are similar to decimal fixed-point types.
The difference between them is in the delta value:
for decimal fixed-point types, it is based on the
power of ten, whereas for ordinary fixed-point types, it is based on the
power of two. Therefore, they are also called binary fixed-point types.</p>
<blockquote>
<div>FURTHERINFO: Ordinary fixed-point types can be thought of being closer
to the actual representation on the machine, since hardware support for
decimal fixed-point arithmetic is not widespread, while ordinary
fixed-point types make use of the available integer arithmetic in the
background.</div></blockquote>
<p>The syntax for binary fixed-point types is
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">delta</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">delta_value</span></span><span class="operator"><span class="pre">&gt;</span></span> <span class="keyword reserved"><span class="pre">range</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">lower_bound</span></span><span class="operator"><span class="pre">&gt;</span></span> <span class="punctuation"><span class="pre">..</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">upper_bound</span></span><span class="operator"><span class="pre">&gt;</span></span></code>.
For example, we may define a normalized range between -1.0 and 1.0 as
following:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Normalized_Fixed_Point_Type</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">TQ31</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">31</span><span class="p">)</span> <span class="kr">range</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">..</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;TQ31 requires &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Size</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; bits&quot;</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The delta    value of TQ31 is &quot;</span> <span class="o">&amp;</span> <span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Delta</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The minimum  value of TQ31 is &quot;</span> <span class="o">&amp;</span> <span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">TQ31</span><span class="p">&#39;</span><span class="na">First</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The maximum  value of TQ31 is &quot;</span> <span class="o">&amp;</span> <span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Normalized_Fixed_Point_Type</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we are defining a 32-bit fixed-point data type for our
normalized range. When running the application, we notice that the upper
bound is close to one, but not exact one. This is a typical effect of
fixed-point data types — you can find more details in this discussion
about the <a class="reference external" href="https://en.wikipedia.org/wiki/Q_(number_format)">Q format</a>.
We may also rewrite this code with an exact type definition:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Normalized_Adapted_Fixed_Point_Type</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">TQ31</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">31</span><span class="p">)</span> <span class="kr">range</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">..</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">31</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Normalized_Adapted_Fixed_Point_Type</span><span class="p">;</span>
</pre></div>
</div>
<p>We may also use any other range. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Numerics</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Numerics</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Custom_Fixed_Point_Range</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">T_Inv_Trig</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">15</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pi</span> <span class="kr">range</span> <span class="o">-</span><span class="n">Pi</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="p">..</span> <span class="n">Pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;T_Inv_Trig requires &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Size</span><span class="p">)</span>
             <span class="o">&amp;</span> <span class="s">&quot; bits&quot;</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The delta    value of T_Inv_Trig is &quot;</span>
             <span class="o">&amp;</span> <span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Delta</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The minimum  value of T_Inv_Trig is &quot;</span>
             <span class="o">&amp;</span> <span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">First</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;The maximum  value of T_Inv_Trig is &quot;</span>
             <span class="o">&amp;</span> <span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">T_Inv_Trig</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Custom_Fixed_Point_Range</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we are defining a 16-bit type called <code class="docutils literal notranslate"><span class="pre">T_Inv_Trig</span></code>,
which has a range from <span class="math notranslate">\(-\pi/2\)</span> to <span class="math notranslate">\(\pi/2\)</span>.</p>
<p>All standard operations are available for fixed-point types. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Fixed_Point_Op</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">TQ31</span> <span class="kr">is</span> <span class="kr">delta</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">31</span><span class="p">)</span> <span class="kr">range</span> <span class="o">-</span><span class="mf">1.0</span> <span class="p">..</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="nv">31</span><span class="p">);</span>

   <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">R</span> <span class="p">:</span> <span class="n">TQ31</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="mf">0.25</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="mf">0.50</span><span class="p">;</span>
   <span class="n">R</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;R is &quot;</span> <span class="o">&amp;</span> <span class="n">TQ31</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">R</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Fixed_Point_Op</span><span class="p">;</span>
</pre></div>
</div>
<p>As expected, <code class="docutils literal notranslate"><span class="pre">R</span></code> contains 0.75 after the addition of <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
</div>
</div>
<div class="section" id="strong-typing">
<h2>Strong typing<a class="headerlink" href="#strong-typing" title="Permalink to this headline">¶</a></h2>
<p>One thing that we have hinted at so far is that Ada is strongly typed. One
corollary of that is that different types of the same family are incompatible
with each other, as we can see in the following example:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="c1">--  Declare two signed types</span>
   <span class="kd">type</span> <span class="kt">Meters</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">10_000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Miles</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">5_000</span><span class="p">;</span>

   <span class="n">Dist_Imperial</span> <span class="p">:</span> <span class="n">Miles</span><span class="p">;</span>
   <span class="c1">--  Declare a constant</span>
   <span class="no">Dist_SI</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Meters</span> <span class="p">:=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Not correct: types mismatch</span>
   <span class="n">Dist_Imperial</span> <span class="p">:=</span> <span class="n">Dist_SI</span> <span class="o">*</span> <span class="mi">1609</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Miles</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Dist_Imperial</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>This is true for every distinct type. It also means that, in the general case,
an expression like <code class="code ada docutils literal notranslate"><span class="literal number integer"><span class="pre">2</span></span> <span class="operator"><span class="pre">*</span></span> <span class="literal number float"><span class="pre">3.0</span></span></code> will trigger a compilation error. In a language
like C or Python, those expressions are made valid by implicit conversions. In
Ada, such conversions must be made explicit:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kd">procedure</span> <span class="nf">Conv</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Meters</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">10_000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Miles</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">5_000</span><span class="p">;</span>
   <span class="n">Dist_Imperial</span> <span class="p">:</span> <span class="n">Miles</span><span class="p">;</span>
   <span class="no">Dist_SI</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Meters</span> <span class="p">:=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Dist_Imperial</span> <span class="p">:=</span> <span class="n">Miles</span> <span class="p">(</span><span class="n">Dist_SI</span> <span class="o">*</span> <span class="mi">1609</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
   <span class="c1">--               ^ Type conversion, from Meters to Miles</span>
   <span class="c1">--  Now the code is correct</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Miles</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Dist_Imperial</span><span class="p">));</span>
<span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
<p>Of course, we probably do not want to write the conversion code every time we
convert from meters to miles. The idiomatic Ada way in that case would be to
introduce conversion functions along with the types.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Conv</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Meters</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">10_000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Miles</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">5_000</span><span class="p">;</span>

   <span class="c1">--  Function declaration, like procedure but returns a value.</span>
   <span class="kd">function</span> <span class="nf">To_Miles</span> <span class="p">(</span><span class="nv">M</span> <span class="p">: </span><span class="nv">Meters</span><span class="p">)</span> <span class="kr">return</span> <span class="n">Miles</span> <span class="kr">is</span>
   <span class="c1">--                             ^ Return type</span>
   <span class="kr">begin</span>
      <span class="kr">return</span> <span class="n">Miles</span> <span class="p">(</span><span class="n">M</span> <span class="o">*</span> <span class="mi">1609</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">To_Miles</span><span class="p">;</span>

   <span class="n">Dist_Imperial</span> <span class="p">:</span> <span class="n">Miles</span><span class="p">;</span>
   <span class="no">Dist_SI</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Meters</span> <span class="p">:=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Dist_Imperial</span> <span class="p">:=</span> <span class="n">To_Miles</span> <span class="p">(</span><span class="n">Dist_SI</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Miles</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Dist_Imperial</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Conv</span><span class="p">;</span>
</pre></div>
</div>
<p>This is also the first time we use a function. We will study <a class="reference external" href="TODOSUBPROGRAMS">functions and
procedures</a> in more details soon.</p>
<p>If you write a lot of numeric code, having to explicitly specify your
conversions all the time might seem painful at first, because your code might
end up containing a lot of conversions. However, this approach has some
advantages. For example:</p>
<ul class="simple">
<li>You can rely on the fact that no implicit conversion will ever happen in your
numeric code.</li>
</ul>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p>In C, for example, the rules for implicit conversions may not
always be completely obvious. In Ada, however, the code will always do
exactly what it seems to do. For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
<p>This code will compile fine, but the result of <code class="docutils literal notranslate"><span class="pre">f</span></code> will be 1.0 instead
of 1.5, because the compiler will generate an integer division (three
divided by two) that results in one. The software developer must be
aware of data conversion issues and use an appropriate casting:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
<p>In the corrected example, the compiler will convert both variables to
their corresponding floating-point representation before performing the
division. This will produce the expected result.</p>
<p>This example is very simple and experienced C developers will probably
notice this specific issue and correct it before it creates bigger
problems. However, in more complex applications where the type
declaration is not always visible — e.g. when referring to elements of
a <code class="code c docutils literal notranslate"><span class="keyword"><span class="pre">struct</span></span></code> — this situation might not always be evident and quickly
lead to software defects that can be harder to find.</p>
<p>The Ada compiler, in contrast, will always refuse to compile code that
mixes floating-point and integer variables without explicit conversion.
The following Ada code, based on the erroneous example in C, will not
compile:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">3</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">2</span><span class="p">;</span>
   <span class="n">F</span> <span class="p">:</span> <span class="kt">Float</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">F</span> <span class="p">:=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">B</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p class="last">The offending line must be changed to <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">F</span></span> <span class="punctuation"><span class="pre">:=</span></span> <span class="keyword type"><span class="pre">Float</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">A</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="operator"><span class="pre">/</span></span> <span class="keyword type"><span class="pre">Float</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">B</span></span><span class="punctuation"><span class="pre">);</span></span></code>
in order to be accepted by the compiler.</p>
</div>
<ul class="simple">
<li>You can use Ada’s strong typing to help <a class="reference external" href="TODOLINKINVARIANTS">enforce invariants</a> in your code, as in the example above: Since Miles
and Meters are two different types, you cannot mistakenly convert an instance
of one to an instance of the other.</li>
</ul>
</div>
<div class="section" id="character-types">
<h2>Character types<a class="headerlink" href="#character-types" title="Permalink to this headline">¶</a></h2>
<p>But Ada’s strong typing is not only helpful with numeric types. As we said
before for enumeration types, each enumeration type is distinct and
incompatible with every other enumeration type. However, what we did not
mention is that Ada has character literals, that can be used as enumeration
literals too. This allows Ada to define its own strongly typed character types,
but also allows the user to define its own, as in the example below:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Char</span> <span class="kr">is</span> <span class="p">(&#39;</span><span class="na">a</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">b</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">c</span><span class="p">&#39;);</span>
   <span class="c1">--  Our custom character type, an enum, with only 3 valid values.</span>

   <span class="n">C</span> <span class="p">:</span> <span class="kt">Character</span><span class="p">;</span>
   <span class="c1">--  ^ Built-in character type (it&#39;s an enum)</span>

   <span class="n">M</span> <span class="p">:</span> <span class="n">My_Char</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">C</span> <span class="p">:=</span> <span class="s s-Character">&#39;?&#39;</span><span class="p">;</span>
   <span class="c1">--   ^ Character literal (enumeration literal)</span>

   <span class="n">M</span> <span class="p">:=</span> <span class="p">&#39;</span><span class="na">a</span><span class="p">&#39;;</span>

   <span class="n">C</span> <span class="p">:=</span> <span class="mi">64</span><span class="p">;</span>
   <span class="c1">--   ^ Invalid: 64 is not an enumeration literal</span>

   <span class="n">M</span> <span class="p">:=</span> <span class="n">C</span><span class="p">;</span>
   <span class="c1">--   ^ Invalid: C is of invalid type for A</span>

   <span class="n">M</span> <span class="p">:=</span> <span class="p">&#39;</span><span class="na">d</span><span class="p">&#39;;</span>
   <span class="c1">--   ^ Invalid: &#39;d&#39; is not a valid literal for type My_Char</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="new-types">
<h2>New types<a class="headerlink" href="#new-types" title="Permalink to this headline">¶</a></h2>
<p>One particularity of Ada is that you can create new types based on existing
ones. This is very useful to define that a type is statically incompatible
with another type, to enforce strong typing.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="c1">--  ID card number type, incompatible with Integer.</span>
   <span class="kd">type</span> <span class="kt">Social_Security_Number</span>
   <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">999_99_9999</span><span class="p">;</span>
   <span class="c1">--                   ^ Since a SSN has 9 digits max, and cannot be</span>
   <span class="c1">--                     negative, we enforce a validity constraint.</span>

   <span class="n">SSN</span> <span class="p">:</span> <span class="n">Social_Security_Number</span> <span class="p">:=</span> <span class="mi">323_44_9847</span><span class="p">;</span>
   <span class="c1">--                              ^ You can put underscores as formatting in</span>
   <span class="c1">--                                any number.</span>

   <span class="n">Invalid</span> <span class="p">:</span> <span class="n">Social_Security_Number</span> <span class="p">:=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
   <span class="c1">--                                  ^ This will cause a runtime error</span>
   <span class="c1">--                                    (and a compile time warning with</span>
   <span class="c1">--                                     GNAT)</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>You can redefine the range of validity of any type family: Floating point,
fixed point, enumerations …</p>
<p>The syntax for enumerations uses the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">range</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="keyword reserved"><span class="pre">range</span></span><span class="operator"><span class="pre">&gt;</span></span></code> syntax:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span> <span class="nv">Thursday</span><span class="p">,</span>
                 <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Weekend_Days</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Days</span> <span class="kr">range</span> <span class="n">Saturday</span> <span class="p">..</span> <span class="n">Sunday</span><span class="p">;</span>
   <span class="c1">--  New type, where only Saturday and Sunday are valid literals.</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="subtypes">
<h2>Subtypes<a class="headerlink" href="#subtypes" title="Permalink to this headline">¶</a></h2>
<p>As we are starting to see, types are often used in Ada to enforce constraints
about the range of validity of values. However, sometimes it is desirable to
enforce constraints on some values, but one may not desire the static
enforcement brought by Ada types. This is where subtypes come into play.</p>
<p>Subtypes allow you to declare additional constraints on a type, but entities of
that subtype are still of the type the subtype derives from, and thus are valid
where an instance of the type is expected.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span> <span class="nv">Thursday</span><span class="p">,</span>
                 <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="c1">--  Declaration of a subtype</span>
   <span class="kd">subtype</span> <span class="kt">Weekend_Days</span> <span class="kr">is</span> <span class="n">Days</span> <span class="kr">range</span> <span class="n">Saturday</span> <span class="p">..</span> <span class="n">Sunday</span><span class="p">;</span>
   <span class="c1">--                           ^ Constraint of the subtype</span>

   <span class="n">M</span> <span class="p">:</span> <span class="n">Days</span> <span class="p">:=</span> <span class="n">Sunday</span><span class="p">;</span>

   <span class="n">S</span> <span class="p">:</span> <span class="n">Weekend_Days</span> <span class="p">:=</span> <span class="n">M</span><span class="p">;</span>
   <span class="c1">--  No error here, Days and Weekend_Days are of the same type.</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Days</span> <span class="kr">loop</span>
      <span class="kr">case</span> <span class="n">I</span> <span class="kr">is</span>
         <span class="c1">--  Just like a type, a subtype can be used as a</span>
         <span class="c1">--  range</span>
         <span class="kr">when</span> <span class="n">Weekend_Days</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Week end!&quot;</span><span class="p">);</span>
         <span class="kr">when</span> <span class="kr">others</span> <span class="p">=&gt;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hello on &quot;</span> <span class="o">&amp;</span> <span class="n">Days</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
      <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Some subtypes are declared as part of the standard package in Ada, and are
available to you all the time:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">subtype</span> <span class="kt">Natural</span>  <span class="kr">is</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">;</span>
<span class="kd">subtype</span> <span class="kt">Positive</span> <span class="kr">is</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Last</span><span class="p">;</span>
</pre></div>
</div>
<p>While subtypes of a type are statically compatible with each others,
constraints are enforced at runtime: If you violate the constraints of the
subtype, an exception will be raised at runtime, when the running program
detects the violation.</p>
<div class="ada-run ada-run-expect-failure highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span> <span class="nv">Thursday</span><span class="p">,</span>
                 <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">subtype</span> <span class="kt">Weekend_Days</span> <span class="kr">is</span> <span class="n">Days</span> <span class="kr">range</span> <span class="n">Saturday</span> <span class="p">..</span> <span class="n">Sunday</span><span class="p">;</span>
   <span class="n">Day</span> <span class="p">:</span> <span class="n">Days</span> <span class="p">:=</span> <span class="n">Saturday</span><span class="p">;</span>
   <span class="n">Weekend</span> <span class="p">:</span> <span class="n">Weekend_Days</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Weekend</span> <span class="p">:=</span> <span class="n">Day</span><span class="p">;</span>
   <span class="c1">--         ^ Correct: Same type, subtype constraints are respected</span>
   <span class="n">Weekend</span> <span class="p">:=</span> <span class="n">Monday</span><span class="p">;</span>
   <span class="c1">--         ^ Wrong value for the subtype</span>
   <span class="c1">--           Compiles, but exception at runtime</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="records">
<h1>Records<a class="headerlink" href="#records" title="Permalink to this headline">¶</a></h1>
<p>So far, all the types we have seen are what we can call base types: each
instance of one of those types represents a single piece of data. Now we are
going to study our first class of composite types: The record.</p>
<p>Records are a way to piece together several instances of other types. Each of
those instances will be given a name. The pair of a name to an instance of a
specific type is called a field, or a component.</p>
<div class="section" id="record-type-declaration">
<h2>Record type declaration<a class="headerlink" href="#record-type-declaration" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of a simple record declaration:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Date</span> <span class="kr">is</span> <span class="kr">record</span>
   <span class="c1">--  The following declarations are components of the record</span>
   <span class="n">Day</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
   <span class="n">Month</span> <span class="p">:</span> <span class="n">Month_Type</span><span class="p">;</span>
   <span class="n">Year</span>  <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">3000</span><span class="p">;</span> <span class="c1">--  You can add custom constraints on fields</span>
<span class="kr">end record</span><span class="p">;</span>
</pre></div>
</div>
<p>One thing we can notice is that fields look a lot like variable declarations,
except that they are inside of a record definition.</p>
<p>As with objects declarations, it is possible to specify additional constraints
when indicating the subtype of the field.</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Date</span> <span class="kr">is</span> <span class="kr">record</span>
   <span class="n">Day</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
   <span class="n">Month</span> <span class="p">:</span> <span class="n">Month_Type</span> <span class="p">:=</span> <span class="n">January</span><span class="p">;</span>
   <span class="c1">--  This component has a default value</span>
   <span class="n">Year</span>  <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">3000</span> <span class="p">:=</span> <span class="mi">2012</span><span class="p">;</span>
   <span class="c1">--                                 ^ Default value</span>
<span class="kr">end record</span><span class="p">;</span>
</pre></div>
</div>
<p>Record components can also have default values. When declaring an instance of
the record, fields will be automatically set to this value. The value can be
any expression that is valid in the scope of definition of the record.</p>
</div>
<div class="section" id="aggregates">
<h2>Aggregates<a class="headerlink" href="#aggregates" title="Permalink to this headline">¶</a></h2>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="n">Today</span>    <span class="p">:</span> <span class="n">Date</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">November</span><span class="p">,</span> <span class="mi">2012</span><span class="p">);</span>
<span class="n">Birthday</span> <span class="p">:</span> <span class="n">Date</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Day</span> <span class="p">=&gt;</span> <span class="mi">30</span><span class="p">,</span> <span class="n">Month</span> <span class="p">=&gt;</span> <span class="n">February</span><span class="p">,</span> <span class="n">Year</span> <span class="p">=&gt;</span> <span class="mi">2010</span><span class="p">);</span>
<span class="c1">--                  ^ By name</span>
</pre></div>
</div>
<p>Records also have a literal notation that you can use, and that is showcased
above. This notation is called aggregate notation, and the literals are called
aggregates. They can be used in a variety of contexts that we will disclose
throughout the course, and one of those is to initalize records.</p>
<p>An aggregate is a list of values separated by commas and enclosed in
parentheses. It is a valid expression in any context where a value of the
record can be expected.</p>
<p>Values for the components can be specified positionally, as in the first
example, or by name, as in the second example. A mixture of positional and
named vamues is possible, but you cannot use a positional association after a
named one.</p>
</div>
<div class="section" id="component-selection">
<h2>Component selection<a class="headerlink" href="#component-selection" title="Permalink to this headline">¶</a></h2>
<p>To access components of a record instance, an operation that is called
component selection, you use the following syntax:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Record_Selection</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">Month_Type</span> <span class="kr">is</span>
     <span class="p">(</span><span class="nv">January</span><span class="p">,</span> <span class="nv">February</span><span class="p">,</span> <span class="nv">March</span><span class="p">,</span> <span class="nv">April</span><span class="p">,</span> <span class="nv">May</span><span class="p">,</span> <span class="nv">June</span><span class="p">,</span> <span class="nv">July</span><span class="p">,</span>
      <span class="nv">August</span><span class="p">,</span> <span class="nv">September</span><span class="p">,</span> <span class="nv">October</span><span class="p">,</span> <span class="nv">November</span><span class="p">,</span> <span class="nv">December</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Date</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">Day</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
      <span class="n">Month</span> <span class="p">:</span> <span class="n">Month_Type</span><span class="p">;</span>
      <span class="n">Year</span>  <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">3000</span> <span class="p">:=</span> <span class="mi">2012</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="n">Today</span>    <span class="p">:</span> <span class="n">Date</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">November</span><span class="p">,</span> <span class="mi">2012</span><span class="p">);</span>

<span class="kr">begin</span>
   <span class="n">Today</span><span class="p">.</span><span class="n">Day</span> <span class="p">:=</span> <span class="mi">29</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Today is the &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Today</span><span class="p">.</span><span class="n">Day</span><span class="p">)</span>
             <span class="o">&amp;</span> <span class="s">&quot; of &quot;</span> <span class="o">&amp;</span> <span class="n">Month_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Today</span><span class="p">.</span><span class="n">Month</span><span class="p">)</span>
             <span class="o">&amp;</span> <span class="s">&quot;, &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Today</span><span class="p">.</span><span class="n">Year</span><span class="p">));</span>
<span class="kr">end</span> <span class="kr">Record</span><span class="nf">_Selection</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arrays">
<h1>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h1>
<p>Another very important family of composite types is arrays.</p>
<div class="section" id="array-type-declaration">
<h2>Array type declaration<a class="headerlink" href="#array-type-declaration" title="Permalink to this headline">¶</a></h2>
<p>Arrays in Ada are both pretty complex and pretty powerful. We will go over
their characteristics in detail, but let’s start with one way of declaring one.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Index</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="c1">--                                    ^ Type of elements</span>
   <span class="c1">--                          ^ Bounds of the array</span>
   <span class="n">Arr</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
   <span class="c1">--                    ^ Array literal, called aggregate in Ada</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Index</span> <span class="kr">loop</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Arr</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
      <span class="c1">--                     ^ Take the Ith element</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>The first peculiarity that we can see in the above example is that we specify
the indexing type of the array, not its size. Here we declared an <code class="docutils literal notranslate"><span class="pre">Index</span></code>
type ranging from <code class="docutils literal notranslate"><span class="pre">1</span></code> to <code class="docutils literal notranslate"><span class="pre">5</span></code> so the array will have 5 elements - that is,
bounds are inclusive.</p>
<p>This feature is pretty unique to Ada, and has interesting repercussions: You
can use any discrete type to index an array, including <a class="reference external" href="TODOLINKENUMTYPES">Enum types</a>. We will soon see what that means.</p>
<p>The second thing that we might notice is that querying an element of the array
at a given syntax uses the same syntax as the subprogram calls syntax, that is
the array followed by the index in parens.</p>
<p>What this means is that, in Ada, when you see an expression such as <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">(B)</span></code>,
whether it is a function call or an array subscript depends on what <code class="docutils literal notranslate"><span class="pre">A</span></code>
designates.</p>
<p>Finally, the last thing of notice is how we initialize the array, with the
<code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">11)</span></code> expression. This expression is called an aggregate in Ada,
and is a literal expression for an array, the same way that <code class="docutils literal notranslate"><span class="pre">3</span></code> is a literal
expression for an Integer. The notation is very powerful and has many
subtleties that we will gradually introduce. You can also have a detailed
overview of the notation <cite>here &lt;TODODETAILEDAGGREGATESADVANCED&gt;__</cite>.</p>
<p>Let’s now delve into what it means exactly to be able to use any discrete type
to index into the array.</p>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p class="last">Ada arrays have by-value semantics, which means that when you pass one, in
terms of semantics you pass the whole array, not just a handle to it,
unlike in a language like Python or Java. It also means that unlike in C or
C++, arrays are not naked pointers in disguise.</p>
</div>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">11</span> <span class="p">..</span> <span class="mi">15</span><span class="p">;</span>
   <span class="c1">--                  ^ Low bound can be any value</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Index</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Index</span> <span class="kr">loop</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>The first repercussion is that the low bound of your array can be any value: In
the first example we constructed an array type whose first index is <code class="docutils literal notranslate"><span class="pre">1</span></code>, but
in the example above we declare an array type whose first index is <code class="docutils literal notranslate"><span class="pre">11</span></code>.</p>
<p>That’s perfectly fine in Ada, and moreover you can see that since we use the
index type as a range to iterate on the array indices, the code using the array
does not need to change.</p>
<p>That leads us to an important consequence with regards to code dealing with
arrays: Since the lower bound can vary, it is considered best practice to never
assume/hard-code a low bound when iterating/using arrays in general. That means
the code above is good, because it uses the index type, but a for loop as
showcased below is bad practice:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">20</span> <span class="kr">loop</span>
   <span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">:=</span> <span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
</pre></div>
</div>
<p>Since we said above that you can use any discrete type to index an array, it
means that you can use enum types to index arrays.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Month_Duration</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Month</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Jan</span><span class="p">,</span> <span class="nv">Feb</span><span class="p">,</span> <span class="nv">Mar</span><span class="p">,</span> <span class="nv">Apr</span><span class="p">,</span> <span class="nv">May</span><span class="p">,</span> <span class="nv">Jun</span><span class="p">,</span>
                  <span class="nv">Jul</span><span class="p">,</span> <span class="nv">Aug</span><span class="p">,</span> <span class="nv">Sep</span><span class="p">,</span> <span class="nv">Oct</span><span class="p">,</span> <span class="nv">Nov</span><span class="p">,</span> <span class="nv">Dec</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Month</span><span class="p">)</span> <span class="kr">of</span> <span class="n">Month_Duration</span><span class="p">;</span>
   <span class="c1">--                          ^ Can use an enum as the</span>
   <span class="c1">--                            index</span>

   <span class="no">Tab</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">My_Int_Array</span> <span class="p">:=</span>
   <span class="c1">--    ^ constant is like a variable but cannot be</span>
   <span class="c1">--      modified</span>
     <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>
   <span class="c1">--  Maps months to number of days</span>

   <span class="n">Feb_Days</span> <span class="p">:</span> <span class="n">Month_Duration</span> <span class="p">:=</span> <span class="n">Tab</span> <span class="p">(</span><span class="n">Feb</span><span class="p">);</span>
   <span class="c1">--  Number of days in February</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">Month</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span>
        <span class="p">(</span><span class="n">Month</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; has &quot;</span>
         <span class="o">&amp;</span> <span class="n">Month_Duration</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">M</span><span class="p">))</span>  <span class="o">&amp;</span> <span class="s">&quot; days.&quot;</span><span class="p">);</span>
         <span class="c1">--                                ^ Concatenation operator</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example above, we are:</p>
<ul class="simple">
<li>Creating an array type mapping months to month durations in days.</li>
<li>Creating an array, and instanciating it with an aggregate mapping months to
their actual durations in days.</li>
<li>Iterating on the array, printing out the months, and the number of days for
each.</li>
</ul>
<p>Being able to use enums as indices is very useful to create mappings such as
this one, and is an often used feature in Ada.</p>
</div>
<div class="section" id="indexation">
<h2>Indexation<a class="headerlink" href="#indexation" title="Permalink to this headline">¶</a></h2>
<p>We have already seen the syntax to get the elements of an array. There are
however a few more things to say about it.</p>
<p>First of all, as many things in Ada, this operation is strongly typed. If you
use a value of the wrong type to index the array, you will get a compile time
error.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Index</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Index</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span> <span class="kr">loop</span>
   <span class="c1">--       ^ I is of type Index, ranges between 1 and 5</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="c1">--                         ^ Compile time error</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Second, arrays in Ada are bounds checked. This means that if you try to access
an element outside of the bounds of the array, you will get a runtime error
instead of accessing random memory as in unsafe languages.</p>
<div class="ada-run ada-run-expect-failure highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Index</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Index</span> <span class="kr">range</span> <span class="mi">2</span> <span class="p">..</span> <span class="mi">6</span> <span class="kr">loop</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
      <span class="c1">--                      ^ Will raise an exception when</span>
      <span class="c1">--                      I = 6</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="simpler-array-declarations">
<h2>Simpler array declarations<a class="headerlink" href="#simpler-array-declarations" title="Permalink to this headline">¶</a></h2>
<p>In the previous examples, we have always showcased the creation of a dedicated
index type for the array. While this can be useful, for typing and readability
purposes, sometimes you just want an anonymous range that you can use in that
context. Ada allows you to do that too.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="c1">--                          ^ Subtype of Integer</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span> <span class="kr">loop</span>
   <span class="c1">--       ^ Likewise</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>In the preceding example, we declare the range of the array via the range
syntax, which will declare an anonymous subtype of integer and 8se it to index
the array.</p>
<p>This means that the type of the index is <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code>. Coincidently, when you
use an anonymous range in a for loop as in the example above, the type of the
iteration variable is also <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code>, which is why you can use <code class="docutils literal notranslate"><span class="pre">I</span></code> to
index <code class="docutils literal notranslate"><span class="pre">Tab</span></code>.</p>
<p>You can also use a named subtype as bounds for an array.</p>
</div>
<div class="section" id="range-attribute">
<h2>Range attribute<a class="headerlink" href="#range-attribute" title="Permalink to this headline">¶</a></h2>
<p>We have said before that hard coding bounds (especially the lower bound) when
accessing or iterating on an array is generally a bad idea, and showcased how
to use the type/subtype of the array to iterate on its range in a for loop. The
problem with the above feature where we declare an anonymous range for the
array is that suddenly we have no name to refer to the range. Ada fixes that
via an attribute on array objects:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Tab</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
   <span class="c1">--          ^ Gets the range of Tab</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>If you want more fine grained control, you can use the separate attributes
<code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">First</span></span></code> and <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">Last</span></span></code>.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Int</span> <span class="kr">is</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">1000</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">My_Int_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="kr">of</span> <span class="n">My_Int</span><span class="p">;</span>
   <span class="n">Tab</span> <span class="p">:</span> <span class="n">My_Int_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Tab</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="n">Tab</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">-</span> <span class="mi">1</span> <span class="kr">loop</span>
   <span class="c1">--          ^ Iterate on every index except the last</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">My_Int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Tab</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>Of note, all those attributes, <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">Range</span></span></code>, <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">First</span></span></code> and <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">‘</span></span><span class="name attribute"><span class="pre">Last</span></span></code>,
will work on array instances just as well as they work on discrete types and
subtypes themselves, enumerations included.</p>
</div>
<div class="section" id="unconstrained-arrays">
<h2>Unconstrained arrays<a class="headerlink" href="#unconstrained-arrays" title="Permalink to this headline">¶</a></h2>
<p>Let’s enter in one of the most complex and powerful areas of arrays in Ada.
Every array type we defined so far has a fixed size: Every instance of this
type will have the same size, and the same number of elements.</p>
<p>However, Ada also allows you to declare array types whose bounds are not fixed:
In that case, the bounds will need to be provided when instanciating the type.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Workload_Type</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Days</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Natural</span><span class="p">;</span>
   <span class="c1">--  Indefinite array type</span>
   <span class="c1">--                           ^ Bounds are of type Days,</span>
   <span class="c1">--                             but not known</span>

   <span class="no">Workload</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Workload_Type</span> <span class="p">(</span><span class="n">Monday</span> <span class="p">..</span> <span class="n">Friday</span><span class="p">)</span> <span class="p">:=</span>
   <span class="c1">--                                 ^ Specify the bounds</span>
   <span class="c1">--                                   when declaring</span>
      <span class="p">(</span><span class="n">Friday</span> <span class="p">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="kr">others</span> <span class="p">=&gt;</span> <span class="mi">8</span><span class="p">);</span>
   <span class="c1">--               ^ Default value</span>
   <span class="c1">--  ^ Specify element by name of index</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Workload</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Workload</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>The fact that the bounds of the array are not known is indicated by the <code class="docutils literal notranslate"><span class="pre">Days</span>
<span class="pre">range</span> <span class="pre">&lt;&gt;</span></code> syntax. Given a discrete type <code class="docutils literal notranslate"><span class="pre">Discrete_Type</span></code>, while using
<code class="docutils literal notranslate"><span class="pre">Discrete_Type</span></code> for the index specifies that we are going to use
this type as the type and the index and for the bounds, using <code class="docutils literal notranslate"><span class="pre">Discrete_Type</span>
<span class="pre">range</span> <span class="pre">&lt;&gt;</span></code> means that we use this type for the type of the index but that the
bounds are not yet constrained.</p>
<p>Those array types are thus called unconstrained, and the bounds need to be
provided at the moment of instantiation, as we can see in the example above.</p>
<p>The above example also shows more of the aggregate syntax: You can specify
associations by name, by giving the value of the index on the left side of an
arrow association. <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">=&gt;</span> <span class="pre">2</span></code> hence means “assign value 2 to spot at index 1 in
my array”. <code class="docutils literal notranslate"><span class="pre">others</span> <span class="pre">=&gt;</span> <span class="pre">8</span></code> means “assign value 8 to every spot that wasn’t
previously assigned in this aggregate”.</p>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p class="last">While superficially unconstrained arrays in Ada might look similar to
variable length arrays in C, they are in reality much more powerful,
because they’re truly first class values in the language. You can pass them
as parameters or return values in subprograms, and they carry their bounds
inside the data type. This means that it is useless to pass the length of
an array explictly along with the array, because it is accessible via the
attributes demonstrated in the previous paragraph.</p>
</div>
</div>
<div class="section" id="predefined-array-type-string">
<h2>Predefined array type: String<a class="headerlink" href="#predefined-array-type-string" title="Permalink to this headline">¶</a></h2>
<p>A recurring theme in our introduction to Ada types has been the way important
built-in types like <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Boolean</span></span></code> or <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> have been built with the
same facilities that are available to the user. This is also true for strings:
The string type in Ada is a simple array.</p>
<p>Here is how the string type is defined in Ada:</p>
<p>The only built-in feature Ada adds to make strings more ergonomic is custom
literals, as we can see in the example below.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p>String literals are just sugar on top of aggregates, so that in the
following example, A and B are exactly similar declarations</p>
<div class="last highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">String_Literals</span> <span class="kr">is</span>
    <span class="c1">--  Those two declarations produce the same thing</span>
    <span class="n">A</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">11</span><span class="p">)</span> <span class="p">:=</span> <span class="s">&quot;Hello World&quot;</span><span class="p">;</span>
    <span class="n">B</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">11</span><span class="p">)</span> <span class="p">:=</span> <span class="p">(&#39;</span><span class="na">H</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">e</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">l</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">l</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">o</span><span class="p">&#39;,</span> <span class="s s-Character">&#39; &#39;</span><span class="p">,</span>
                             <span class="p">&#39;</span><span class="na">W</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">o</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">r</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">l</span><span class="p">&#39;,</span> <span class="p">&#39;</span><span class="na">d</span><span class="p">&#39;);</span>
<span class="kr">end</span> <span class="nf">String_Literals</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="n">Message</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">11</span><span class="p">)</span> <span class="p">:=</span> <span class="s">&quot;dlroW olleH&quot;</span><span class="p">;</span>
   <span class="c1">--        ^ Pre-defined array type.</span>
   <span class="c1">--          Component type is Character</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="kr">reverse</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">11</span> <span class="kr">loop</span>
      <span class="c1">--    ^ Iterate in reverse order</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">Message</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<p>However, what we can notice is that having to declare the bounds of the object
explicitly is a bit of a hassle: One needs to manually calculate the size of
the literal. Luckily Ada allows you to not do it.</p>
<p>Ada allows the user to omit the bounds when instanciating an unconstrained
array type, if the bounds can be deduced from the initialization expression.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Greet</span> <span class="kr">is</span>
   <span class="no">Message</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">String</span> <span class="p">:=</span> <span class="s">&quot;Hello World&quot;</span><span class="p">;</span>
   <span class="c1">--                 ^ Bounds are automatically computed</span>
   <span class="c1">--                   from initialization value</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="kr">reverse</span> <span class="n">Message</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
      <span class="n">Put</span> <span class="p">(</span><span class="n">Message</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="n">New_Line</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Greet</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Integer_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Natural</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Integer</span><span class="p">;</span>

   <span class="no">My_Array</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Integer_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
   <span class="c1">--                  ^ Bounds are automatically computed</span>
   <span class="c1">--                    from initialization value</span>
<span class="kr">begin</span>
    <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<p>A very important point about arrays: Bounds <em>have</em> to be known when
instantiating the object. It is for example illegal to do the following.</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span> <span class="kr">declare</span>
    <span class="n">A</span> <span class="p">:</span> <span class="kt">String</span><span class="p">;</span>
 <span class="kr">begin</span>
    <span class="n">A</span> <span class="p">:=</span> <span class="s">&quot;World&quot;</span><span class="p">;</span>
 <span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
<p>Also, while you of course change elements in the array, you cannot change its
size after it has been initialized, so this is also illegal:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">declare</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="s">&quot;World&quot;</span><span class="p">;</span> <span class="c1">--  Legal: Same size</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="s">&quot;Hello World&quot;</span><span class="p">;</span> <span class="c1">--  Illegal: Different size</span>
<span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
<p>Also, while you can expect a warning for this kind of errors in very simple
cases like this one, it is impossible for a compiler to know in the general
case if you are assigning a value of the correct length, so this violation will
generally result in a runtime error.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>While we will learn more about this later, it is important to know right
away that arrays are not the only types whose instances might be of unknown
size at compile-time.</p>
<p>Those objects are said to be of an <em>indefinite subtype</em>. Which means that
the subtype size is not known at compile-time, but is dynamically computed
at run-time.</p>
<div class="last highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Indefinite_Subtypes</span> <span class="kr">is</span>
    <span class="kd">function</span> <span class="nf">Get_Number</span> <span class="nf">return</span> <span class="nf">Integer</span> <span class="kr">is</span>
    <span class="kr">begin</span>
        <span class="kr">return</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Value</span><span class="p">(</span><span class="n">Get_Line</span><span class="p">);</span>
    <span class="kr">end</span> <span class="nf">Get_Number</span><span class="p">;</span>

   <span class="n">A</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span>
   <span class="c1">--  Indefinite subtype</span>

   <span class="n">B</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="p">:=</span> <span class="s">&quot;Hello&quot;</span><span class="p">;</span>
   <span class="c1">--  Definite subtype</span>

   <span class="n">C</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="n">Get_Number</span><span class="p">);</span>
   <span class="c1">--  Indefinite subtype (Get_Number&#39;s value is computed at run-time)</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Indefinite_Subtypes</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="declaring-arrays-2">
<h2>Declaring arrays (2)<a class="headerlink" href="#declaring-arrays-2" title="Permalink to this headline">¶</a></h2>
<p>While we can have, as we saw, array types whose exact representation is not
known at compile-time - which means, in effect, that their size and bounds are
determined at runtime - the component type of arrays needs to be of a definite
and constrained type.</p>
<p>Hence, if you need to declare, for example, and array of strings, the string
subtype used as component will need to have a fixed size.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Days</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">subtype</span> <span class="kt">Day_Name</span> <span class="kr">is</span> <span class="kt">String</span> <span class="p">(</span><span class="nv">1</span> <span class="p">..</span> <span class="nv">2</span><span class="p">);</span>
   <span class="c1">--  Subtype of string with known size</span>

   <span class="kd">type</span> <span class="kt">Days_Name_Type</span>
   <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Days</span><span class="p">)</span> <span class="kr">of</span> <span class="n">Day_Name</span><span class="p">;</span>
   <span class="c1">--        ^ Type of the index</span>
   <span class="c1">--                 ^ Type of the element. Must be</span>
   <span class="c1">--                   definite</span>

   <span class="no">Names</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Days_Name_Type</span> <span class="p">:=</span>
     <span class="p">(</span><span class="s">&quot;Mo&quot;</span><span class="p">,</span> <span class="s">&quot;Tu&quot;</span><span class="p">,</span> <span class="s">&quot;We&quot;</span><span class="p">,</span> <span class="s">&quot;Th&quot;</span><span class="p">,</span> <span class="s">&quot;Fr&quot;</span><span class="p">,</span> <span class="s">&quot;Sa&quot;</span><span class="p">,</span> <span class="s">&quot;Su&quot;</span><span class="p">);</span>
   <span class="c1">--  Initial value given by aggregate</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Names</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Names</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Days</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="array-slices">
<h2>Array slices<a class="headerlink" href="#array-slices" title="Permalink to this headline">¶</a></h2>
<p>One last interesting feature of Ada arrays that we’re going to cover is array
slices: It is possible to take and use a slice of an array in an expression.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
    <span class="n">Buf</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="s">&quot;Hello ...&quot;</span><span class="p">;</span>

    <span class="n">Full_Name</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="s">&quot;John Smith&quot;</span><span class="p">;</span>
<span class="kr">begin</span>
    <span class="n">Buf</span> <span class="p">(</span><span class="mi">7</span> <span class="p">..</span> <span class="mi">9</span><span class="p">)</span> <span class="p">:=</span> <span class="s">&quot;Bob&quot;</span><span class="p">;</span>
    <span class="c1">--  Careful! This works because the string on the right side is the</span>
    <span class="c1">--  same size as the replaced slice!</span>

    <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Buf</span><span class="p">);</span>  <span class="c1">--  Prints &quot;Hello Bob&quot;</span>

    <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Hi &quot;</span> <span class="o">&amp;</span> <span class="n">Full_Name</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">4</span><span class="p">));</span> <span class="c1">--  Prints &quot;Hi John&quot;</span>
<span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see above, you can also use a slice on the left side of an
assignment, to replace only part of an array.</p>
<p>A slice of an array is of the same type as the array, but has a different
subtype, constrained by the bounds of the slice.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Slices will only work on one dimensional arrays.</p>
</div>
</div>
</div>
<div class="section" id="modular-structured-programming">
<h1>Modular/Structured programming<a class="headerlink" href="#modular-structured-programming" title="Permalink to this headline">¶</a></h1>
<p>So far, we manager to put our examples in the body of a procedure. Ada is
helpful in that regard, since it allows you to put any declaration in any
declarative part, which allowed us to declare our types and instances in the
body of the main procedure of our examples.</p>
<p>However, it is easy to see that this is not going to scale forever, and that
before long, we will need a better way to structure our programs into modular
and distinct units.</p>
<p>Ada encourages the separation of programs into multiple packages and
sub-packages, providing many tools to the programmer trying to fullfil his
quest of a perfectly organized code-base.</p>
<div class="section" id="packages">
<h2>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">¶</a></h2>
<p>Here is how you declare a package in Ada:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Week</span> <span class="kr">is</span>

   <span class="c1">--  This is a declarative part. You can put only</span>
   <span class="c1">--  declarations here, no statements</span>

   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
      <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Workload_Type</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Days</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Natural</span><span class="p">;</span>

   <span class="no">Workload</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Workload_Type</span> <span class="p">:=</span>
      <span class="p">(</span><span class="n">Monday</span> <span class="p">..</span> <span class="n">Thursday</span> <span class="p">=&gt;</span> <span class="mi">8</span><span class="p">,</span>
       <span class="n">Friday</span> <span class="p">=&gt;</span> <span class="mi">7</span><span class="p">,</span>
       <span class="n">Saturday</span> <span class="p">|</span> <span class="n">Sunday</span> <span class="p">=&gt;</span> <span class="mi">0</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Week</span><span class="p">;</span>
</pre></div>
</div>
<p>And here is how you use it:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Week</span><span class="p">;</span>
<span class="c1">--  References the Week package, and adds a dependency from the main unit</span>
<span class="c1">--  to the week unit.</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">Week</span><span class="p">.</span><span class="n">Days</span> <span class="kr">loop</span>
   <span class="c1">--       ^ Reference to Week.Days enum type</span>
      <span class="n">Put_Line</span>
        <span class="p">(</span><span class="s">&quot;Workload for day &quot;</span> <span class="o">&amp;</span> <span class="n">Week</span><span class="p">.</span><span class="n">Days</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">D</span><span class="p">)</span>
         <span class="o">&amp;</span> <span class="s">&quot; is &quot;</span> <span class="o">&amp;</span> <span class="kt">Natural</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Week</span><span class="p">.</span><span class="n">Workload</span> <span class="p">(</span><span class="n">D</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Packages are a way to make your code modular, separating your programs into
semantically significant units. Additionally they will allow the programmer to
generally compile his program faster by leveraging separate compilation.</p>
<p>While the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code> clause indicates a dependency, you can see in the example
above that you still need to prefix the use of entities from the week package
by the name of the package.</p>
<p>Accessing entities from a package uses the dot notation, <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">A</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">B</span></span></code>, which is
the same notation as the one to access records fields.</p>
<p>A <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code> clause <em>has</em> to happen in the prelude of a compilation unit. It
is not allowed anywhere else.</p>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p>Packages look similar to, but are underneath very different from header
files in C/C++.</p>
<ul class="last">
<li><p class="first">The first and most important distinction is that packages are a language
level mechanism, by opposition to includes, which are a functionality of the
C preprocessor.</p>
</li>
<li><p class="first">The first corollary of this design divergence is that the mechanism is a
semantic inclusion mechanism, not a text inclusion mechanism. Hence, when
you with a package, you say “I’m depending on this semantic unit” to the
compiler, not “include this bunch of text in place here”.</p>
</li>
<li><p class="first">The consequences for the user, is that the content of a package cannot
<em>vary</em> depending on where it has been included from, unlike in C/C++,
where the existence of the preprocessor makes the exact content of what
is included undecidable.</p>
<p>This allows compilation/recompilation to be more efficient. It also
allows tooling like IDEs to have correct information about the semantics
of a program. In turn, this allows better tooling in general, and code
that is more analyzable, even by humans.</p>
</li>
</ul>
</div>
<div class="admonition-in-the-gnat-toolchain admonition">
<p class="first admonition-title">In the GNAT toolchain</p>
<p class="last">While the design of the Ada language does not mandate anything regarding the
organization of files with regards to packages, eg. in theory you can put all
your code in one file, or use your own scheme of organization, in practice in
GNAT, you’re supposed to put each top-level compilation unit in a separate
file. In the example above, the <code class="docutils literal notranslate"><span class="pre">Week</span></code> package will go in a <code class="docutils literal notranslate"><span class="pre">.ads</span></code> file
(for Ada specification), and the <code class="docutils literal notranslate"><span class="pre">Main</span></code> procedure will go in a <code class="docutils literal notranslate"><span class="pre">.adb</span></code> file
(for Ada body).</p>
</div>
</div>
<div class="section" id="using-a-package">
<h2>Using a package<a class="headerlink" href="#using-a-package" title="Permalink to this headline">¶</a></h2>
<p>As we have seen above, we use the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code> clause to indicate a dependency on
another package. However, every use of entities coming from the <code class="docutils literal notranslate"><span class="pre">Week</span></code>
package had to be prefixed by the full name of the package. It is possible to
make every entity of a package visible directly in the current scope, using the
<code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> clause.</p>
<p>In fact, we have been using the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> clause since almost the beginning of
this tutorial.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="c1">--                    ^ Make every entity of the Ada.Text_IO package</span>
<span class="c1">--                      directly visible.</span>
<span class="kn">with</span> <span class="nn">Week</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kn">use</span> <span class="nn">Week</span><span class="p">;</span>
   <span class="c1">--  Make every entity of the Week package directly visible.</span>
<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">Week</span><span class="p">.</span><span class="n">Days</span> <span class="kr">loop</span>
   <span class="c1">--       ^ Reference to Week.Days enum type</span>
      <span class="n">Put_Line</span>  <span class="c1">-- Put_Line comes from Ada.Text_IO.</span>
        <span class="p">(</span><span class="s">&quot;Workload for day &quot;</span> <span class="o">&amp;</span> <span class="n">Days</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">D</span><span class="p">)</span>
         <span class="o">&amp;</span> <span class="s">&quot; is &quot;</span> <span class="o">&amp;</span> <span class="kt">Natural</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Workload</span> <span class="p">(</span><span class="n">D</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>As you can see in the example above:</p>
<ul class="simple">
<li><code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Put_Line</span></span></code> is a subprogram that comes from the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Ada</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Text_IO</span></span></code>
package. We can use it directly because we have used the package at the top
of the <code class="docutils literal notranslate"><span class="pre">Main</span></code> unit.</li>
<li>Unlike <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code> clauses, <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> clause can happen either in the prelude, or
in any declarative zone. If used in a declarative zone, the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> clause
will have an effect in it’s containing lexical scope.</li>
</ul>
</div>
<div class="section" id="package-body">
<h2>Package body<a class="headerlink" href="#package-body" title="Permalink to this headline">¶</a></h2>
<p>In the somewhat artificial example above, the <code class="docutils literal notranslate"><span class="pre">Week</span></code> package only has
declarations and no body. That’s not a mistake: In a package specification,
which is what is showcased above, you cannot declare bodies. Those have to be
in the package body.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Week_2</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
      <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">Get_Workload</span> <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Natural</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Week_2</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">Week_2</span> <span class="kr">is</span>

   <span class="c1">--  The body contains additional declarations, not visible from the</span>
   <span class="c1">--  spec, or anywhere outside of the body</span>
   <span class="kd">type</span> <span class="kt">WorkLoad_Type</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Days</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Natural</span><span class="p">;</span>
   <span class="no">Workload</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Workload_Type</span> <span class="p">:=</span>
      <span class="p">(</span><span class="n">Monday</span> <span class="p">..</span> <span class="n">Thursday</span> <span class="p">=&gt;</span> <span class="mi">8</span><span class="p">,</span> <span class="n">Friday</span> <span class="p">=&gt;</span> <span class="mi">7</span><span class="p">,</span> <span class="n">Saturday</span> <span class="p">|</span> <span class="n">Sunday</span> <span class="p">=&gt;</span> <span class="mi">0</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">Get_Workload</span> <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Natural</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">return</span> <span class="n">Workload</span> <span class="p">(</span><span class="n">Day</span><span class="p">);</span>
   <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Week_2</span><span class="p">;</span>
</pre></div>
</div>
<p>Here we can see that the body of the <code class="docutils literal notranslate"><span class="pre">Get_Workload</span></code> function has to be
declared in the body. Coincidentally, introducing a body allows us to put the
<code class="docutils literal notranslate"><span class="pre">Workload_Type</span></code> array type and the constant <code class="docutils literal notranslate"><span class="pre">Workload</span></code> in the body, and
make them inaccessible to the user of the <code class="docutils literal notranslate"><span class="pre">Week</span></code> package, providing a first
form of encapsulation.</p>
<p>This works because entities of the body are <em>only</em> visible in the body.</p>
</div>
</div>
<div class="section" id="subprograms">
<h1>Subprograms<a class="headerlink" href="#subprograms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>Subprograms<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>So far, we used procedures a bit, mostly so we have a main body of code to
execute, and showed one function or two. Those entities belong to a category
called subprograms.</p>
<p>There are two kinds of subprograms in Ada, functions and procedures. The main
useful distinction between the two is that functions return a value, and
procedures don’t.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Week_3</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">Get_Workload</span> <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Natural</span><span class="p">;</span>
   <span class="c1">--  We declare (but don&#39;t define) a function with one</span>
   <span class="c1">--  parameter, returning a Natural integer</span>
<span class="kr">end</span> <span class="nf">Week_3</span><span class="p">;</span>
</pre></div>
</div>
<p>As we saw before in the packages section, if you want to declare a subprogram
declaration to the package declaration. This declaration will not define the
function’s body, only its name and profile (and hopefully some documentation),
so that clients of the package know how to use it.</p>
<p>Subprograms in Ada can expectedly have parameters. One syntactically important
note is that a subprogram which has no parameters does not have a parameter
section at all, following the form <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">procedure</span></span> <span class="error"><span class="pre">[</span></span><span class="name function"><span class="pre">name</span></span><span class="error"><span class="pre">]</span></span></code> or
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">function</span></span> <span class="error"><span class="pre">[</span></span><span class="name function"><span class="pre">name</span></span><span class="error"><span class="pre">]</span></span> <span class="name function"><span class="pre">return</span></span> <span class="error"><span class="pre">[</span></span><span class="name function"><span class="pre">type</span></span><span class="error"><span class="pre">]</span></span></code>.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Week_4</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">Get_Day_Name</span>
      <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span> <span class="p">:=</span> <span class="nv">Monday</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
   <span class="c1">--                               ^ We can return any type,</span>
   <span class="c1">--                                 even indefinite ones</span>
   <span class="c1">--             ^ Default value for parameter</span>
<span class="kr">end</span> <span class="nf">Week_4</span><span class="p">;</span>
</pre></div>
</div>
<p>We learn two interesting things in the example above:</p>
<ul class="simple">
<li>Parameters can also have default values. When calling the subprogram, you can
then omit parameters if they have a default value. A call to a subprogram
without parameters does not need parentheses, similarly to when it is
declared.</li>
<li>The return type of a function can be anything. objects of size unknown at
compile time are fine. Note that this also true for parameters.</li>
</ul>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p>Returning variable size objects in languages lacking a garbage collector is
a bit complicated implementation-wize, which is why C and C++ don’t allow
it, prefering to ressort to explicit dynamic allocation from the user.</p>
<p>The problem is that explicit dynamic allocation is unsafe as soon as you
want to collect unused memory. Ada’s ability to return variable size
objects will remove one use case for dynamic allocation, and hence, remove
one potential source of bugs from your programs.</p>
<p class="last">Rust follows the C/C++ model, but with it’s safe pointer semantics, allows
for safety. However, dynamic allocation is still used. Ada can benefit from
an eventual performance edge because it can use any model.</p>
</div>
<p>As we showed briefly above, a subprogram declaration in a package declaration
must be completed by a subprogram body in the package body. For the <code class="docutils literal notranslate"><span class="pre">Week</span></code>
package above, we could have the following body:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="kd">body</span> <span class="nc">Week_4</span> <span class="kr">is</span>
   <span class="c1">--  Implementation of the Get_Day_Name function</span>
   <span class="kd">function</span> <span class="nf">Get_Day_Name</span> <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span> <span class="p">:=</span> <span class="nv">Monday</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">return</span>
        <span class="p">(</span><span class="kr">case</span> <span class="n">Day</span> <span class="kr">is</span>
         <span class="kr">when</span> <span class="n">Monday</span> <span class="p">=&gt;</span> <span class="s">&quot;Monday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Tuesday</span> <span class="p">=&gt;</span> <span class="s">&quot;Tuesday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Wednesday</span> <span class="p">=&gt;</span> <span class="s">&quot;Wednesday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Thursday</span> <span class="p">=&gt;</span> <span class="s">&quot;Thursday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Friday</span> <span class="p">=&gt;</span> <span class="s">&quot;Friday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Saturday</span> <span class="p">=&gt;</span> <span class="s">&quot;Saturday&quot;</span><span class="p">,</span>
         <span class="kr">when</span> <span class="n">Sunday</span> <span class="p">=&gt;</span> <span class="s">&quot;Sunday&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Get_Day_Name</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Week_4</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="subprogram-calls">
<h3>Subprogram calls<a class="headerlink" href="#subprogram-calls" title="Permalink to this headline">¶</a></h3>
<p>We can then call our subprogram this way:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Week_4</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Days</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Week_4</span><span class="p">.</span><span class="n">Get_Day_Name</span><span class="p">);</span>
   <span class="c1">--             ^ Paramless call, value of Day parameter is Monday</span>
   <span class="kr">for</span> <span class="n">Day</span> <span class="ow">in</span> <span class="n">Week_4</span><span class="p">.</span><span class="n">Days</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Week_4</span><span class="p">.</span><span class="n">Get_Day_Name</span> <span class="p">(</span><span class="n">Day</span><span class="p">));</span>
      <span class="c1">--                           ^ Regular param passing</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Week_4</span><span class="p">.</span><span class="n">Get_Day_Name</span> <span class="p">(</span><span class="n">Day</span> <span class="p">=&gt;</span> <span class="n">Week_4</span><span class="p">.</span><span class="n">Friday</span><span class="p">));</span>
   <span class="c1">--                           ^ Named param passing</span>
<span class="kr">end</span> <span class="nf">Show_Days</span><span class="p">;</span>
</pre></div>
</div>
<p>Ada allows you to name the parameters when you pass them, whether they have a
default or not. There are some rules:</p>
<ul class="simple">
<li>Positional parameters come first.</li>
<li>A positional parameter cannot follow a named parameter.</li>
</ul>
<p>As a convention, people usually name parameters at the call site if the
function’s corresponding parameters has a default value. However, it is also
perfectly acceptable to name every parameter if it makes the code clearer.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Week_5</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span>
                 <span class="nv">Thursday</span><span class="p">,</span> <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Language</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">English</span><span class="p">,</span> <span class="nv">Italian</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">Get_Day_Name</span>
     <span class="p">(</span><span class="nv">Day</span> <span class="p">: </span><span class="nv">Days</span><span class="p">;</span> <span class="nv">Lang</span> <span class="p">: </span><span class="nv">Language</span> <span class="p">:=</span> <span class="nv">English</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Week_5</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Week_5</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Week_5</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Get_Day_Name</span> <span class="p">(</span><span class="n">Monday</span><span class="p">,</span> <span class="n">Lang</span> <span class="p">=&gt;</span> <span class="n">Italian</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="function-calls">
<h3>Function calls<a class="headerlink" href="#function-calls" title="Permalink to this headline">¶</a></h3>
<p>An important thing about function calls is that the return value of a function
call cannot be ignored in Ada.</p>
<p>If you want to call a function and do not need it’s result, you will still need
to explicitly store it in a local variable.</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nf">Quadruple</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span> <span class="kr">is</span>
    <span class="kd">function</span> <span class="nf">Double</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span> <span class="kr">is</span>
    <span class="kr">begin</span>
       <span class="kr">return</span> <span class="n">I</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kr">end</span> <span class="nf">Double</span><span class="p">;</span>

   <span class="n">Res</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">Double</span> <span class="p">(</span><span class="n">Double</span> <span class="p">(</span><span class="n">I</span><span class="p">));</span>
   <span class="c1">--               ^ Calling the double function</span>
<span class="kr">begin</span>
   <span class="n">Double</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
   <span class="c1">--  ERROR: cannot use call to function &quot;Double&quot; as a statement</span>

   <span class="kr">return</span> <span class="n">Res</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Quadruple</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-in-gnat admonition">
<p class="first admonition-title">In GNAT</p>
<p>In GNAT, with all warnings activated, it becomes even harder to ignore the
result of a function, because unused variables will be flagged, so for
example this code would not be valid:</p>
<div class="ada-syntax-only highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nf">Read_Int</span>
   <span class="p">(</span><span class="nv">Stream</span> <span class="p">: </span><span class="nv">Network_Stream</span><span class="p">;</span> <span class="nv">Result</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
    <span class="n">Stream</span> <span class="p">:</span> <span class="n">Network_Stream</span> <span class="p">:=</span> <span class="n">Get_Stream</span><span class="p">;</span>
    <span class="n">My_Int</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
    <span class="n">B</span> <span class="p">:</span> <span class="kt">Boolean</span> <span class="p">:=</span> <span class="n">Read_Int</span> <span class="p">(</span><span class="n">Stream</span><span class="p">,</span> <span class="n">My_Int</span><span class="p">);</span>  <span class="c1">-- Warning here, B is never read</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>You then have two solutions to silence this warning:</p>
<ul class="simple">
<li>Either annotate the variable with a Unreferenced pragma, thusly:</li>
</ul>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="p">:</span> <span class="kt">Boolean</span> <span class="p">:=</span> <span class="n">Read_Int</span> <span class="p">(</span><span class="n">Stream</span><span class="p">,</span> <span class="n">My_Int</span><span class="p">);</span>
<span class="kr">pragma</span> <span class="cp">Unreferenced</span> <span class="p">(</span><span class="n">B</span><span class="p">);</span>
</pre></div>
</div>
<ul class="last simple">
<li>Either give the variable a name that contains any of the strings <code class="docutils literal notranslate"><span class="pre">discard</span></code>
<code class="docutils literal notranslate"><span class="pre">dummy</span></code> <code class="docutils literal notranslate"><span class="pre">ignore</span></code> <code class="docutils literal notranslate"><span class="pre">junk</span></code> <code class="docutils literal notranslate"><span class="pre">unused</span></code> (case insensitive)</li>
</ul>
</div>
</div>
</div>
<div class="section" id="parameters-modes">
<h2>Parameters modes<a class="headerlink" href="#parameters-modes" title="Permalink to this headline">¶</a></h2>
<p>So far we have seen that Ada is a safety focused language. There are many ways
this focus surfaces, but two important points are:</p>
<ul class="simple">
<li>Ada makes the user specify as much as possible about the behavior he expects
out of his program, so that the compiler can warn or error-out if there is an
inconsistency.</li>
<li>Ada tries to discourage as much as possible the use of pointers and dynamic
memory allocation, giving other ways to achieve goals that would have been
accomplished this way in other languages.</li>
</ul>
<p>Parameters modes are a feature that helps achieve the two design goals above. A
function parameter necessarily has a mode, that is one of the three following modes.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">in</span></span></code></td>
<td>Parameter can only be read, not written</td>
</tr>
<tr class="row-even"><td><code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">out</span></span></code></td>
<td>Parameter can only be written to, not read</td>
</tr>
<tr class="row-odd"><td><code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">in</span></span> <span class="keyword reserved"><span class="pre">out</span></span></code></td>
<td>Parameter can be both read and written</td>
</tr>
</tbody>
</table>
<p>The default mode for parameters is <code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">in</span></span></code>, so, so far, every example we have
been showing has been using <code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">in</span></span></code> parameters.</p>
<div class="admonition-historically admonition">
<p class="first admonition-title">Historically</p>
<p class="last">Functions and procedures were originally more different in philosophy.
Before Ada 2005, one wasn’t able to</p>
</div>
</div>
<div class="section" id="id2">
<h2>Subprogram calls<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="in-parameters">
<h3>In parameters<a class="headerlink" href="#in-parameters" title="Permalink to this headline">¶</a></h3>
<p>The first mode for parameter is the one we have been implicitly using so far.
Parameters passed using this mode cannot be modified, so that the following
program will cause an error:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Swap</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
   <span class="n">Tmp</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Tmp</span> <span class="p">:=</span> <span class="n">A</span><span class="p">;</span>

   <span class="c1">--  Error: assignment to &quot;in&quot; mode parameter not allowed</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="n">B</span><span class="p">;</span>
   <span class="c1">--  Error: assignment to &quot;in&quot; mode parameter not allowed</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Swap</span><span class="p">;</span>
</pre></div>
</div>
<p>The fact that this is the default mode in Ada is in itself very important. It
means that mutation on parameters will not happen unless you explicitly change
the mode.</p>
</div>
<div class="section" id="in-out-parameters">
<h3>In-out parameters<a class="headerlink" href="#in-out-parameters" title="Permalink to this headline">¶</a></h3>
<p>To fix our code above, we can use an in-out parameter.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">In_Out_Params</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Swap</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="n">Tmp</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">Tmp</span> <span class="p">:=</span> <span class="n">A</span><span class="p">;</span>
      <span class="n">A</span> <span class="p">:=</span> <span class="n">B</span><span class="p">;</span>
      <span class="n">B</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Swap</span><span class="p">;</span>

   <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">44</span><span class="p">;</span>
<span class="kr">begin</span>
    <span class="n">Swap</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
    <span class="n">Put_Line</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span> <span class="c1">--  Prints 44</span>
<span class="kr">end</span> <span class="nf">In_Out_Params</span><span class="p">;</span>
</pre></div>
</div>
<p>An in out parameter will allow read and write access to the object passed as
parameter, so in the example above, we can see that A is modified after the
call to multiply.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>While in-out parameters look a bit like references in C++, or regular
parameters in Java that are passed by-reference, the ARM does not mandate
by reference passing for in out parameters in general.</p>
<p class="last">In general, it is better to think of modes as higher level than by-value
versus by-reference semantics. For the compiler, it means that an array
passed as an in parameter might be passed by reference under the covers,
because it is more efficient (which does not change anything for the user
since he cannot modify the original object anyway).  Conversely, an in-out
parameter of a discrete type might be passed by copy because it is more
efficient.</p>
</div>
</div>
<div class="section" id="out-parameters">
<h3>Out parameters<a class="headerlink" href="#out-parameters" title="Permalink to this headline">¶</a></h3>
<p>Finally, the last mode is reserved for the cases where you only want to write
to a parameter. This allows to have parameters that behave a bit like return
values act for functions.</p>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p class="last">Ada doesn’t have a tuple construct, or by another means allows to return
multiple values from a subprogram (except by declaring a full blown record
type). Hence, a way to return multiple values from a subprogram is to use
out parameters.</p>
</div>
<p>For example, a procedure reading integers from the network could have one of
the following prototypes:</p>
<div class="ada-syntax-only highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Read_Int</span>
   <span class="p">(</span><span class="nv">Stream</span> <span class="p">: </span><span class="nv">Network_Stream</span><span class="p">;</span> <span class="nv">Success</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Boolean</span><span class="p">;</span> <span class="nv">Result</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">);</span>

<span class="kd">function</span> <span class="nf">Read_Int</span>
   <span class="p">(</span><span class="nv">Stream</span> <span class="p">: </span><span class="nv">Network_Stream</span><span class="p">;</span> <span class="nv">Result</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>
</pre></div>
</div>
<p>While ideally reading an out variable before writing to it would trigger an
error, doing that in an exhaustive and precise fashion is hard. So the ARM just
mandates that out parameter be treated like uninitialized variables.</p>
<div class="admonition-in-gnat admonition">
<p class="first admonition-title">In GNAT</p>
<p>GNAT will warn you in simple cases of erroneous use of out parameters,
emitting a warning. For example, the following program will emit a warning</p>
<div class="last highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Outp</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Foo</span> <span class="p">(</span><span class="nv">A</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">A</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">A</span> <span class="p">:=</span> <span class="n">B</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Foo</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Outp</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="forward-declaration-of-subprograms">
<h3>Forward declaration of subprograms<a class="headerlink" href="#forward-declaration-of-subprograms" title="Permalink to this headline">¶</a></h3>
<p>As we saw before, a subprogram can be declared without being defined, for
example in a package specification. This is possible in general, and can be
useful if you need subprograms to be mutually recursive, as in the example
below:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Mutually_Recursive_Subprograms</span> <span class="kr">is</span>
    <span class="kd">procedure</span> <span class="nf">Compute_A</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">);</span>
    <span class="c1">--  Forward declaration of Compute_A</span>

    <span class="kd">procedure</span> <span class="nf">Compute_B</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">)</span> <span class="kr">is</span>
    <span class="kr">begin</span>
       <span class="kr">if</span> <span class="n">V</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="kr">then</span>
          <span class="n">Compute_A</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
       <span class="c1">-- ^ Call to Compute_A</span>
       <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Compute_B</span><span class="p">;</span>

    <span class="kd">procedure</span> <span class="nf">Compute_A</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">)</span> <span class="kr">is</span>
    <span class="kr">begin</span>
       <span class="kr">if</span> <span class="n">V</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="kr">then</span>
          <span class="n">Compute_B</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
       <span class="c1">-- ^ Call to Compute_B</span>
       <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
    <span class="kr">end</span> <span class="nf">Compute_A</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Compute_A</span> <span class="p">(</span><span class="mi">15</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Mutually_Recursive_Subprograms</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="nested-subprograms">
<h3>Nested subprograms<a class="headerlink" href="#nested-subprograms" title="Permalink to this headline">¶</a></h3>
<p>A very useful functionality that is available for the programmer in Ada, and
that we already briefly mentioned, is that you can declare subprogram inside of
other subprograms.</p>
<p>This is a facility that is useful for two reasons:</p>
<ul class="simple">
<li>It allows you to organize your programs in a cleaner fashion: If you need a
subprogram only as an helper for another subprogram, then the good practice
is to nest it inside it.</li>
<li>It allows you to share state easily in a controlled fashion, because the
nested functions will have access to the parameters, and any local variables
declared before them.</li>
</ul>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Strings.Unbounded</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Strings.Unbounded</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Lists</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">String_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Positive</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">Unbounded_String</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_List</span> <span class="p">(</span><span class="nv">Strings</span> <span class="p">: </span><span class="nv">String_Array</span><span class="p">)</span> <span class="kr">is</span>
      <span class="n">Item_Number</span> <span class="p">:</span> <span class="kt">Positive</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span>

      <span class="kd">procedure</span> <span class="nf">Show_Item</span> <span class="p">(</span><span class="nv">Item</span> <span class="p">: </span><span class="nv">Unbounded_String</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="kt">Positive</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Item_Number</span><span class="p">)</span>
                   <span class="o">&amp;</span> <span class="s">&quot;. &quot;</span> <span class="o">&amp;</span> <span class="n">To_String</span> <span class="p">(</span><span class="n">Item</span><span class="p">));</span>
         <span class="n">Item_Number</span> <span class="p">:=</span> <span class="n">Item_Number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Show_Item</span><span class="p">;</span>

   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">Item</span> <span class="kr">of</span> <span class="n">Strings</span> <span class="kr">loop</span>
         <span class="n">Show_Item</span> <span class="p">(</span><span class="n">Item</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_List</span><span class="p">;</span>

   <span class="n">List</span> <span class="p">:</span> <span class="n">String_Array</span> <span class="p">:=</span>
     <span class="p">(</span><span class="n">To_Unbounded_String</span> <span class="p">(</span><span class="s">&quot;This&quot;</span><span class="p">),</span>
      <span class="n">To_Unbounded_String</span> <span class="p">(</span><span class="s">&quot;is&quot;</span><span class="p">),</span>
      <span class="n">To_Unbounded_String</span> <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">),</span>
      <span class="n">To_Unbounded_String</span> <span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">));</span>
<span class="kr">begin</span>
   <span class="n">Show_List</span> <span class="p">(</span><span class="n">List</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Lists</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="more-about-types">
<h1>More about types<a class="headerlink" href="#more-about-types" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aggregates-a-primer">
<h2>Aggregates: A primer<a class="headerlink" href="#aggregates-a-primer" title="Permalink to this headline">¶</a></h2>
<p>So far, we have talked about, and showcased aggregates quite a bit. Now we will
try and be more comprehensive about them.</p>
<p>Aggregates are the mean by which you will describe literal values for composite
types in Ada. They are a very powerful notation that will allow you to avoid
writing  procedural code for the instantiation of your data structures in many
cases.</p>
<p>A basic rule that has to be followed wh3n writing aggregates is that <em>every
component</em> of the described data type has to be specified, even components that
have a default value.</p>
<p>This means that the following code is incorrect:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Incorrect</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="n">Origin</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">:=</span> <span class="p">(</span><span class="n">X</span> <span class="p">=&gt;</span> <span class="mi">0</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Incorrect</span><span class="p">;</span>
</pre></div>
</div>
<p>There are a few shortcuts that you can use to make the notation more user
friendly:</p>
<ul class="simple">
<li>To tell the compiler to use the default value for a field, you can use the
<code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">&lt;&gt;</span></span></code> notation.</li>
<li>You can also use the <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">|</span></span></code> operator to mention several disjoint components
together.</li>
<li>You can use the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">others</span></span></code> qualifier to refer to every field that has not yet
been mentionned, provided all those fields have the same type.</li>
<li>You can use ranges to refer to ranges of indices in arrays.</li>
</ul>
<p>However, beware, for array aggregates, as soon as you used named associations,
all associations have to be named !</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Points</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Point_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Positive</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">Point</span><span class="p">;</span>

   <span class="n">Origin</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">:=</span> <span class="p">(</span><span class="n">X</span> <span class="p">|</span> <span class="n">Y</span> <span class="p">=&gt;</span> <span class="p">&lt;&gt;);</span>
   <span class="n">Origin_2</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">:=</span> <span class="p">(</span><span class="kr">others</span> <span class="p">=&gt;</span> <span class="p">&lt;&gt;);</span>

   <span class="n">Points_1</span> <span class="p">:</span> <span class="n">Point_Array</span> <span class="p">:=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
   <span class="n">Points_2</span> <span class="p">:</span> <span class="n">Point_Array</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">1</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">3</span> <span class="p">..</span> <span class="mi">20</span> <span class="p">=&gt;</span> <span class="p">&lt;&gt;);</span>
<span class="kr">end</span> <span class="nf">Points</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="overloading-and-qualified-expressions">
<h2>Overloading and qualified expressions<a class="headerlink" href="#overloading-and-qualified-expressions" title="Permalink to this headline">¶</a></h2>
<p>While we have mentioned it in the enumerations section TODOPUTLINK there is a
general concept of Ada which is the notion of overloading of names.</p>
<p>Let’s take a simple example: It is possible in Ada to have functions that have
the same name, but different arguments.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Pkg</span> <span class="kr">is</span>
   <span class="kd">function</span> <span class="nf">F</span> <span class="p">(</span><span class="nv">A</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kd">function</span> <span class="nf">F</span> <span class="p">(</span><span class="nv">A</span> <span class="p">: </span><span class="nv">Character</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>This is a common concept in programming languages, that is called
<a class="reference external" href="https://en.m.wikipedia.org/wiki/Function_overloading">overloading</a>, or name
overloading.</p>
<p>One of the pecularities of Ada is that it allows overloading on the return type
of a function.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Pkg</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">SSID</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Integer</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Convert</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">SSID</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kd">function</span> <span class="nf">Convert</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">SSID</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Pkg</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Pkg</span><span class="p">;</span>         <span class="kn">use</span> <span class="nn">Pkg</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">S</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="n">Convert</span> <span class="p">(</span><span class="mi">123_145_299</span><span class="p">);</span>
   <span class="c1">--            ^ Valid, will choose the proper Convert</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">This explains why you can have multiple enumeration literals with the same
name: Return type overloading is allowed on both functions and enumerations
in Ada. Actually, the ARM says that enumeration literals are treated like
null-arity functions.</p>
</div>
<p>The problem is that, sometimes, there is an ambiguity such that the compiler
cannot actually resolve the names of an expression. This is where the qualified
expression becomes useful.</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Pkg</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">SSID</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Integer</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Convert</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">SSID</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kd">function</span> <span class="nf">Convert</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">SSID</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
   <span class="kd">function</span> <span class="nf">Convert</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Pkg</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Pkg</span><span class="p">;</span>         <span class="kn">use</span> <span class="nn">Pkg</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">S</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="n">Convert</span> <span class="p">(</span><span class="mi">123_145_299</span><span class="p">);</span>
   <span class="c1">--            ^ Invalid, which convert should we call?</span>

   <span class="n">S2</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="n">Convert</span> <span class="p">(</span><span class="n">SSID</span><span class="p">&#39;(</span><span class="mi">123_145_299</span><span class="p">));</span>
   <span class="c1">--                     ^ We specify that the type of the expression is</span>
   <span class="c1">--                       SSID.</span>

   <span class="c1">--  We could also have declared a temporary</span>

   <span class="n">I</span> <span class="p">:</span> <span class="n">SSID</span> <span class="p">:=</span> <span class="mi">123_145_299</span><span class="p">;</span>

   <span class="n">S3</span> <span class="p">:</span> <span class="kt">String</span> <span class="p">:=</span> <span class="n">Convert</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Syntactically the target of a qualified expression can be either any expression
in parentheses, either an aggregate:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Qual_Expr</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="n">P</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">:=</span> <span class="n">Point</span><span class="p">&#39;(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>

   <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="kt">Integer</span><span class="p">&#39;(</span><span class="mi">12</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Qual_Expr</span><span class="p">;</span>
</pre></div>
</div>
<p>This illustrates that qualified expressions are a convenient (and sometimes
necessary) way for the programmer to make the type of an expression explicit,
for the compiler of course, but also for other programmers.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>While they look and feel similar, type conversions and qualified
expressions are <em>not</em> the same.</p>
<p class="last">Qualified expressions need the type of the target expression that will be
resolved to be exactly that specified, whereas type conversions will try to
convert the target, issuing a run-time error if the conversion is deemed
invalid at run-time.</p>
</div>
</div>
<div class="section" id="access-types-pointers">
<h2>Access types (pointers)<a class="headerlink" href="#access-types-pointers" title="Permalink to this headline">¶</a></h2>
<p>Pointers are a potentially dangerous construct with regards to safety in
programming languages, which is in opposition with Ada’s stated goal.</p>
<p>There are two ways in which Ada does its best to shield programmers from the
dangers of pointers:</p>
<ol class="arabic simple">
<li>The first one, that we have already been studying all along, is to enable
the programmer to not use them. Parameter modes, arrays, varying size types,
are all constructs which allows the programmer to not use pointers, where he
would have used them in C.</li>
<li>The second one is by making pointers construct as safe and restricted as
possible, by default, allowing escape hatches when the programmer tells the
language that he really knows what he is doing.</li>
</ol>
<p>In this class, we will only teach the very basics of Ada pointers, which are
called accesses, because there are almost always better ways than to resort to
the advanced features directly.</p>
<p>If you need the unsafe features, you can learn more about those
<cite>here &lt;TODO_ACCESS_TYPES_ADVANCED_LINK&gt;__</cite>.</p>
<p>Here is how you declare a simple access type in Ada:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Dates</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Month_Type</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">January</span><span class="p">,</span> <span class="nv">February</span><span class="p">,</span> <span class="nv">March</span><span class="p">,</span> <span class="nv">April</span><span class="p">,</span> <span class="nv">May</span><span class="p">,</span> <span class="nv">June</span><span class="p">,</span> <span class="nv">July</span><span class="p">,</span>
                       <span class="nv">August</span><span class="p">,</span> <span class="nv">September</span><span class="p">,</span> <span class="nv">October</span><span class="p">,</span> <span class="nv">November</span><span class="p">,</span> <span class="nv">December</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Date</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">Day</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
      <span class="n">Month</span> <span class="p">:</span> <span class="n">Month_Type</span><span class="p">;</span>
      <span class="n">Year</span>  <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Dates</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
    <span class="c1">--  Declare an access type</span>
    <span class="kd">type</span> <span class="kt">Date_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>
    <span class="c1">--                      ^ Type you want to access/point to.</span>

    <span class="n">D</span> <span class="p">:</span> <span class="n">Date_Acc</span> <span class="p">:=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="c1">--              ^ Literal for &quot;access to nothing&quot;</span>
    <span class="c1">--  ^ Access to date</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>So far we know how to:</p>
<ul class="simple">
<li>Declare an access type to a specific type</li>
<li>Declare an instance of it</li>
<li>Give it a value of <code class="code ada docutils literal notranslate"><span class="keyword constant"><span class="pre">null</span></span></code></li>
</ul>
<p>In line with Ada’s strong typing philosophy, if you declare a second access
type to the date type, the two access types will be incompatible with each
other, and you will need an explicit type conversion to convert from one to the
other:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
    <span class="c1">--  Declare an access type</span>
    <span class="kd">type</span> <span class="kt">Date_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>
    <span class="kd">type</span> <span class="kt">Date_Acc_2</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>

    <span class="n">D</span>  <span class="p">:</span> <span class="n">Date_Acc</span> <span class="p">:=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="n">D2</span> <span class="p">:</span> <span class="n">Date_Acc_2</span> <span class="p">:=</span> <span class="n">D</span><span class="p">;</span>
    <span class="c1">--                 ^ Invalid! Different types</span>

    <span class="n">D3</span> <span class="p">:</span> <span class="n">Date_Acc_2</span> <span class="p">:=</span> <span class="n">Date_Acc_2</span> <span class="p">(</span><span class="n">D</span><span class="p">);</span>
    <span class="c1">--                 ^ Valid with type conversion</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p>In most other languages, pointer types are structurally, not nominally
typed, like they are in Ada, which means that two pointer types will be the
same as long as they share the same target type and accessibility rules.</p>
<p>Not so in Ada, which takes some time getting used to. A seemingly simple
problem that can cause pain is, if you want to have a canonical access to a
type, where to declare it ? A very commonly used pattern is that if you
need an access type to a specific type you ‘own’, you will declare it along
with the type:</p>
<div class="ada-syntax-only last highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Point_Access</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Point</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="allocation-by-type">
<h3>Allocation (by type)<a class="headerlink" href="#allocation-by-type" title="Permalink to this headline">¶</a></h3>
<p>Declaring access types is well, but we need a way to give instances of those
access types a meaningful value! You can allocate a value of an access type
with the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">new</span></span></code> keyword in Ada.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
    <span class="kd">type</span> <span class="kt">Date_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>

    <span class="n">D</span> <span class="p">:</span> <span class="n">Date_Acc</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Date</span><span class="p">;</span>
    <span class="c1">--              ^ Allocate a new Date record</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>If the type you want to allocate needs constraints, you can put them in the
subtype indication, just like you would do in a variable declaration:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">String_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kt">String</span><span class="p">;</span>
   <span class="c1">--                        ^ Access to unconstrained array type</span>
   <span class="n">Msg</span> <span class="p">:</span> <span class="n">String_Acc</span><span class="p">;</span>
   <span class="c1">--    ^ Default value is null</span>

   <span class="n">Buffer</span> <span class="p">:</span> <span class="n">String_Acc</span> <span class="p">:=</span> <span class="kr">new</span> <span class="kt">String</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span><span class="p">);</span>
   <span class="c1">--                                ^ Constraint required</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
<p>In some cases, allocating just by specifiying the type is not ideal though, so
Ada also allows you to allocate by value directly, specifying an expression via
a qualified expression:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Date_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">String_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="kt">String</span><span class="p">;</span>

   <span class="n">D</span>   <span class="p">:</span> <span class="n">Date_Acc</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Date</span><span class="p">&#39;(</span><span class="mi">30</span><span class="p">,</span> <span class="n">November</span><span class="p">,</span> <span class="mi">2011</span><span class="p">);</span>
   <span class="n">Msg</span> <span class="p">:</span> <span class="n">String_Acc</span> <span class="p">:=</span> <span class="kr">new</span> <span class="kt">String</span><span class="p">&#39;(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="dereferencing">
<h3>Dereferencing<a class="headerlink" href="#dereferencing" title="Permalink to this headline">¶</a></h3>
<p>The last missing piece to be able to use access types is how to use their
value. For that we need to dereference the pointer. Dereferencing a pointer
uses the <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">.</span></span><span class="keyword reserved"><span class="pre">all</span></span></code> syntax in Ada, but is only rarely necessary - in most
cases, the access wil be implicitly dereferenced for you:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Access_Types</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Date_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>

   <span class="n">D</span>     <span class="p">:</span> <span class="n">Date_Acc</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Date</span><span class="p">&#39;(</span><span class="mi">30</span><span class="p">,</span> <span class="n">November</span><span class="p">,</span> <span class="mi">2011</span><span class="p">);</span>

   <span class="n">Today</span> <span class="p">:</span> <span class="n">Date</span> <span class="p">:=</span> <span class="n">D</span><span class="p">.</span><span class="kr">all</span><span class="p">;</span>
   <span class="c1">--              ^ Access dereference</span>
   <span class="n">J</span>     <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="n">D</span><span class="p">.</span><span class="n">Day</span><span class="p">;</span>
   <span class="c1">--                 ^ Implicit dereference for record and array components</span>
   <span class="c1">--                 Equivalent to D.all.day</span>
<span class="kr">end</span> <span class="nf">Access_Types</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="automatic-deallocation">
<h3>Automatic deallocation<a class="headerlink" href="#automatic-deallocation" title="Permalink to this headline">¶</a></h3>
<p>Values of an access type can only stay alive as long as the access type. This
means that when the access type goes out of scope, every allocated instance of
an object of the accessed type will be deallocated:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Dates</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Dates</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Automatic_Deallocation</span> <span class="kr">is</span>
    <span class="kd">procedure</span> <span class="nf">Allocate_Date</span> <span class="kr">is</span>
       <span class="kd">type</span> <span class="kt">Date_Access</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Date</span><span class="p">;</span>
       <span class="n">D</span> <span class="p">:</span> <span class="n">Date_Access</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Date</span><span class="p">&#39;(</span><span class="mi">30</span><span class="p">,</span> <span class="n">January</span><span class="p">,</span> <span class="mi">2012</span><span class="p">);</span>
    <span class="kr">begin</span>
       <span class="kc">null</span><span class="p">;</span>
       <span class="c1">--  D will be deallocated here.</span>
    <span class="kr">end</span> <span class="nf">Allocate_Date</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Allocate_Date</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Automatic_Deallocation</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="other-features">
<h3>Other features<a class="headerlink" href="#other-features" title="Permalink to this headline">¶</a></h3>
<p>As you might know if you have used pointers in C or C++, we are still missing
features that are considered fundamental to the use of pointers, such as:</p>
<ul class="simple">
<li>Pointers arithmetic (being able to dynamically change what a pointer is
pointing to)</li>
<li>Manual deallocation - what is called <code class="docutils literal notranslate"><span class="pre">free</span></code> or <code class="docutils literal notranslate"><span class="pre">delete</span></code> in C. This is
considered an unsafe operation. It means that to stay into the realm of safe
Ada, you need to never deallocate manually.</li>
</ul>
<p>Those features exist in Ada, but are hidden behind specific standard library
APIs. You can read more about those in the <cite>advanced course on memory
management &lt;TODO_ACCESS_TYPES_ADVANCED_LINK&gt;__</cite>.</p>
</div>
</div>
<div class="section" id="mutually-recursive-types">
<h2>Mutually recursive types<a class="headerlink" href="#mutually-recursive-types" title="Permalink to this headline">¶</a></h2>
<p>It is sometimes needed to implement loops in data structures, for example to
implement linked lists. This is doable in Ada, by forward declaring a type,
such as in the example below:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Simple_List</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Node</span><span class="p">;</span>
   <span class="c1">--  This is an incomplete type declaration, it must be</span>
   <span class="c1">--  completed in the same declarative region.</span>

   <span class="kd">type</span> <span class="kt">Node_Acc</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Node</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Node</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">Content</span>    <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>
      <span class="n">Prev</span><span class="p">,</span> <span class="n">Next</span> <span class="p">:</span> <span class="n">Node_Acc</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Simple_List</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="more-about-records">
<h2>More about records<a class="headerlink" href="#more-about-records" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dynamically-sized-record-types">
<h3>Dynamically sized record types<a class="headerlink" href="#dynamically-sized-record-types" title="Permalink to this headline">¶</a></h3>
<p>We have studied records, although not in-depth. Let’s now detail a few
peculiarities of record types.</p>
<p>The first one is that the size of a record type does not need to be known at
compile time. This is a feature that is showcased in the example below:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Runtime_Length</span> <span class="kr">is</span>
   <span class="kd">function</span> <span class="nf">Compute_Max_Len</span> <span class="nf">return</span> <span class="nf">Natural</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Runtime_Length</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Runtime_Length</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Runtime_Length</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Var_Size_Record</span> <span class="kr">is</span>
    <span class="no">Max_Len</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">Natural</span> <span class="p">:=</span> <span class="n">Compute_Max_Len</span><span class="p">;</span>
    <span class="c1">--                            ^ Not known at compile time</span>

    <span class="kd">type</span> <span class="kt">Items_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Positive</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Integer</span><span class="p">;</span>

    <span class="kd">type</span> <span class="kt">Growable_Stack</span> <span class="kr">is</span> <span class="kr">record</span>
       <span class="n">Items</span> <span class="p">:</span> <span class="n">Items_Array</span> <span class="p">(</span><span class="kt">Positive</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="n">Max_Len</span><span class="p">);</span>
       <span class="n">Len</span>   <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>
    <span class="kr">end record</span><span class="p">;</span>
    <span class="c1">--  Person is a definite type, but size is not known at compile time.</span>

    <span class="n">G</span> <span class="p">:</span> <span class="n">Growable_Stack</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Var_Size_Record</span><span class="p">;</span>
</pre></div>
</div>
<p>The consequence of this is that it is completely fine to determine the size of
your records at run-time, the only enforced constraint being that this size
cannot change after the creation of the type.</p>
</div>
<div class="section" id="records-with-discriminant">
<h3>Records with discriminant<a class="headerlink" href="#records-with-discriminant" title="Permalink to this headline">¶</a></h3>
<p>In the section above, the size of the first name and last name fields is
determined once, at run-time, but every <code class="docutils literal notranslate"><span class="pre">Person</span></code> instance will be exactly the
same size. But maybe that’s not what you as a user want to do. We saw that for
arrays in general, it is already possible to do that: An unconstrained array
type can designate any instance of such an array regardless of the size.</p>
<p>You can do that for records too, using a special kind of field that is called a
discriminant:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Var_Size_Record_2</span> <span class="kr">is</span>
    <span class="kd">type</span> <span class="kt">Items_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Positive</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="kt">Integer</span><span class="p">;</span>

    <span class="kd">type</span> <span class="kt">Growable_Stack</span> <span class="p">(</span><span class="nv">Max_Len</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">)</span> <span class="kr">is</span> <span class="kr">record</span>
    <span class="c1">--                   ^ Discriminant. Cannot be modified once initialized.</span>
       <span class="n">Items</span> <span class="p">:</span> <span class="n">Items_Array</span> <span class="p">(</span><span class="kt">Positive</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="n">Max_Len</span><span class="p">);</span>
       <span class="n">Len</span>   <span class="p">:</span> <span class="kt">Natural</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kr">end record</span><span class="p">;</span>
    <span class="c1">--  Growable_Stack is an indefinite type (like an array)</span>
<span class="kr">end</span> <span class="nf">Var_Size_Record_2</span><span class="p">;</span>
</pre></div>
</div>
<p>Discriminants, in their simple forms, are constant: You cannot modify them once
you have initialized the object. This intuitively makes sense since they
determine the size of the object.</p>
<p>Also, they make a type indefinite: Whether or not the discriminant is used or
not to change the size of the object, a type with a discriminant will be
indefinite if the discriminant is not specified:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Test_Discriminants</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">)</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="kc">null</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="n">P</span> <span class="p">:</span> <span class="n">Point</span><span class="p">;</span>
   <span class="c1">--  ERROR: Point is indefinite, so you need to specify the discriminants</span>
   <span class="c1">--  or give a default value</span>

   <span class="n">P2</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
   <span class="n">P3</span> <span class="p">:</span> <span class="n">Point</span> <span class="p">:=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
   <span class="c1">--  Those two declarations are equivalent.</span>

<span class="kr">end</span> <span class="nf">Test_Discriminants</span><span class="p">;</span>
</pre></div>
</div>
<p>This also means that, in the example above, you cannot declare an array of
points as Point is defined above, because the size of a Point is not known.</p>
<p>In most other regards, discriminants behave like regular fields: You have to
specify their values in aggregates, as seen above, and you can access their
values via the dot-notation.</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Var_Size_Record_2</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Var_Size_Record_2</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Print_Stack</span> <span class="p">(</span><span class="nv">G</span> <span class="p">: </span><span class="nv">Growable_Stack</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put</span> <span class="p">(</span><span class="s">&quot;&lt;Stack, items: [&quot;</span><span class="p">);</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="n">Items</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
         <span class="kr">exit</span> <span class="kr">when</span> <span class="n">I</span> <span class="o">&gt;</span> <span class="n">G</span><span class="p">.</span><span class="n">Len</span><span class="p">;</span>
         <span class="n">Put</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">Items</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;]&gt;&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Print_Stack</span><span class="p">;</span>

   <span class="n">S</span> <span class="p">:</span> <span class="n">Growable_Stack</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Max_Len</span> <span class="p">=&gt;</span> <span class="mi">128</span><span class="p">,</span> <span class="n">Items</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kr">others</span> <span class="p">=&gt;</span> <span class="p">&lt;&gt;),</span> <span class="n">Len</span> <span class="p">=&gt;</span> <span class="mi">4</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="n">Print_Stack</span> <span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="records-with-variant">
<h3>Records with variant<a class="headerlink" href="#records-with-variant" title="Permalink to this headline">¶</a></h3>
<p>We introduced the concept of discriminants, and showcased how it enables people
to have records of varying size, by having components whose size vary depending
on the discriminant.</p>
<p>However, discriminants can also be used to make the shape of a record vary:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Variant_Record</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Expr</span><span class="p">;</span>                       <span class="c1">--  Forward declaration of Expr</span>
   <span class="kd">type</span> <span class="kt">Expr_Access</span> <span class="kr">is</span> <span class="kr">access</span> <span class="n">Expr</span><span class="p">;</span> <span class="c1">--  Access to a Expr</span>

   <span class="kd">type</span> <span class="kt">Expr_Kind_Type</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Bin_Op_Plus</span><span class="p">,</span> <span class="nv">Bin_Op_Minus</span><span class="p">,</span> <span class="nv">Num</span><span class="p">);</span>
   <span class="c1">--  A regular enum</span>

   <span class="kd">type</span> <span class="kt">Expr</span> <span class="p">(</span><span class="nv">Kind</span> <span class="p">: </span><span class="nv">Expr_Kind_Type</span><span class="p">)</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="c1">--      ^ The discriminant is an enum</span>
      <span class="kr">case</span> <span class="n">Kind</span> <span class="kr">is</span>
         <span class="kr">when</span> <span class="n">Bin_Op_Plus</span> <span class="p">|</span> <span class="n">Bin_Op_Minus</span> <span class="p">=&gt;</span>
            <span class="n">Left</span><span class="p">,</span> <span class="n">Right</span> <span class="p">:</span> <span class="n">Expr_Access</span><span class="p">;</span>
         <span class="kr">when</span> <span class="n">Num</span> <span class="p">=&gt;</span>
            <span class="n">Val</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
      <span class="c1">--  Variant part. Only one, at the end of the record</span>
      <span class="c1">--  definition, but can be nested</span>
   <span class="kr">end record</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Variant_Record</span><span class="p">;</span>
</pre></div>
</div>
<p>The fields that are in a <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">when</span></span></code> branch will be only available when the
value of the discriminant is covered by the branch. In the example above, it
means that you will only be able to access the fields <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Left</span></span></code> and
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Right</span></span></code> when the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Kind</span></span></code> is <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Bin_Op_Plus</span></span></code> or <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Bin_Op_Minus</span></span></code>.</p>
<p>If you try to access a field that is not valid for your record, a
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Constraint_Error</span></span></code> will be raised.</p>
<div class="ada-run-expect-failure highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Variant_Record</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Variant_Record</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">E</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="mi">12</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="n">E</span><span class="p">.</span><span class="n">Left</span> <span class="p">:=</span> <span class="kr">new</span> <span class="n">Expr</span><span class="p">&#39;(</span><span class="n">Num</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
   <span class="c1">--  Illegal, will compile but fail at runtime</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Here is how you could write an evaluator for expressions above:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Variant_Record</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Variant_Record</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">function</span> <span class="nf">Eval_Expr</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">Expr</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Integer</span> <span class="kr">is</span>
     <span class="p">(</span><span class="kr">case</span> <span class="n">E</span><span class="p">.</span><span class="n">Kind</span> <span class="kr">is</span>
      <span class="kr">when</span> <span class="n">Bin_Op_Plus</span> <span class="p">=&gt;</span> <span class="n">Eval_Expr</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Left</span><span class="p">.</span><span class="kr">all</span><span class="p">)</span> <span class="o">+</span> <span class="n">Eval_Expr</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Right</span><span class="p">.</span><span class="kr">all</span><span class="p">),</span>
      <span class="kr">when</span> <span class="n">Bin_Op_Minus</span> <span class="p">=&gt;</span> <span class="n">Eval_Expr</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Left</span><span class="p">.</span><span class="kr">all</span><span class="p">)</span> <span class="o">-</span> <span class="n">Eval_Expr</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Right</span><span class="p">.</span><span class="kr">all</span><span class="p">),</span>
      <span class="kr">when</span> <span class="n">Num</span> <span class="p">=&gt;</span> <span class="n">E</span><span class="p">.</span><span class="n">Val</span><span class="p">);</span>

   <span class="n">E</span> <span class="p">:</span> <span class="n">Expr</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Bin_Op_Plus</span><span class="p">,</span>
                <span class="kr">new</span> <span class="n">Expr</span><span class="p">&#39;(</span><span class="n">Bin_Op_Minus</span><span class="p">,</span>
                          <span class="kr">new</span> <span class="n">Expr</span><span class="p">&#39;(</span><span class="n">Num</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="kr">new</span> <span class="n">Expr</span><span class="p">&#39;(</span><span class="n">Num</span><span class="p">,</span> <span class="mi">15</span><span class="p">)),</span>
                <span class="kr">new</span> <span class="n">Expr</span><span class="p">&#39;(</span><span class="n">Num</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Eval_Expr</span> <span class="p">(</span><span class="n">E</span><span class="p">)));</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p>Ada’s variant records are very similar to Sum types in functional languages
such as OCaml or Haskell. The big difference is that the discriminant is a
separate field in Ada, and that you can have several, whereas the ‘tag’ of
the sum type is kind of built-in, and only accessible with pattern matching.</p>
<p>There are other differences (you can have several discriminants in a
variant record in Ada). Nevertheless, they allow the same kind of type
modeling than sum types in functional languages.</p>
<p class="last">Compared to C/C++ unions, Ada variant records are more powerful in what
they allow to express, and also checked at runtime, which makes them safer.</p>
</div>
</div>
</div>
</div>
<div class="section" id="privacy">
<h1>Privacy<a class="headerlink" href="#privacy" title="Permalink to this headline">¶</a></h1>
<p>One of the main principles in modular programming, that has later become one of
the main principles behind the dominant interpretation of object oriented
programming, is <a class="reference external" href="https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)">encapsulation</a>.</p>
<p>Encapsulation, briefly, is the concept that the implementer of a piece of
computer software will distinguish between the public interface and the private
implementation for his code.</p>
<p>This is not only applicable to software libraries but can happen everywhere
inside of a project where you want to have some abstraction.</p>
<p>In Ada, the granularity of encapsulation is a bit different from most object
oriented languages, because privacy is generally specified at the package
level.</p>
<div class="section" id="basic-encapsulation">
<h2>Basic encapsulation<a class="headerlink" href="#basic-encapsulation" title="Permalink to this headline">¶</a></h2>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Encapsulate</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Hello</span><span class="p">;</span>

<span class="kd">private</span>

   <span class="kd">procedure</span> <span class="nf">Hello2</span><span class="p">;</span>
   <span class="c1">--  Not visible from external units</span>
<span class="kr">end</span> <span class="nf">Encapsulate</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Encapsulate</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="n">Encapsulate</span><span class="p">.</span><span class="n">Hello</span><span class="p">;</span>
   <span class="n">Encapsulate</span><span class="p">.</span><span class="n">Hello2</span><span class="p">;</span>
   <span class="c1">--  Invalid: Hello2 is not visible</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="abstract-data-types">
<h2>Abstract data types<a class="headerlink" href="#abstract-data-types" title="Permalink to this headline">¶</a></h2>
<p>With this high level granularity, it might not seem obvious how to hide the
implementation details of a type. Here is how it is done in Ada:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Stacks</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Stack</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
   <span class="c1">--  Declare a private type: You cannot depend on its</span>
   <span class="c1">--  implementation. You can only assign and test for</span>
   <span class="c1">--  equality.</span>

   <span class="kd">procedure</span> <span class="nf">Push</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">Pop</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">);</span>
<span class="kd">private</span>

   <span class="kd">subtype</span> <span class="kt">Stack_Index</span> <span class="kr">is</span> <span class="kt">Natural</span> <span class="kr">range</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span><span class="p">;</span>
   <span class="kd">type</span> <span class="kt">Content_Type</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Stack_Index</span><span class="p">)</span> <span class="kr">of</span> <span class="kt">Natural</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Stack</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">Top</span> <span class="p">:</span> <span class="n">Stack_Index</span><span class="p">;</span>
      <span class="n">Content</span> <span class="p">:</span> <span class="n">Content_Type</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Stacks</span><span class="p">;</span>
</pre></div>
</div>
<p>In the above example, we define a stack type in the public part, but say that
the exact representation of that type is private.</p>
<p>Then, in the private part, we define the exact representation of that type. We
can also declare other types that will be used as helpers for our main public
type. This is useful since declaring helper types is so common in Ada.</p>
<p>A few words about terminology:</p>
<ul class="simple">
<li>The Stack type as viewed from the public part is called the partial view of
the type. This is what clients have access to.</li>
<li>The Stack type as viewed from the private part or the body of the package is
called the full view of the type. This is what implementers have access to.</li>
</ul>
<p>From the point of view of the client, only the public part is important, and
the private part could as well not exist. It makes it very easy to read
linearly the part of the package that is important for you.</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="c1">--  No need to read the private part to use the package</span>
<span class="kd">package</span> <span class="nc">Stacks</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Stack</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Push</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">Pop</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">);</span>
<span class="kd">private</span>
   <span class="p">...</span>
<span class="kr">end</span> <span class="nf">Stacks</span><span class="p">;</span>
</pre></div>
</div>
<p>Here is how the <code class="docutils literal notranslate"><span class="pre">Stacks</span></code> package would be used:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="c1">--  Example of use</span>
<span class="kn">with</span> <span class="nn">Stacks</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Stacks</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Stack</span> <span class="kr">is</span>
   <span class="n">S</span> <span class="p">:</span> <span class="n">Stack</span><span class="p">;</span>
   <span class="n">Res</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Push</span> <span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
   <span class="n">Push</span> <span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
   <span class="n">Pop</span> <span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">Res</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Test_Stack</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="limited-types">
<h2>Limited types<a class="headerlink" href="#limited-types" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="generics">
<h1>Generics<a class="headerlink" href="#generics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Generics are used for metaprogramming in Ada. They are useful for abstract
algorithms that share common properties.</p>
<p>Generics can be used for subprograms or packages. A generic is declared
by using the keyword <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">generic</span></span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Show_Simple_Generic</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="c1">--  Declaration of formal types and objects</span>
   <span class="kd">procedure</span> <span class="nf">Operator</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">T</span><span class="p">);</span>
   <span class="c1">--  This could be one of the following:</span>
   <span class="c1">--  &lt;procedure | function | package&gt;</span>

   <span class="kd">procedure</span> <span class="nf">Operator</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">T</span><span class="p">)</span> <span class="kr">is</span> <span class="kc">null</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Generic</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="formal-type-declaration">
<h3>Formal type declaration<a class="headerlink" href="#formal-type-declaration" title="Permalink to this headline">¶</a></h3>
<p>Formal types are abstractions of a specific type. We may, for example,
want to create an algorithm that works on any integer type, or even on
any type at all, independently of being a numeric type or not. The
following example declares a formal type <code class="docutils literal notranslate"><span class="pre">T</span></code> for the <code class="docutils literal notranslate"><span class="pre">Set</span></code> procedure.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Show_Formal_Type_Declaration</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="c1">--  T is a formal type that indicates that any type can be used,</span>
      <span class="c1">--  be it a numeric type or, for example, a record.</span>
   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">T</span><span class="p">)</span> <span class="kr">is</span> <span class="kc">null</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Formal_Type_Declaration</span><span class="p">;</span>
</pre></div>
</div>
<p>The declaration of <code class="docutils literal notranslate"><span class="pre">T</span></code> as <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">private</span></span></code> indicates that any type can be
mapped to it. These are some examples of formal types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Formal Type</th>
<th class="head">Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Any type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
</tr>
<tr class="row-odd"><td>Any discrete type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;);</span></span></code></td>
</tr>
<tr class="row-even"><td>Any floating-point type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">digits</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="formal-object-declaration">
<h3>Formal object declaration<a class="headerlink" href="#formal-object-declaration" title="Permalink to this headline">¶</a></h3>
<p>Formal objects are similar to subprogram parameters. Also, they can make
use of formal types declared in the formal specification. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Show_Formal_Object_Declaration</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="n">X</span> <span class="p">:</span> <span class="ow">in</span> <span class="kr">out</span> <span class="n">T</span><span class="p">;</span>
      <span class="c1">--  X can be used in the Set procedure</span>
   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">T</span><span class="p">)</span> <span class="kr">is</span> <span class="kc">null</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Formal_Object_Declaration</span><span class="p">;</span>
</pre></div>
</div>
<p>Formal objects can be either just input parameters or use the
<code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">in</span></span> <span class="keyword reserved"><span class="pre">out</span></span></code> mode.</p>
</div>
<div class="section" id="generic-body-definition">
<h3>Generic body definition<a class="headerlink" href="#generic-body-definition" title="Permalink to this headline">¶</a></h3>
<p>For the body declaration of a generic subprogram or package, we don’t
repeat the <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">generic</span></span></code> keyword: we simply start with the actual
declaration and make use of the generic types and objects that we
declared. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Show_Generic_Body_Definition</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="n">X</span> <span class="p">:</span> <span class="ow">in</span> <span class="kr">out</span> <span class="n">T</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
   <span class="c1">--  Body definition: &quot;generic&quot; keyword is not used</span>
   <span class="kr">begin</span>
      <span class="n">X</span> <span class="p">:=</span> <span class="n">E</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Generic_Body_Definition</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="generic-instantiation">
<h3>Generic instantiation<a class="headerlink" href="#generic-instantiation" title="Permalink to this headline">¶</a></h3>
<p>Generic subprograms or packages cannot be used directly. Instead, they
need to be instantiated. The instantiation is done by using the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">new</span></span></code>
keyword, as illustrated in the following example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Generic_Instantiation</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="n">X</span> <span class="p">:</span> <span class="ow">in</span> <span class="kr">out</span> <span class="n">T</span><span class="p">;</span>
      <span class="c1">--  X can be used in the Set procedure</span>
   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">X</span> <span class="p">:=</span> <span class="n">E</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>

   <span class="n">Main</span>    <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">Current</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Set_Main</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Set</span> <span class="p">(</span><span class="n">T</span> <span class="p">=&gt;</span> <span class="kt">Integer</span><span class="p">,</span>
                                  <span class="n">X</span> <span class="p">=&gt;</span> <span class="n">Main</span><span class="p">);</span>
   <span class="c1">--  Here, we map the formal parameters to actual types and objects.</span>
   <span class="c1">--</span>
   <span class="c1">--  The same approach can be used to instantiate functions or</span>
   <span class="c1">--  packages, e.g.:</span>
   <span class="c1">--  function Get_Main is new ...</span>
   <span class="c1">--  package Integer_Queue is new ...</span>

<span class="kr">begin</span>
   <span class="n">Current</span> <span class="p">:=</span> <span class="mi">10</span><span class="p">;</span>

   <span class="n">Set_Main</span> <span class="p">(</span><span class="n">Current</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of Main is &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Main</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Generic_Instantiation</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example above, we instantiate the procedure <code class="docutils literal notranslate"><span class="pre">Set</span></code> by mapping the
formal parameters <code class="docutils literal notranslate"><span class="pre">T</span></code> and <code class="docutils literal notranslate"><span class="pre">X</span></code> to actual existing elements: the
<code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> type and the <code class="docutils literal notranslate"><span class="pre">Main</span></code> variable.</p>
</div>
<div class="section" id="generic-packages">
<h3>Generic packages<a class="headerlink" href="#generic-packages" title="Permalink to this headline">¶</a></h3>
<p>The previous examples focused on generic subprograms. In this section, we
will look into generic packages. In general, the syntax is not different
from the one used for generic subprograms: it starts with the <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">generic</span></span></code>
keyword and continues with formal declarations. The only difference is
that a <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">package</span></span></code> is specified instead of a subprogram.</p>
<p>This is an example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Generic_Package</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
   <span class="kd">package</span> <span class="nc">Element</span> <span class="kr">is</span>

      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">);</span>
      <span class="kd">procedure</span> <span class="nf">Reset</span><span class="p">;</span>
      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">T</span><span class="p">;</span>
      <span class="kd">function</span> <span class="nf">Is_Valid</span> <span class="nf">return</span> <span class="nf">Boolean</span><span class="p">;</span>

      <span class="n">Invalid_Element</span> <span class="p">:</span> <span class="kr">exception</span><span class="p">;</span>

   <span class="kd">private</span>
      <span class="n">Value</span> <span class="p">:</span> <span class="n">T</span><span class="p">;</span>
      <span class="n">Valid</span> <span class="p">:</span> <span class="kt">Boolean</span> <span class="p">:=</span> <span class="kc">False</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Element</span><span class="p">;</span>

   <span class="kd">package</span> <span class="kd">body</span> <span class="nc">Element</span> <span class="kr">is</span>

      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">E</span> <span class="p">: </span><span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Value</span> <span class="p">:=</span> <span class="n">E</span><span class="p">;</span>
         <span class="n">Valid</span> <span class="p">:=</span> <span class="kc">True</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>

      <span class="kd">procedure</span> <span class="nf">Reset</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Valid</span> <span class="p">:=</span> <span class="kc">False</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Reset</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">T</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="kr">if</span> <span class="ow">not</span> <span class="n">Valid</span> <span class="kr">then</span>
            <span class="kr">raise</span> <span class="n">Invalid_Element</span><span class="p">;</span>
         <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
         <span class="kr">return</span> <span class="n">Value</span><span class="p">;</span>
      <span class="kr">end</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nf">Is_Valid</span> <span class="nf">return</span> <span class="nf">Boolean</span> <span class="kr">is</span> <span class="p">(</span><span class="n">Valid</span><span class="p">);</span>

   <span class="kr">end</span> <span class="nf">Element</span><span class="p">;</span>

   <span class="kd">package</span> <span class="nc">I</span> <span class="kr">is new</span> <span class="nc">Element</span> <span class="p">(</span><span class="nv">T</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Display_Initialized</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">if</span> <span class="n">I</span><span class="p">.</span><span class="n">Is_Valid</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value is initialized&quot;</span><span class="p">);</span>
      <span class="kr">else</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value is not initialized&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Display_Initialized</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Display_Initialized</span><span class="p">;</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Initializing...&quot;</span><span class="p">);</span>
   <span class="n">I</span><span class="p">.</span><span class="n">Set</span> <span class="p">(</span><span class="mi">5</span><span class="p">);</span>
   <span class="n">Display_Initialized</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value is now set to &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">Get</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Reseting...&quot;</span><span class="p">);</span>
   <span class="n">I</span><span class="p">.</span><span class="n">Reset</span><span class="p">;</span>
   <span class="n">Display_Initialized</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Generic_Package</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example above, we create a very simple container named <code class="docutils literal notranslate"><span class="pre">Element</span></code>
for just a single element. This container keeps track whether the element
has been initialized or not. After the package definition, we create the
instance <code class="docutils literal notranslate"><span class="pre">I</span></code> of the <code class="docutils literal notranslate"><span class="pre">Element</span></code>. We can then use the instance by calling
the package subprograms (e.g.: <code class="docutils literal notranslate"><span class="pre">Set</span></code>, <code class="docutils literal notranslate"><span class="pre">Get</span></code> and <code class="docutils literal notranslate"><span class="pre">Reset</span></code>).</p>
</div>
<div class="section" id="formal-subprograms">
<h3>Formal subprograms<a class="headerlink" href="#formal-subprograms" title="Permalink to this headline">¶</a></h3>
<p>In addition to formal types and objects, we can also declare formal
subprograms or packages. This course only describes formal subprograms.
Formal packages are discussed in the advanced course.</p>
<p>In order to declare a formal subprogram, we make use of the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code>
keyword. In the example below, we declare a formal function
(<code class="docutils literal notranslate"><span class="pre">Comparison</span></code>) that is used by the generic procedure <code class="docutils literal notranslate"><span class="pre">Check</span></code>.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Formal_Subprogram</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="n">Description</span> <span class="p">:</span> <span class="kt">String</span><span class="p">;</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="kn">with</span> <span class="nn">function</span> <span class="n">Comparison</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">Check</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Check</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
      <span class="n">Result</span> <span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">Result</span> <span class="p">:=</span> <span class="n">Comparison</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">);</span>
      <span class="kr">if</span> <span class="n">Result</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Comparison (&quot;</span> <span class="o">&amp;</span> <span class="n">Description</span> <span class="o">&amp;</span>
                   <span class="s">&quot;) between arguments is OK!&quot;</span><span class="p">);</span>
      <span class="kr">else</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Comparison (&quot;</span> <span class="o">&amp;</span> <span class="n">Description</span> <span class="o">&amp;</span>
                   <span class="s">&quot;) between arguments is not OK!&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Check</span><span class="p">;</span>

   <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Check_Is_Equal</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Check</span> <span class="p">(</span><span class="n">Description</span> <span class="p">=&gt;</span> <span class="s">&quot;equality&quot;</span><span class="p">,</span>
                                          <span class="n">T</span>           <span class="p">=&gt;</span> <span class="kt">Integer</span><span class="p">,</span>
                                          <span class="n">Comparison</span>  <span class="p">=&gt;</span> <span class="n">Standard</span><span class="p">.</span><span class="s">&quot;=&quot;</span><span class="p">);</span>
   <span class="c1">--  Here, we are mapping the standard equality operator for Integer</span>
   <span class="c1">--  types to the Comparison function</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="n">Check_Is_Equal</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Formal_Subprogram</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="examples-of-using-generics">
<h2>Examples of using generics<a class="headerlink" href="#examples-of-using-generics" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will look into examples and strategies for abstracting
algorithms using generics.</p>
<div class="section" id="application-adts">
<h3>Application: ADTs<a class="headerlink" href="#application-adts" title="Permalink to this headline">¶</a></h3>
<p>An important application of generics is to model abstract data types
(ADTs). In fact, Ada includes a library with all sorts of ADTs using
generics: <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Ada</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Containers</span></span></code>.</p>
<p>A typical example of an ADT is a stack:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Stack</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="n">Max</span> <span class="p">:</span> <span class="kt">Positive</span><span class="p">;</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
   <span class="kd">package</span> <span class="nc">Stacks</span> <span class="kr">is</span>

      <span class="kd">type</span> <span class="kt">Stack</span> <span class="kr">is</span> <span class="kr">limited</span> <span class="kd">private</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nf">Is_Empty</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Stack</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nf">Pop</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">)</span> <span class="kr">return</span> <span class="n">T</span><span class="p">;</span>

      <span class="kd">procedure</span> <span class="nf">Push</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span>
                      <span class="nv">V</span> <span class="p">: </span><span class="nv">T</span><span class="p">);</span>

   <span class="kd">private</span>

      <span class="kd">type</span> <span class="kt">Stack_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Natural</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">T</span><span class="p">;</span>

      <span class="kd">type</span> <span class="kt">Stack</span> <span class="kr">is</span> <span class="kr">record</span>
         <span class="n">Container</span> <span class="p">:</span> <span class="n">Stack_Array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="n">Max</span><span class="p">);</span>
         <span class="n">Top</span>       <span class="p">:</span> <span class="kt">Natural</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="kr">end record</span><span class="p">;</span>

   <span class="kr">end</span> <span class="nf">Stacks</span><span class="p">;</span>

   <span class="kd">package</span> <span class="kd">body</span> <span class="nc">Stacks</span> <span class="kr">is</span>

      <span class="kd">function</span> <span class="nf">Is_Empty</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Stack</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span> <span class="kr">is</span>
        <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Top</span> <span class="o">&lt;</span> <span class="n">S</span><span class="p">.</span><span class="n">Container</span><span class="p">&#39;</span><span class="na">First</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">Pop</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">)</span> <span class="kr">return</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="kr">return</span> <span class="n">X</span> <span class="p">:</span> <span class="n">T</span> <span class="kr">do</span>
            <span class="n">X</span>     <span class="p">:=</span> <span class="n">S</span><span class="p">.</span><span class="n">Container</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Top</span><span class="p">);</span>
            <span class="n">S</span><span class="p">.</span><span class="n">Top</span> <span class="p">:=</span> <span class="n">S</span><span class="p">.</span><span class="n">Top</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
         <span class="kr">end</span> <span class="nf">return</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Pop</span><span class="p">;</span>

      <span class="kd">procedure</span> <span class="nf">Push</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Stack</span><span class="p">;</span>
                      <span class="nv">V</span> <span class="p">: </span><span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">S</span><span class="p">.</span><span class="n">Top</span>               <span class="p">:=</span> <span class="n">S</span><span class="p">.</span><span class="n">Top</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
         <span class="n">S</span><span class="p">.</span><span class="n">Container</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Top</span><span class="p">)</span> <span class="p">:=</span> <span class="n">V</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Push</span><span class="p">;</span>

   <span class="kr">end</span> <span class="nf">Stacks</span><span class="p">;</span>

   <span class="kd">package</span> <span class="nc">Integer_Stacks</span> <span class="kr">is new</span> <span class="nc">Stacks</span> <span class="p">(</span><span class="nv">Max</span> <span class="p">=&gt;</span> 10<span class="p">,</span>
                                         <span class="nv">T</span>   <span class="p">=&gt;</span> Integer<span class="p">);</span>
   <span class="kn">use</span> <span class="nn">Integer_Stacks</span><span class="p">;</span>

   <span class="n">Values</span> <span class="p">:</span> <span class="n">Integer_Stacks</span><span class="p">.</span><span class="n">Stack</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Push</span> <span class="p">(</span><span class="n">Values</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
   <span class="n">Push</span> <span class="p">(</span><span class="n">Values</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Last value was &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Pop</span> <span class="p">(</span><span class="n">Values</span><span class="p">)));</span>
<span class="kr">end</span> <span class="nf">Show_Stack</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we first create a generic stack package (<code class="docutils literal notranslate"><span class="pre">Stacks</span></code>).
Then, we instantiate it in order to create a stack for 10 positions of
integer values.</p>
</div>
<div class="section" id="abstracting-a-swap-algorithm">
<h3>Abstracting a swap algorithm<a class="headerlink" href="#abstracting-a-swap-algorithm" title="Permalink to this headline">¶</a></h3>
<p>Let’s first look into a simple procedure that swaps variables of the type
<code class="docutils literal notranslate"><span class="pre">Color</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Non_Generic_Swap_Colors</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Color</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Black</span><span class="p">,</span> <span class="nv">Red</span><span class="p">,</span> <span class="nv">Green</span><span class="p">,</span> <span class="nv">Blue</span><span class="p">,</span> <span class="nv">White</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Swap_Colors</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Color</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Swap_Colors</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Color</span><span class="p">)</span> <span class="kr">is</span>
      <span class="no">Tmp</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Color</span> <span class="p">:=</span> <span class="n">X</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">X</span> <span class="p">:=</span> <span class="n">Y</span><span class="p">;</span>
      <span class="n">Y</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Swap_Colors</span><span class="p">;</span>

   <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="p">:</span> <span class="n">Color</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="n">Blue</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="n">White</span><span class="p">;</span>
   <span class="n">C</span> <span class="p">:=</span> <span class="n">Red</span><span class="p">;</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of B is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">B</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of C is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Swapping A and C...&quot;</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Swap_Colors</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of B is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">B</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of C is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Test_Non_Generic_Swap_Colors</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">Swap_Colors</span></code> can only be used for the <code class="docutils literal notranslate"><span class="pre">Color</span></code> type.
However, a swapping algorithm can theoretically be used for any type, be
it an enumeration or a complex record type with many elements. The
algorithm itself is the same, just the types are different. Also, we don’t
want to duplicate the implementation for swapping variables of <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code>
type, for example. Therefore, such an algorithm is an perfect candidate
for abstraction using generics.</p>
<p>In the example below, we create a generic version of the <code class="docutils literal notranslate"><span class="pre">Swap_Colors</span></code>
and name it <code class="docutils literal notranslate"><span class="pre">Generic_Swap</span></code>. This generic version can work on any type.
This is achieved by the declaration of the formal type <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Swap_Colors</span> <span class="kr">is</span>
   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">Generic_Swap</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Generic_Swap</span> <span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">T</span><span class="p">)</span> <span class="kr">is</span>
      <span class="no">Tmp</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">T</span> <span class="p">:=</span> <span class="n">X</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">X</span> <span class="p">:=</span> <span class="n">Y</span><span class="p">;</span>
      <span class="n">Y</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Generic_Swap</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Color</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Black</span><span class="p">,</span> <span class="nv">Red</span><span class="p">,</span> <span class="nv">Green</span><span class="p">,</span> <span class="nv">Blue</span><span class="p">,</span> <span class="nv">White</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Swap_Colors</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kd">Generic</span><span class="mi">_</span><span class="n">Swap</span> <span class="p">(</span><span class="n">T</span> <span class="p">=&gt;</span> <span class="n">Color</span><span class="p">);</span>

   <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="p">:</span> <span class="n">Color</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">A</span> <span class="p">:=</span> <span class="n">Blue</span><span class="p">;</span>
   <span class="n">B</span> <span class="p">:=</span> <span class="n">White</span><span class="p">;</span>
   <span class="n">C</span> <span class="p">:=</span> <span class="n">Red</span><span class="p">;</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of B is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">B</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of C is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Swapping A and C...&quot;</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Swap_Colors</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of A is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">A</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of B is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">B</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Value of C is &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Test_Swap_Colors</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see in the example, we can create the same <code class="docutils literal notranslate"><span class="pre">Swap_Colors</span></code>
procedure as we had in the non-generic version of the algorithm by
declaring it as an instance of generic <code class="docutils literal notranslate"><span class="pre">Generic_Swap</span></code> procedure. As an
argument to the <code class="docutils literal notranslate"><span class="pre">Generic_Swap</span></code> procedure, we define that the <code class="docutils literal notranslate"><span class="pre">T</span></code> type
will be mapped to the <code class="docutils literal notranslate"><span class="pre">Color</span></code> type.</p>
</div>
<div class="section" id="abstracting-a-reversing-algorithm">
<h3>Abstracting a reversing algorithm<a class="headerlink" href="#abstracting-a-reversing-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The previous example using a swapping algorithm is one of the simplest
examples of generic algorithms. Now, we will look into an algorithm for
reversing elements of an array. First, let’s start with a non-generic
version of the algorithm that works specifically for the <code class="docutils literal notranslate"><span class="pre">Color</span></code> type:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Non_Generic_Reverse_Colors</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Color</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Black</span><span class="p">,</span> <span class="nv">Red</span><span class="p">,</span> <span class="nv">Green</span><span class="p">,</span> <span class="nv">Blue</span><span class="p">,</span> <span class="nv">White</span><span class="p">);</span>

   <span class="kd">type</span> <span class="kt">Color_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Integer</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">Color</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Reverse_Color_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Color_Array</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Reverse_Color_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Color_Array</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="kr">loop</span>
         <span class="kr">declare</span>
            <span class="n">Tmp</span>     <span class="p">:</span> <span class="n">Color</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:</span> <span class="n">Color</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
            <span class="n">X_Right</span> <span class="p">:</span> <span class="n">Color</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="o">-</span> <span class="n">I</span><span class="p">);</span>
         <span class="kr">begin</span>
            <span class="n">Tmp</span>     <span class="p">:=</span> <span class="n">X_Left</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:=</span> <span class="n">X_Right</span><span class="p">;</span>
            <span class="n">X_Right</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
         <span class="kr">end</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Reverse_Color_Array</span><span class="p">;</span>

   <span class="n">My_Colors</span> <span class="p">:</span> <span class="n">Color_Array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Black</span><span class="p">,</span> <span class="n">Red</span><span class="p">,</span> <span class="n">Green</span><span class="p">,</span> <span class="n">Blue</span><span class="p">,</span> <span class="n">White</span><span class="p">);</span>

<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">My_Colors</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;My_Color: &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Reversing My_Color...&quot;</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Reverse_Color_Array</span> <span class="p">(</span><span class="n">My_Colors</span><span class="p">);</span>

   <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">My_Colors</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;My_Color: &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Test_Non_Generic_Reverse_Colors</span><span class="p">;</span>
</pre></div>
</div>
<p>The procedure <code class="docutils literal notranslate"><span class="pre">Reverse_Color_Array</span></code> takes an array of colors and starts
by swapping the first and last elements of the array, and continues doing
that with the next elements until the middle of array. At this point, the
whole array has been reversed, as we can see in the text output of the
test application.</p>
<p>In order to abstract this procedure, we will declare formal types for
three components of the algorithm:</p>
<blockquote>
<div><ul class="simple">
<li>the elements of the array (<code class="docutils literal notranslate"><span class="pre">Color</span></code> type in the example)</li>
<li>the range used for the array (<code class="docutils literal notranslate"><span class="pre">Integer</span></code> range in the example)</li>
<li>the actual array type (<code class="docutils literal notranslate"><span class="pre">Color_Array</span></code> type in the example)</li>
</ul>
</div></blockquote>
<p>This is a generic version of the algorithm:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Reverse_Colors</span> <span class="kr">is</span>
   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="p">&lt;&gt;;</span>
      <span class="kd">type</span> <span class="kt">Array_T</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Index</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">T</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">Generic_Reverse_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Generic_Reverse_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="kr">loop</span>
         <span class="kr">declare</span>
            <span class="n">Tmp</span>     <span class="p">:</span> <span class="n">T</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:</span> <span class="n">T</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
            <span class="n">X_Right</span> <span class="p">:</span> <span class="n">T</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="o">-</span> <span class="n">I</span><span class="p">);</span>
         <span class="kr">begin</span>
            <span class="n">Tmp</span>     <span class="p">:=</span> <span class="n">X_Left</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:=</span> <span class="n">X_Right</span><span class="p">;</span>
            <span class="n">X_Right</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
         <span class="kr">end</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Generic_Reverse_Array</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Color</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Black</span><span class="p">,</span> <span class="nv">Red</span><span class="p">,</span> <span class="nv">Green</span><span class="p">,</span> <span class="nv">Blue</span><span class="p">,</span> <span class="nv">White</span><span class="p">);</span>
   <span class="kd">type</span> <span class="kt">Color_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Integer</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">Color</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Reverse_Color_Array</span> <span class="kr">is</span> <span class="kr">new</span>
     <span class="kd">Generic</span><span class="mi">_</span><span class="n">Reverse_Array</span> <span class="p">(</span><span class="n">T</span> <span class="p">=&gt;</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Index</span> <span class="p">=&gt;</span> <span class="kt">Integer</span><span class="p">,</span> <span class="n">Array_T</span> <span class="p">=&gt;</span> <span class="n">Color_Array</span><span class="p">);</span>

   <span class="n">My_Colors</span> <span class="p">:</span> <span class="n">Color_Array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Black</span><span class="p">,</span> <span class="n">Red</span><span class="p">,</span> <span class="n">Green</span><span class="p">,</span> <span class="n">Blue</span><span class="p">,</span> <span class="n">White</span><span class="p">);</span>

<span class="kr">begin</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">My_Colors</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;My_Color: &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Reversing My_Color...&quot;</span><span class="p">);</span>
   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Reverse_Color_Array</span> <span class="p">(</span><span class="n">My_Colors</span><span class="p">);</span>

   <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">My_Colors</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;My_Color: &quot;</span> <span class="o">&amp;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Test_Reverse_Colors</span><span class="p">;</span>
</pre></div>
</div>
<p>As mentioned above, we’re abstracting three components of the algorithm:</p>
<blockquote>
<div><ul class="simple">
<li>the <code class="docutils literal notranslate"><span class="pre">T</span></code> type abstracts the elements of the array</li>
<li>the <code class="docutils literal notranslate"><span class="pre">Index</span></code> type abstracts the range used for the array</li>
<li>the <code class="docutils literal notranslate"><span class="pre">Array_T</span></code> type abstracts the array type and makes use of the
formal declarations of the <code class="docutils literal notranslate"><span class="pre">T</span></code> and <code class="docutils literal notranslate"><span class="pre">Index</span></code> types.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="abstracting-the-test-application">
<h3>Abstracting the test application<a class="headerlink" href="#abstracting-the-test-application" title="Permalink to this headline">¶</a></h3>
<p>In the previous example, we’ve focused only on abstracting the reversing
algorithm. However, we could have decided to also abstract our little
test application. This could be useful if we, for example, decide to
test other procedures that change elements of an array.</p>
<p>In order to achieve this, we have to abstract some elements. We
will therefore declare the following formal parameters:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">S</span></code>: the string containing the array name</li>
<li>a function <code class="docutils literal notranslate"><span class="pre">Image</span></code> that converts an element of type <code class="docutils literal notranslate"><span class="pre">T</span></code> to a
string</li>
<li>a procedure <code class="docutils literal notranslate"><span class="pre">Test</span></code> that performs some operation on the array</li>
</ul>
</div></blockquote>
<p>Note that <code class="docutils literal notranslate"><span class="pre">Image</span></code> and <code class="docutils literal notranslate"><span class="pre">Test</span></code> are examples of formal subprograms.
Also, note that <code class="docutils literal notranslate"><span class="pre">S</span></code> is an example of a formal object.</p>
<p>This is a version of the test application that makes use of the generic
<code class="docutils literal notranslate"><span class="pre">Perform_Test</span></code> procedure:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Reverse_Colors</span> <span class="kr">is</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="p">&lt;&gt;;</span>
      <span class="kd">type</span> <span class="kt">Array_T</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Index</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">T</span><span class="p">;</span>
   <span class="kd">procedure</span> <span class="nf">Generic_Reverse_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">);</span>

   <span class="kd">generic</span>
      <span class="kd">type</span> <span class="kt">T</span> <span class="kr">is</span> <span class="kd">private</span><span class="p">;</span>
      <span class="kd">type</span> <span class="kt">Index</span> <span class="kr">is</span> <span class="kr">range</span> <span class="p">&lt;&gt;;</span>
      <span class="kd">type</span> <span class="kt">Array_T</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Index</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">T</span><span class="p">;</span>
      <span class="n">S</span> <span class="p">:</span> <span class="kt">String</span><span class="p">;</span>
      <span class="kn">with</span> <span class="nn">function</span> <span class="n">Image</span> <span class="p">(</span><span class="n">E</span> <span class="p">:</span> <span class="ow">in</span> <span class="n">T</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span> <span class="kr">is</span> <span class="p">&lt;&gt;;</span>
      <span class="kn">with</span> <span class="nn">procedure</span> <span class="n">Test</span> <span class="p">(</span><span class="n">X</span> <span class="p">:</span> <span class="ow">in</span> <span class="kr">out</span> <span class="n">Array_T</span><span class="p">);</span>
   <span class="kd">procedure</span> <span class="nf">Perform_Test</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Generic_Reverse_Array</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="p">..</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="kr">loop</span>
         <span class="kr">declare</span>
            <span class="n">Tmp</span>     <span class="p">:</span> <span class="n">T</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:</span> <span class="n">T</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
            <span class="n">X_Right</span> <span class="p">:</span> <span class="n">T</span> <span class="kr">renames</span> <span class="n">X</span> <span class="p">(</span><span class="n">X</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">+</span> <span class="n">X</span><span class="p">&#39;</span><span class="na">First</span> <span class="o">-</span> <span class="n">I</span><span class="p">);</span>
         <span class="kr">begin</span>
            <span class="n">Tmp</span>     <span class="p">:=</span> <span class="n">X_Left</span><span class="p">;</span>
            <span class="n">X_Left</span>  <span class="p">:=</span> <span class="n">X_Right</span><span class="p">;</span>
            <span class="n">X_Right</span> <span class="p">:=</span> <span class="n">Tmp</span><span class="p">;</span>
         <span class="kr">end</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Generic_Reverse_Array</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Perform_Test</span> <span class="p">(</span><span class="nv">X</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Array_T</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">X</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="n">S</span> <span class="o">&amp;</span> <span class="s">&quot;: &quot;</span> <span class="o">&amp;</span> <span class="n">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Testing &quot;</span> <span class="o">&amp;</span> <span class="n">S</span> <span class="o">&amp;</span> <span class="s">&quot;...&quot;</span><span class="p">);</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Test</span> <span class="p">(</span><span class="n">X</span><span class="p">);</span>

      <span class="kr">for</span> <span class="n">C</span> <span class="kr">of</span> <span class="n">X</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="n">S</span> <span class="o">&amp;</span> <span class="s">&quot;: &quot;</span> <span class="o">&amp;</span> <span class="n">Image</span> <span class="p">(</span><span class="n">C</span><span class="p">));</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Perform_Test</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">Color</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Black</span><span class="p">,</span> <span class="nv">Red</span><span class="p">,</span> <span class="nv">Green</span><span class="p">,</span> <span class="nv">Blue</span><span class="p">,</span> <span class="nv">White</span><span class="p">);</span>
   <span class="kd">type</span> <span class="kt">Color_Array</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="kt">Integer</span> <span class="kr">range</span> <span class="p">&lt;&gt;)</span> <span class="kr">of</span> <span class="n">Color</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Reverse_Color_Array</span> <span class="kr">is</span> <span class="kr">new</span>
     <span class="kd">Generic</span><span class="mi">_</span><span class="n">Reverse_Array</span> <span class="p">(</span><span class="n">T</span>       <span class="p">=&gt;</span> <span class="n">Color</span><span class="p">,</span>
                            <span class="n">Index</span>   <span class="p">=&gt;</span> <span class="kt">Integer</span><span class="p">,</span>
                            <span class="n">Array_T</span> <span class="p">=&gt;</span> <span class="n">Color_Array</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Perform_Test_Reverse_Color_Array</span> <span class="kr">is</span> <span class="kr">new</span>
     <span class="n">Perform_Test</span> <span class="p">(</span><span class="n">T</span>       <span class="p">=&gt;</span> <span class="n">Color</span><span class="p">,</span>
                   <span class="n">Index</span>   <span class="p">=&gt;</span> <span class="kt">Integer</span><span class="p">,</span>
                   <span class="n">Array_T</span> <span class="p">=&gt;</span> <span class="n">Color_Array</span><span class="p">,</span>
                   <span class="n">S</span>       <span class="p">=&gt;</span> <span class="s">&quot;My_Color&quot;</span><span class="p">,</span>
                   <span class="n">Image</span>   <span class="p">=&gt;</span> <span class="n">Color</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">,</span>
                   <span class="n">Test</span>    <span class="p">=&gt;</span> <span class="n">Reverse_Color_Array</span><span class="p">);</span>

   <span class="n">My_Colors</span> <span class="p">:</span> <span class="n">Color_Array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="p">:=</span> <span class="p">(</span><span class="n">Black</span><span class="p">,</span> <span class="n">Red</span><span class="p">,</span> <span class="n">Green</span><span class="p">,</span> <span class="n">Blue</span><span class="p">,</span> <span class="n">White</span><span class="p">);</span>

<span class="kr">begin</span>
   <span class="n">Perform_Test_Reverse_Color_Array</span> <span class="p">(</span><span class="n">My_Colors</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Test_Reverse_Colors</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we create the procedure
<code class="docutils literal notranslate"><span class="pre">Perform_Test_Reverse_Color_Array</span></code> as an instance of the generic
procedure (<code class="docutils literal notranslate"><span class="pre">Perform_Test</span></code>). Note that:</p>
<blockquote>
<div><ul class="simple">
<li>For the formal <code class="docutils literal notranslate"><span class="pre">Image</span></code> function, we make use of the <code class="docutils literal notranslate"><span class="pre">'Image</span></code>
attribute of the <code class="docutils literal notranslate"><span class="pre">Color</span></code> type</li>
<li>For the formal <code class="docutils literal notranslate"><span class="pre">Test</span></code> procedure, we reference the
<code class="docutils literal notranslate"><span class="pre">Reverse_Array</span></code> procedure from the package.</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="exceptions">
<h1>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h1>
<p>Ada uses exceptions for error handling. Ada’s exceptions are not checked, which
means that a subprogram does not have to declare every exception kind that it
can potentially raise.</p>
<div class="section" id="exception-declaration">
<h2>Exception declaration<a class="headerlink" href="#exception-declaration" title="Permalink to this headline">¶</a></h2>
<p>Ada exceptions are not types, they’re objects, which is something peculiar
about them if you’re used to the way Java or Python does it. Here is how you
declare an exception:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Exceptions</span> <span class="kr">is</span>
    <span class="n">My_Except</span> <span class="p">:</span> <span class="kr">exception</span><span class="p">;</span>
    <span class="c1">-- Like an object. *NOT* a type !</span>
<span class="kr">end</span> <span class="nf">Exceptions</span><span class="p">;</span>
</pre></div>
</div>
<p>Even though they’re objects, you’re going to use each declared exception object
as a “kind” or “family” of exceptions.</p>
</div>
<div class="section" id="raising-an-exception">
<h2>Raising an exception<a class="headerlink" href="#raising-an-exception" title="Permalink to this headline">¶</a></h2>
<p>To raise an exception of our newly declared exception kind, here is how you do
it:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Exceptions</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Exceptions</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
<span class="kr">begin</span>
    <span class="kr">raise</span> <span class="n">My_Except</span><span class="p">;</span>
    <span class="c1">--  Execution of current control flow abandoned, an exception of kind</span>
    <span class="c1">--  &quot;My_Except&quot; will bubble up until it is caught.</span>

    <span class="kr">raise</span> <span class="n">My_Except</span> <span class="kn">with</span> <span class="s">&quot;My exception message&quot;</span><span class="p">;</span>
    <span class="c1">--  Execution of current control flow abandoned, an exception of kind</span>
    <span class="c1">--  &quot;My_Except&quot; with associated string will bubble up until it is caught.</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="handling-an-exception">
<h2>Handling an exception<a class="headerlink" href="#handling-an-exception" title="Permalink to this headline">¶</a></h2>
<p>Now we need to tackle how to actually handle exceptions that were raised by us,
or other libraries. The neat thing in Ada is that you can add an exception
handler to any statement block, the following way:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Exceptions</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Exceptions</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Open_File</span> <span class="kr">is</span>
   <span class="n">File</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Block (sequence of statements)</span>
   <span class="kr">begin</span>
      <span class="n">Open</span> <span class="p">(</span><span class="n">File</span><span class="p">,</span> <span class="n">In_File</span><span class="p">,</span> <span class="s">&quot;input.txt&quot;</span><span class="p">);</span>
   <span class="kr">exception</span>
      <span class="kr">when</span> <span class="n">E</span> <span class="p">:</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="c1">--       ^ Exception to be handled</span>
         <span class="n">Put</span> <span class="p">(</span><span class="s">&quot;Cannot open input file : &quot;</span><span class="p">);</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Exception_Message</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
         <span class="kr">raise</span><span class="p">;</span>
         <span class="c1">--  Reraise current occurence</span>
   <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Open_File</span><span class="p">;</span>
</pre></div>
</div>
<p>But you don’t need to introduce a block just to handle an exception, you can
add it even to the statements block of your current subprogram:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Exceptions</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Exceptions</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Open_File</span> <span class="kr">is</span>
   <span class="n">File</span> <span class="p">:</span> <span class="kt">File_Type</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Open</span> <span class="p">(</span><span class="n">File</span><span class="p">,</span> <span class="n">In_File</span><span class="p">,</span> <span class="s">&quot;input.txt&quot;</span><span class="p">);</span>
<span class="c1">--  Exception block can be added to any block</span>
<span class="kr">exception</span>
   <span class="kr">when</span> <span class="n">Name_Error</span> <span class="p">=&gt;</span>
      <span class="n">Put</span> <span class="p">(</span><span class="s">&quot;Cannot open input file&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Open_File</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="predefined-exceptions">
<h2>Predefined exceptions<a class="headerlink" href="#predefined-exceptions" title="Permalink to this headline">¶</a></h2>
<p>Ada has a very small number of predefined exceptions:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>Constraint_Error</cite> is the main one you might see. It is raised:</dt>
<dd><ul class="first last">
<li>When bounds or subtype doesn’t match/in general any violation of constraints.</li>
<li>In case of overflow (-gnato for GNAT)</li>
<li>In case of null dereferences</li>
<li>In case of division by 0</li>
</ul>
</dd>
</dl>
</li>
<li><cite>Program_Error</cite> might appear but probably less often. It is used for more
arcane stuff, such as elaboration issues, or erroneous execution.</li>
<li><dl class="first docutils">
<dt><cite>Storage_Error</cite> will happen because of memory issues, such as:</dt>
<dd><ul class="first last">
<li>Not enough memory (allocator)</li>
<li>Not enough stack</li>
</ul>
</dd>
</dl>
</li>
<li><cite>Tasking_Error</cite> will happen with task related errors, such as any error
happening during task activation.</li>
</ul>
<p>You should generally not reuse predefined exceptions, because it is then
obvious when they happen that it is because something went wrong in a built-in
language operation.</p>
</div>
</div>
<div class="section" id="tasking">
<h1>Tasking<a class="headerlink" href="#tasking" title="Permalink to this headline">¶</a></h1>
<p>Tasks and protected objects allow for implementing concurrency in Ada. The
following sections explain those concepts in more details.</p>
<div class="section" id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h2>
<p>A task can be thought as an application that runs <em>concurrently</em> with
the main application. In other programming languages, a task may also be
called a <a class="reference external" href="https://en.wikipedia.org/wiki/Thread_(computing)">thread</a>,
and tasking may be called
<a class="reference external" href="https://en.wikipedia.org/wiki/Thread_(computing)#Multithreading">multithreading</a>.</p>
<p>Tasks may synchronize with the main application, but they also may process
information completely independent from the main application. This section
will show how this is accomplished.</p>
<div class="section" id="simple-task">
<h3>Simple task<a class="headerlink" href="#simple-task" title="Permalink to this headline">¶</a></h3>
<p>Tasks can be declared by using the keyword <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">task</span></span></code>. The task
implementation is defined in a <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">task</span></span> <span class="keyword reserved"><span class="pre">body</span></span></code> block. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Simple_Task</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task T&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In main&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Task</span><span class="p">;</span>
</pre></div>
</div>
<p>Here, we’re declaring and implementing the task <code class="docutils literal notranslate"><span class="pre">T</span></code>. As soon as the
main application starts, task <code class="docutils literal notranslate"><span class="pre">T</span></code> will also start automatically — it’s
not necessary to manually start this task. By running the application
above, we can see that both calls to <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Put_Line</span></span></code> are performed.</p>
<p>Note that:</p>
<ul>
<li><p class="first">The main application is a task itself.</p>
<ul class="simple">
<li>In this case, the subprogram <code class="docutils literal notranslate"><span class="pre">Show_Simple_Task</span></code> is the main task of
the application.</li>
</ul>
</li>
<li><p class="first">Task <code class="docutils literal notranslate"><span class="pre">T</span></code> is a subtask.</p>
<ul class="simple">
<li>Each subtask has a master task.</li>
<li>Therefore, the main task is also the master task of task <code class="docutils literal notranslate"><span class="pre">T</span></code>.</li>
</ul>
</li>
<li><p class="first">The number of tasks is not limited to one: we could include a
task <code class="docutils literal notranslate"><span class="pre">T2</span></code> in the example above.</p>
<ul>
<li><p class="first">This task would also start automatically and run <em>concurrently</em> with
task <code class="docutils literal notranslate"><span class="pre">T</span></code> and the main task. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Simple_Tasks</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>
   <span class="kd">task</span> <span class="n">T2</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task T&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T2</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task T2&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T2</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In main&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Tasks</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="simple-synchronization">
<h3>Simple synchronization<a class="headerlink" href="#simple-synchronization" title="Permalink to this headline">¶</a></h3>
<p>As we’ve just seen, as soon as the main task starts, its subtasks
also start automatically. The main task will continue its
processing until it reaches the end of its implementation. At this point,
however, it will not finish. Instead, the main task will wait until its
subtasks have finished before it finishes itself. In other words, after
this waiting process, a synchronization between the main task and its
subtasks occurs. After this final synchronization, the main task may
finish. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Simple_Sync</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>
   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
   <span class="c1">--  Will wait here until all tasks have terminated</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Sync</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that the same mechanism is used for other subprograms that contain
subtasks: the subprogram’s master task will wait for its subtasks to
finish. In other words, this mechanism is not limited to the main
application, but is also applied to any subprogram called by the main
application or its subprograms.</p>
<p>A synchronization is also achieved if we move the task to a separate
package. In the example below, we declare a task <code class="docutils literal notranslate"><span class="pre">T</span></code> in the package
<code class="docutils literal notranslate"><span class="pre">Simple_Sync_Pkg</span></code>.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Simple_Sync_Pkg</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Simple_Sync_Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>This is the corresponding package implementation:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">Simple_Sync_Pkg</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Simple_Sync_Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>As soon as the package is <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">with</span></span></code>’ed for the main procedure, the task
<code class="docutils literal notranslate"><span class="pre">T</span></code> defined in the package will be part of the main task. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Simple_Sync_Pkg</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Test_Simple_Sync_Pkg</span> <span class="kr">is</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
   <span class="c1">--  Will wait here until all tasks have terminated</span>
<span class="kr">end</span> <span class="nf">Test_Simple_Sync_Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>Again, as soon as the main task reaches its end, it will synchronize with
task <code class="docutils literal notranslate"><span class="pre">T</span></code> from <code class="docutils literal notranslate"><span class="pre">Simple_Sync_Pkg</span></code> before finishing.</p>
</div>
<div class="section" id="delay">
<h3>Delay<a class="headerlink" href="#delay" title="Permalink to this headline">¶</a></h3>
<p>A delay may be introduced by using the keyword <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span></code>. This will
put the task to sleep for the amount of seconds specified in the delay
statement. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Delay</span> <span class="kr">is</span>

   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;hello from task T&quot;</span><span class="p">);</span>
         <span class="kr">delay</span> <span class="mf">1.0</span><span class="p">;</span>
         <span class="c1">--    ^ Wait 1.0 seconds</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kr">delay</span> <span class="mf">1.5</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;hello from main&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Delay</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we’re making the task <code class="docutils literal notranslate"><span class="pre">T</span></code> wait one second after each
time it displays the “hello” message. Also, the main task is waiting 1.5
seconds and displaying another “hello” message</p>
</div>
<div class="section" id="synchronization-rendez-vous">
<h3>Synchronization: rendez-vous<a class="headerlink" href="#synchronization-rendez-vous" title="Permalink to this headline">¶</a></h3>
<p>In the previous examples, the only kind of synchronization we’ve seen was
the one that happens automatically at the end of the main task. In
addition to that, it is possible to define custom synchronization points
using the keyword <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">entry</span></span></code>. An entry can be viewed as a special kind
of subprogram, and it be called by the master task using a similar syntax,
as we will see later.</p>
<p>In the task implementation, we shall define in which part of the task the
entries will be accepted by using the keyword <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span></code>. A task will
process its statements until it reaches an <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span></code> statement. At
this point, it will wait for the master task to synchronize with the it.
In other words:</p>
<ul class="simple">
<li>The subtask will wait at this point (in the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span></code> statement),
ready to accept a call from the master task to the corresponding entry.</li>
<li>The master task will call the task entry in order to synchronize with
the subtask — similar to a procedure call.</li>
</ul>
<p>The synchronization between tasks is called rendez-vous. Let’s see an
example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Rendezvous</span> <span class="kr">is</span>

   <span class="kd">task</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="kd">entry</span> <span class="nf">Start</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">accept</span> <span class="n">Start</span><span class="p">;</span> <span class="c1">-- Waiting for somebody to call the entry</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In T&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In Main&quot;</span><span class="p">);</span>
   <span class="n">T</span><span class="p">.</span><span class="n">Start</span><span class="p">;</span> <span class="c1">--  Calling T&#39;s entry</span>
<span class="kr">end</span> <span class="nf">Show_Rendezvous</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we declare an entry <code class="docutils literal notranslate"><span class="pre">Start</span></code> for the task <code class="docutils literal notranslate"><span class="pre">T</span></code>.
In the task body, we implement this entry by using <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span> <span class="name"><span class="pre">Start</span></span></code>.
When the task <code class="docutils literal notranslate"><span class="pre">T</span></code> reaches this point, it will wait for the master task
to synchronize. This synchronization happens in the <code class="docutils literal notranslate"><span class="pre">T.Start</span></code> statement.
After the synchronization is finished, the main task and task <code class="docutils literal notranslate"><span class="pre">T</span></code>
will run concurrently until they synchronize again when the main
task reaches its end.</p>
<p>Note that an entry may be used to perform more than just a simple
task synchronization: we may also perform multiple statements during
the time both tasks are synchronized. This is achieved by using a
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">do</span></span> <span class="punctuation"><span class="pre">…</span></span> <span class="keyword reserved"><span class="pre">end</span></span></code> block. For the previous example, we would simply write
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span> <span class="name"><span class="pre">Start</span></span> <span class="keyword reserved"><span class="pre">do</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="name"><span class="pre">statements</span></span><span class="operator"><span class="pre">&gt;</span></span><span class="punctuation"><span class="pre">;</span></span> <span class="keyword reserved"><span class="pre">end</span></span><span class="punctuation"><span class="pre">;</span></span></code>. We will use this kind of block
in the next example.</p>
</div>
<div class="section" id="select-loop">
<h3>Select loop<a class="headerlink" href="#select-loop" title="Permalink to this headline">¶</a></h3>
<p>There is no limit for the amount of times an entry might be accepted in
the task implementation. In fact, we could create an infinite loop in the
task implementation and accept calls to the same entry over and over. An
infinite loop, however, would prevent the subtask from finishing, so it
would also block the master task when it reaches the end of its
processing. Therefore, a loop containing <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span></code> statements in a
task body is normally implemented together with a
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">select</span></span> <span class="punctuation"><span class="pre">…</span></span> <span class="keyword reserved"><span class="pre">or</span></span> <span class="keyword reserved"><span class="pre">terminate</span></span></code> statement. In simple terms, this statement
allows the master task to terminate the subtask when the end of the master
task is reached. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Rendezvous_Loop</span> <span class="kr">is</span>

   <span class="kd">task</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="kd">entry</span> <span class="nf">Start</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="n">Cnt</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">loop</span>
         <span class="kr">select</span>
            <span class="kr">accept</span> <span class="n">Start</span> <span class="kr">do</span>
               <span class="n">Cnt</span> <span class="p">:=</span> <span class="n">Cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="kr">end</span> <span class="nf">Start</span><span class="p">;</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In T&#39;s loop (&quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Cnt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot;)&quot;</span><span class="p">);</span>
         <span class="kr">or</span>
            <span class="kr">terminate</span><span class="p">;</span>
         <span class="kr">end</span> <span class="kr">select</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In Main&quot;</span><span class="p">);</span>

   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">4</span> <span class="kr">loop</span>
      <span class="n">T</span><span class="p">.</span><span class="n">Start</span><span class="p">;</span> <span class="c1">--  Calling T&#39;s entry multiple times</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Rendezvous_Loop</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, the task body implements an infinite loop that accepts
calls to the <code class="docutils literal notranslate"><span class="pre">Start</span></code> entry. We can make the following observations:</p>
<ul>
<li><p class="first">In this case, an <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">accept</span></span> <span class="name"><span class="pre">E</span></span> <span class="keyword reserved"><span class="pre">do</span></span> <span class="punctuation"><span class="pre">…</span></span> <span class="keyword reserved"><span class="pre">end</span></span></code> block is used, where a
counter is incremented.</p>
<blockquote>
<div><ul class="simple">
<li>As long as task <code class="docutils literal notranslate"><span class="pre">T</span></code> is performing the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">do</span></span> <span class="punctuation"><span class="pre">…</span></span> <span class="keyword reserved"><span class="pre">end</span></span></code> block, the
main task will wait for the block to finish.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">In addition, the main task is calling the <code class="docutils literal notranslate"><span class="pre">Start</span></code> entry  multiple
times in the loop from <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">..</span> <span class="pre">4</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li>Because task <code class="docutils literal notranslate"><span class="pre">T</span></code> uses an infinite loop, it will always accept
calls to the <code class="docutils literal notranslate"><span class="pre">Start</span></code> entry.</li>
<li>When the main task reaches the end, it will check the status of the
<code class="docutils literal notranslate"><span class="pre">T</span></code> task. Even though task <code class="docutils literal notranslate"><span class="pre">T</span></code> could accept new calls to the
<code class="docutils literal notranslate"><span class="pre">Start</span></code> entry, the master task is allowed to terminate task <code class="docutils literal notranslate"><span class="pre">T</span></code>
due to the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">or</span></span> <span class="keyword reserved"><span class="pre">terminate</span></span></code> part of the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">select</span></span></code> statement.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="cycling-tasks">
<h3>Cycling tasks<a class="headerlink" href="#cycling-tasks" title="Permalink to this headline">¶</a></h3>
<p>In a previous example, we’ve seen that we can delay a task by a given
amount of seconds using <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span></code> keyword. When using delay statements
in a loop, however, we cannot expect to have regular interval between the
delay statements. For example, we may have a call to a computationally
intensive procedure between the delay statements:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span>      <span class="kr">while</span> <span class="kc">True</span> <span class="kr">loop</span>
         <span class="kr">delay</span> <span class="mf">1.0</span><span class="p">;</span>
         <span class="c1">--    ^ Wait 1.0 seconds</span>
         <span class="n">Computational_Intensive_App</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
</pre></div>
</div>
<p>In this case, we cannot guarantee that, after 10 calls to the delay
statement, the time span is just 10 seconds. In fact, a time drift may be
introduced by the <code class="docutils literal notranslate"><span class="pre">Computational_Intensive_App</span></code> procedure. In many
cases, this time drift is not relevant, so that using the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span></code>
keyword is good enough.</p>
<p>There are situations, however, where a time drift is not acceptable. In
this case, we need to use the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span> <span class="keyword reserved"><span class="pre">until</span></span></code> statement, which accepts
a precise time for the next execution, so that a regular interval can be
defined. This is useful, for example, in real-time applications.</p>
<p>We will see an example of how this time drift may be introduced, and how
the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span> <span class="keyword reserved"><span class="pre">until</span></span></code> statement circumvents the problem. Before we do
that, we will look into an auxiliary package containing a procedure that
allows for measuring the elapsed time (<code class="docutils literal notranslate"><span class="pre">Show_Elapsed_Time</span></code>) and a dummy
<code class="docutils literal notranslate"><span class="pre">Computational_Intensive_App</span></code> procedure using a simple delay. This is
the package specification:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">Delay_Aux_Pkg</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">Get_Start_Time</span> <span class="nf">return</span> <span class="nf">Time</span>
     <span class="nf">with</span> <span class="nf">Inline</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elapsed_Time</span>
     <span class="nf">with</span> <span class="nf">Inline</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Computational_Intensive_App</span><span class="p">;</span>
<span class="kd">private</span>
   <span class="n">Start_Time</span>   <span class="p">:</span> <span class="n">Time</span> <span class="p">:=</span> <span class="n">Clock</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Get_Start_Time</span> <span class="nf">return</span> <span class="nf">Time</span> <span class="kr">is</span> <span class="p">(</span><span class="n">Start_Time</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Delay_Aux_Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>This is the package definition:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">Delay_Aux_Pkg</span> <span class="kr">is</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elapsed_Time</span> <span class="kr">is</span>
      <span class="n">Now_Time</span>     <span class="p">:</span> <span class="n">Time</span><span class="p">;</span>
      <span class="n">Elapsed_Time</span> <span class="p">:</span> <span class="n">Time_Span</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">Now_Time</span>     <span class="p">:=</span> <span class="n">Clock</span><span class="p">;</span>
      <span class="n">Elapsed_Time</span> <span class="p">:=</span> <span class="n">Now_Time</span> <span class="o">-</span> <span class="n">Start_Time</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Elapsed time &quot;</span>
                <span class="o">&amp;</span> <span class="kt">Duration</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">To_Duration</span> <span class="p">(</span><span class="n">Elapsed_Time</span><span class="p">))</span>
                <span class="o">&amp;</span> <span class="s">&quot; seconds&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Show_Elapsed_Time</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Computational_Intensive_App</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">delay</span> <span class="mf">0.5</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Computational_Intensive_App</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Delay_Aux_Pkg</span><span class="p">;</span>
</pre></div>
</div>
<p>Using this auxiliary package, we’re now ready to write our time-drifting
application:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>   <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Delay_Aux_Pkg</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Time_Drifting_Task</span> <span class="kr">is</span>
   <span class="kd">package</span> <span class="nc">Aux</span> <span class="kr">renames</span> <span class="nc">Delay_Aux_Pkg</span><span class="p">;</span>

   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="n">Cnt</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span> <span class="kr">loop</span>
         <span class="kr">delay</span> <span class="mf">1.0</span><span class="p">;</span>

         <span class="n">Aux</span><span class="p">.</span><span class="n">Show_Elapsed_Time</span><span class="p">;</span>
         <span class="n">Aux</span><span class="p">.</span><span class="n">Computational_Intensive_App</span><span class="p">;</span>

         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Cycle # &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Cnt</span><span class="p">));</span>
         <span class="n">Cnt</span>  <span class="p">:=</span> <span class="n">Cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Finished time-drifting loop&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Time_Drifting_Task</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see by running the application, due to the drift introduced by
<code class="docutils literal notranslate"><span class="pre">Computational_Intensive_App</span></code>, after three iterations of the loop, we
already have a time span of about four seconds. Using the
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span> <span class="keyword reserved"><span class="pre">until</span></span></code> statement, however, we’ll be able to avoid this time
drift and have a regular interval of one second:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>   <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Real_Time</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Delay_Aux_Pkg</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Cycling_Task</span> <span class="kr">is</span>
   <span class="kd">package</span> <span class="nc">Aux</span> <span class="kr">renames</span> <span class="nc">Delay_Aux_Pkg</span><span class="p">;</span>

   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
      <span class="no">Cycle</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">Time_Span</span> <span class="p">:=</span> <span class="n">Milliseconds</span> <span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
      <span class="n">Next</span>  <span class="p">:</span> <span class="n">Time</span> <span class="p">:=</span> <span class="n">Aux</span><span class="p">.</span><span class="n">Get_Start_Time</span> <span class="o">+</span> <span class="n">Cycle</span><span class="p">;</span>

      <span class="n">Cnt</span>   <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span> <span class="kr">loop</span>
         <span class="kr">delay</span> <span class="kr">until</span> <span class="n">Next</span><span class="p">;</span>

         <span class="n">Aux</span><span class="p">.</span><span class="n">Show_Elapsed_Time</span><span class="p">;</span>
         <span class="n">Aux</span><span class="p">.</span><span class="n">Computational_Intensive_App</span><span class="p">;</span>

         <span class="c1">--  Calculate next execution time using a</span>
         <span class="c1">--  cycle of one seconds</span>
         <span class="n">Next</span> <span class="p">:=</span> <span class="n">Next</span> <span class="o">+</span> <span class="n">Cycle</span><span class="p">;</span>

         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Cycle # &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Cnt</span><span class="p">));</span>
         <span class="n">Cnt</span>  <span class="p">:=</span> <span class="n">Cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Finished cycling&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Cycling_Task</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see by running the application, the <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">delay</span></span> <span class="keyword reserved"><span class="pre">until</span></span></code> statement
makes sure that the <code class="docutils literal notranslate"><span class="pre">Computational_Intensive_App</span></code> does not affect the
regular interval of one second between the iterations.</p>
</div>
</div>
<div class="section" id="protected-objects">
<h2>Protected objects<a class="headerlink" href="#protected-objects" title="Permalink to this headline">¶</a></h2>
<p>In situations where multiple tasks are accessing shared data, data
corruption may happen. For example, data will be inconsistent when one
task overwrites parts of the information that is being read by another
task. In order to avoid this kind of problems and ensure that the
information is accessed in a coordinated way, we can use protected
objects.</p>
<p>Protected objects encapsulate data and provide access to this data by
means of protected operations. These protected operations may be
subprograms or protected entries. Using protected objects ensures that the
data will not be corrupted by race conditions.</p>
<div class="admonition-important admonition">
<p class="first admonition-title">Important</p>
<p class="last">It is possible to implement protected objects using Ada tasks. In
fact, this was the only possible way of implementing them in Ada 83
(the first version of the Ada language). However, the use of protected
objects greatly simplify the implementation when compared to similar
mechanisms implemented strictly with tasks. Therefore, the
recommendation is to use protected objects when the main goal is to
just protect data.</p>
</div>
<div class="section" id="simple-object">
<h3>Simple object<a class="headerlink" href="#simple-object" title="Permalink to this headline">¶</a></h3>
<p>A protected object is declared by using the <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">protected</span></span></code> keyword. The
syntax is similar to the one used for packages: we can declare operations
(e.g.: procedures and functions) in the public part, and data in the
private part. The corresponding implementation of the operations is
included in the <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">protected</span></span> <span class="keyword reserved"><span class="pre">body</span></span></code> of the object. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Protected_Objects</span> <span class="kr">is</span>

   <span class="kd">protected</span> <span class="n">Obj</span> <span class="kr">is</span>
      <span class="c1">--  Operations go here (only subprograms)</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">Integer</span><span class="p">;</span>
   <span class="kd">private</span>
      <span class="c1">--  Data goes here</span>
      <span class="n">Local</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj</span><span class="p">;</span>

   <span class="kd">protected</span> <span class="kr">body</span> <span class="n">Obj</span> <span class="kr">is</span>
      <span class="c1">--  procedures can modify the data</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Local</span> <span class="p">:=</span> <span class="n">V</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>

      <span class="c1">--  functions cannot modify the data</span>
      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">Integer</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="kr">return</span> <span class="n">Local</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Get</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Obj</span><span class="p">.</span><span class="n">Set</span> <span class="p">(</span><span class="mi">5</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Number is: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Obj</span><span class="p">.</span><span class="n">Get</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Protected_Objects</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we are defining two operations for <code class="docutils literal notranslate"><span class="pre">Obj</span></code>: <code class="docutils literal notranslate"><span class="pre">Set</span></code> and
<code class="docutils literal notranslate"><span class="pre">Get</span></code>. The implementation of these operations can be found in the
<code class="docutils literal notranslate"><span class="pre">Obj</span></code> body. The syntax used for implementing these operations is the
same as the one used for common procedures and functions. Therefore  the
implementation of protected objects is straightforward — we simply
access and update <code class="docutils literal notranslate"><span class="pre">Local</span></code> in these subprograms. In order to call these
operations in the main application, we use the prefixed notation, e.g.:
<code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code>.</p>
</div>
<div class="section" id="entries">
<h3>Entries<a class="headerlink" href="#entries" title="Permalink to this headline">¶</a></h3>
<p>In addition to protected procedures and functions, we may also define
protected entry points. This is achieved by using the <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">entry</span></span></code>
keyword. Protected entry points allow for defining barriers using the
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">when</span></span></code> keyword. Barriers are conditions that must be fulfilled before
the actual processing defined in the entry can start.</p>
<p>In the previous example, we’ve used procedures and functions to define
our operations on the protected objects. However, this implementation
allows for reading the protected information (via <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code>) before the
information is set (via <code class="docutils literal notranslate"><span class="pre">Obj.Set</span></code>). In that case, we have defined a
default value (0). By rewriting <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code> and using an entry instead of
a function, we may implement a barrier: this ensures that no task will
read the information before it has been first set.</p>
<p>The following example implements the barrier for the <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code>
operation. Also, it contains two concurrent subprograms (main task
and task <code class="docutils literal notranslate"><span class="pre">T</span></code>) that try to access the protected object.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Protected_Objects_Entries</span> <span class="kr">is</span>

   <span class="kd">protected</span> <span class="n">Obj</span> <span class="kr">is</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
      <span class="kd">entry</span> <span class="nf">Get</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">);</span>
   <span class="kd">private</span>
      <span class="n">Local</span>  <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
      <span class="n">Is_Set</span> <span class="p">:</span> <span class="kt">Boolean</span> <span class="p">:=</span> <span class="kc">False</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj</span><span class="p">;</span>

   <span class="kd">protected</span> <span class="kr">body</span> <span class="n">Obj</span> <span class="kr">is</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Local</span> <span class="p">:=</span> <span class="n">V</span><span class="p">;</span>
         <span class="n">Is_Set</span> <span class="p">:=</span> <span class="kc">True</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>

      <span class="kd">entry</span> <span class="nf">Get</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span>
        <span class="kr">when</span> <span class="n">Is_Set</span> <span class="kr">is</span>
         <span class="c1">--  Entry will be blocked until the condition is true.</span>
         <span class="c1">--  Barrier is evaluated at call of entry, and at exit of</span>
         <span class="c1">--  procedures and entries.</span>
         <span class="c1">--  Calling task will sleep until the barrier is relieved.</span>
      <span class="kr">begin</span>
         <span class="n">V</span> <span class="p">:=</span> <span class="n">Local</span><span class="p">;</span>
         <span class="n">Is_Set</span> <span class="p">:=</span> <span class="kc">False</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Get</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj</span><span class="p">;</span>

   <span class="n">N</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>

   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Task T will delay for 4 seconds...&quot;</span><span class="p">);</span>
      <span class="kr">delay</span> <span class="mf">4.0</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Task T will set Obj...&quot;</span><span class="p">);</span>
      <span class="n">Obj</span><span class="p">.</span><span class="n">Set</span> <span class="p">(</span><span class="mi">5</span><span class="p">);</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Task T has just set Obj...&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Main application will get Obj...&quot;</span><span class="p">);</span>
   <span class="n">Obj</span><span class="p">.</span><span class="n">Get</span> <span class="p">(</span><span class="n">N</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Main application has just retrieved Obj...&quot;</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Number is: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">N</span><span class="p">));</span>

<span class="kr">end</span> <span class="nf">Show_Protected_Objects_Entries</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see by running the application, the main application waits until
the protected object is set (by the call to <code class="docutils literal notranslate"><span class="pre">Obj.Set</span></code> in task <code class="docutils literal notranslate"><span class="pre">T</span></code>)
before it reads the information (via <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code>). Because a 4-second
delay has been added in task <code class="docutils literal notranslate"><span class="pre">T</span></code>, the main application will also be
delayed by 4 seconds. Only after this delay, task <code class="docutils literal notranslate"><span class="pre">T</span></code> will set the
object and release the barrier set by <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code>, so that the main
application can then restore processing (after the information from the
protected object is retrieved).</p>
</div>
</div>
<div class="section" id="task-and-protected-types">
<h2>Task and protected types<a class="headerlink" href="#task-and-protected-types" title="Permalink to this headline">¶</a></h2>
<p>In the previous examples, we have defined single tasks and protected
objects. It is possible, however, to generalize tasks and protected
objects using type definitions. This allows, for example, for creating
multiple tasks based on just a single task type.</p>
<div class="section" id="task-types">
<h3>Task types<a class="headerlink" href="#task-types" title="Permalink to this headline">¶</a></h3>
<p>A task type is a generalization of a task. The declaration is similar to
simple tasks: you just have to replace <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">task</span></span></code> by <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">task</span></span> <span class="keyword reserved"><span class="pre">type</span></span></code>.
The main difference between simple tasks and task types is that task types
don’t create actual tasks that automatically start. Instead, a task
declaration is needed for that — similar to variable declarations.</p>
<p>For example, we may reuse our first example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Simple_Task</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="n">T</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">T</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task T&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">T</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In main&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Task</span><span class="p">;</span>
</pre></div>
</div>
<p>We can rewrite the example and replace <code class="docutils literal notranslate"><span class="pre">task</span> <span class="pre">T</span></code> by <code class="docutils literal notranslate"><span class="pre">task</span> <span class="pre">type</span> <span class="pre">TT</span></code>.
After the type definition is complete, we declare a task (<code class="docutils literal notranslate"><span class="pre">A_Task</span></code>)
based on the task type <code class="docutils literal notranslate"><span class="pre">TT</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Simple_Task_Type</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="kd">type</span> <span class="kt">TT</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">TT</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task type TT&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">TT</span><span class="p">;</span>

   <span class="n">A_Task</span> <span class="p">:</span> <span class="n">TT</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In main&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Simple_Task_Type</span><span class="p">;</span>
</pre></div>
</div>
<p>We may extend this example and create an array of tasks. Since we’re using
the same syntax as for variable declarations, we can simply use a similar
syntax for task types: <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">array</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">of</span></span> <span class="keyword declaration"><span class="pre">Task</span></span><span class="literal number integer"><span class="pre">_</span></span><span class="name"><span class="pre">Type</span></span></code>. Also, we may pass
information to the individual tasks by defining a <code class="docutils literal notranslate"><span class="pre">Start</span></code> entry. This
is the updated example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Task_Type_Array</span> <span class="kr">is</span>
   <span class="kd">task</span> <span class="kd">type</span> <span class="kt">TT</span> <span class="kr">is</span>
      <span class="kd">entry</span> <span class="nf">Start</span> <span class="p">(</span><span class="nv">N</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">TT</span><span class="p">;</span>

   <span class="kd">task</span> <span class="kr">body</span> <span class="n">TT</span> <span class="kr">is</span>
      <span class="kd">Task</span><span class="mi">_</span><span class="n">N</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="kr">accept</span> <span class="n">Start</span> <span class="p">(</span><span class="n">N</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">)</span> <span class="kr">do</span>
         <span class="kd">Task</span><span class="mi">_</span><span class="n">N</span> <span class="p">:=</span> <span class="n">N</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Start</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In task T: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="kd">Task</span><span class="mi">_</span><span class="n">N</span><span class="p">));</span>
   <span class="kr">end</span> <span class="nf">TT</span><span class="p">;</span>

   <span class="n">My_Tasks</span> <span class="p">:</span> <span class="kr">array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span> <span class="kr">of</span> <span class="n">TT</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In main&quot;</span><span class="p">);</span>

   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">My_Tasks</span><span class="p">&#39;</span><span class="na">Range</span> <span class="kr">loop</span>
      <span class="n">My_Tasks</span> <span class="p">(</span><span class="n">I</span><span class="p">).</span><span class="n">Start</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Task_Type_Array</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example above, we’re declaring five tasks in the array
<code class="docutils literal notranslate"><span class="pre">My_Tasks</span></code>. We pass the array index to the individual tasks in the
start entry point (<code class="docutils literal notranslate"><span class="pre">Start</span></code>). After the synchronization with the
individual subtasks in the main task, each subtask will proceed to call
<code class="docutils literal notranslate"><span class="pre">Put_Line</span></code> concurrently.</p>
</div>
<div class="section" id="protected-types">
<h3>Protected types<a class="headerlink" href="#protected-types" title="Permalink to this headline">¶</a></h3>
<p>A protected type is a generalization of a protected object. The
declaration is similar to protected objects: you just have to replace
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">protected</span></span></code> by <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">protected</span></span> <span class="keyword reserved"><span class="pre">type</span></span></code>. However, similar to task types,
protected types require an object declaration in order to create actual
objects. Again, this is similar to variable declarations and allows for
creating arrays of protected objects, for example.</p>
<p>We can reuse a previous example and rewrite it to use a protected type:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Protected_Object_Type</span> <span class="kr">is</span>

   <span class="kd">protected</span> <span class="kd">type</span> <span class="kt">Obj_Type</span> <span class="kr">is</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">Integer</span><span class="p">;</span>
   <span class="kd">private</span>
      <span class="n">Local</span> <span class="p">:</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj_Type</span><span class="p">;</span>

   <span class="kd">protected</span> <span class="kr">body</span> <span class="n">Obj_Type</span> <span class="kr">is</span>
      <span class="kd">procedure</span> <span class="nf">Set</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Local</span> <span class="p">:=</span> <span class="n">V</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Set</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nf">Get</span> <span class="nf">return</span> <span class="nf">Integer</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="kr">return</span> <span class="n">Local</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Get</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Obj_Type</span><span class="p">;</span>

   <span class="n">Obj</span> <span class="p">:</span> <span class="n">Obj_Type</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Obj</span><span class="p">.</span><span class="n">Set</span> <span class="p">(</span><span class="mi">5</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Number is: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Obj</span><span class="p">.</span><span class="n">Get</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Protected_Object_Type</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, instead of directly defining the protected object
<code class="docutils literal notranslate"><span class="pre">Obj</span></code>, we first define a protected type <code class="docutils literal notranslate"><span class="pre">Obj_Type</span></code> and then declare
<code class="docutils literal notranslate"><span class="pre">Obj</span></code> based on that protected type. Note that the main application
hasn’t change: we still use <code class="docutils literal notranslate"><span class="pre">Obj.Set</span></code> and <code class="docutils literal notranslate"><span class="pre">Obj.Get</span></code> to access the
protected object as in the original example.</p>
</div>
</div>
</div>
<div class="section" id="interfacing-with-c-and-c">
<h1>Interfacing with C and C++<a class="headerlink" href="#interfacing-with-c-and-c" title="Permalink to this headline">¶</a></h1>
<p>Ada allows for interfacing with existing code in C and C++. In order to
achieve this, a few recommendations need to be observed. This section will
discuss them.</p>
<div class="section" id="multi-language-project">
<h2>Multi-language project<a class="headerlink" href="#multi-language-project" title="Permalink to this headline">¶</a></h2>
<p>When using <code class="docutils literal notranslate"><span class="pre">gprbuild</span></code>, we can only compile Ada source-code files by
default. In order to compile C files in addition to Ada files, we need to
adapt the project file used by <code class="docutils literal notranslate"><span class="pre">gprbuild</span></code>. This can be achieved by
using the <code class="docutils literal notranslate"><span class="pre">Languages</span></code> entry, as in the following example:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="n">Multilang</span> <span class="kr">is</span>

   <span class="kr">for</span> <span class="n">Languages</span> <span class="kn">use</span> <span class="p">(</span><span class="s">&quot;ada&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">);</span>

   <span class="kr">for</span> <span class="n">Source_Dirs</span> <span class="kn">use</span> <span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">Main</span> <span class="kn">use</span> <span class="p">(</span><span class="s">&quot;main.adb&quot;</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">Object_Dir</span> <span class="kn">use</span> <span class="s">&quot;obj&quot;</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Multilang</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="type-convention">
<h2>Type convention<a class="headerlink" href="#type-convention" title="Permalink to this headline">¶</a></h2>
<p>In order to interface with data types declared in a C application, the
convention aspect needs to be specified. In the following example, we
interface with the <code class="docutils literal notranslate"><span class="pre">C_Enum</span></code> enumeration declared in a C source-code
file:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Show_C_Enum</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">C_Enum</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">,</span> <span class="nv">C</span><span class="p">)</span> <span class="kr">with</span> <span class="n">Convention</span> <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>
   <span class="c1">-- Use C convention for C_Enum</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_C_Enum</span><span class="p">;</span>
</pre></div>
</div>
<p>In order to interface with C built-in types, we need to reference to the
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Interfaces</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">C</span></span></code> package, which contains all type definitions that we
need. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_C_Struct</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">c_struct</span> <span class="kr">is</span> <span class="kr">record</span>
      <span class="n">a</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>
      <span class="n">b</span> <span class="p">:</span> <span class="n">long</span><span class="p">;</span>
      <span class="n">c</span> <span class="p">:</span> <span class="n">unsigned</span><span class="p">;</span>
      <span class="n">d</span> <span class="p">:</span> <span class="n">double</span><span class="p">;</span>
   <span class="kr">end record</span>
     <span class="kr">with</span> <span class="n">Convention</span> <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_C_Struct</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we’re interfacing with a C struct (<code class="docutils literal notranslate"><span class="pre">C_Struct</span></code>) and
making use of the corresponding data types in C (<code class="code c docutils literal notranslate"><span class="keyword type"><span class="pre">int</span></span></code>, <code class="code c docutils literal notranslate"><span class="keyword type"><span class="pre">long</span></span></code>,
<code class="code c docutils literal notranslate"><span class="keyword type"><span class="pre">unsigned</span></span></code> and <code class="code c docutils literal notranslate"><span class="keyword type"><span class="pre">double</span></span></code>). This is the original declaration:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">c_struct</span>
<span class="p">{</span>
    <span class="kt">int</span>         <span class="n">a</span><span class="p">;</span>
    <span class="kt">long</span>        <span class="n">b</span><span class="p">;</span>
    <span class="kt">unsigned</span>    <span class="n">c</span><span class="p">;</span>
    <span class="kt">double</span>      <span class="n">d</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="foreign-subprograms">
<h2>Foreign subprograms<a class="headerlink" href="#foreign-subprograms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calling-c-subprograms-in-ada">
<h3>Calling C subprograms in Ada<a class="headerlink" href="#calling-c-subprograms-in-ada" title="Permalink to this headline">¶</a></h3>
<p>A similar approach is used when interfacing with subprograms written in C.
In this case, an additional aspect is required: <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Import</span></span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_C_Func</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>
   <span class="c1">--  Imports function &#39;my_func&#39; from C.</span>
   <span class="c1">--  You can now call it from Ada.</span>

<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_C_Func</span><span class="p">;</span>
</pre></div>
</div>
<p>This code interfaces with the following declaration in the C header file:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>This is the corresponding implementation:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;my_func.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is possible to use a different subprogram name in the Ada code. For
example, we could rename the original C function to <code class="docutils literal notranslate"><span class="pre">Get_Value</span></code> in the
Ada code:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_C_Func</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">Get_Value</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">,</span>
       <span class="n">External_Name</span> <span class="p">=&gt;</span> <span class="s">&quot;my_func&quot;</span><span class="p">;</span>

   <span class="c1">--  Imports function &#39;my_func&#39; from C and</span>
   <span class="c1">--  rename it to &#39;Get_Value&#39;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">Get_Value</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">V</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_C_Func</span><span class="p">;</span>
</pre></div>
</div>
<p>As the example shows, we can make use of the <code class="docutils literal notranslate"><span class="pre">Get_Value</span></code> function and
retrieve information without additional efforts.</p>
</div>
<div class="section" id="calling-ada-subprograms-in-c">
<h3>Calling Ada subprograms in C<a class="headerlink" href="#calling-ada-subprograms-in-c" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to call Ada subprograms in C applications. This
requires the use of the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Export</span></span></code> aspect. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">C_API</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">My_Func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Export</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">,</span>
       <span class="n">External_Name</span> <span class="p">=&gt;</span> <span class="s">&quot;my_func&quot;</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">C_API</span><span class="p">;</span>
</pre></div>
</div>
<p>This is the corresponding implementation:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="kd">body</span> <span class="nc">C_API</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">My_Func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="kr">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">My_Func</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">C_API</span><span class="p">;</span>
</pre></div>
</div>
<p>In the C code, we simply have to declare the function using the <code class="code c docutils literal notranslate"><span class="keyword"><span class="pre">extern</span></span></code>
keyword. For example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>

  <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">my_func</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Result is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="foreign-variables">
<h2>Foreign variables<a class="headerlink" href="#foreign-variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-c-global-variables-in-ada">
<h3>Using C global variables in Ada<a class="headerlink" href="#using-c-global-variables-in-ada" title="Permalink to this headline">¶</a></h3>
<p>In order to use global variables from C code, we can apply the same method
as for subprograms: we just specify the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Import</span></span></code> and <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Convention</span></span></code>
aspects for the variable we want to import.</p>
<p>Let’s reuse an example from the previous section. We’ll add a global
variable (<code class="docutils literal notranslate"><span class="pre">func_cnt</span></code>) that counts the number of times that a the
function (<code class="docutils literal notranslate"><span class="pre">my_func</span></code>) was called:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*% filename: test.h */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">func_cnt</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>The variable is then declared in the C file and increment in <code class="docutils literal notranslate"><span class="pre">my_func</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;test.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="n">func_cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">func_cnt</span><span class="o">++</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the Ada application, we just need to reference the foreign variable:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_C_Func</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>

   <span class="n">func_cnt</span> <span class="p">:</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>
   <span class="c1">--  We can access the func_cnt variable from test.c</span>

<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">3</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Function was called &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">func_cnt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; times&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_C_Func</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see by running the application, the value from the counter will
contain the correct number of times that <code class="docutils literal notranslate"><span class="pre">my_func</span></code> was called.</p>
<p>Similar to subprograms, we could use the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">External_Name</span></span></code> aspect to
rename the variable in the Ada application.</p>
</div>
<div class="section" id="using-ada-variables-in-c">
<h3>Using Ada variables in C<a class="headerlink" href="#using-ada-variables-in-c" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to use variables declared in Ada files in C
applications. Similarly to subprogram, this requires the use of the
<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Export</span></span></code> aspect.</p>
<p>Let’s reuse the previous example and add a counter, as we did in the
previous example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">C_API</span> <span class="kr">is</span>

   <span class="n">func_cnt</span> <span class="p">:</span> <span class="n">int</span> <span class="p">:=</span> <span class="mi">0</span>
     <span class="kn">with</span>
       <span class="nn">Export</span>     <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span> <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">My_Func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Export</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">C</span><span class="p">,</span>
       <span class="n">External_Name</span> <span class="p">=&gt;</span> <span class="s">&quot;my_func&quot;</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">C_API</span><span class="p">;</span>
</pre></div>
</div>
<p>The variable is then increment in <code class="docutils literal notranslate"><span class="pre">My_Func</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="c1">--% filename: c_api.adb</span>
<span class="kd">package</span> <span class="kd">body</span> <span class="nc">C_API</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">My_Func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">func_cnt</span> <span class="p">:=</span> <span class="n">func_cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kr">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">My_Func</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">C_API</span><span class="p">;</span>
</pre></div>
</div>
<p>In the C application, we just need to declare the variable and use it:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">func_cnt</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>

  <span class="kt">int</span> <span class="n">v</span><span class="p">;</span>

  <span class="n">v</span> <span class="o">=</span> <span class="n">my_func</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">my_func</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">my_func</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Result is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Function was called %d times</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">func_cnt</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Again, by running the application, we see that the value from the counter
will contain the correct number of times that <code class="docutils literal notranslate"><span class="pre">my_func</span></code> was called.</p>
</div>
</div>
<div class="section" id="generating-bindings">
<h2>Generating bindings<a class="headerlink" href="#generating-bindings" title="Permalink to this headline">¶</a></h2>
<p>In the examples above, we have manually created the Ada bindings for the
C source-code we wanted to interface with. It is possible to automate this
process by using the <em>Ada spec dump</em> compiler option:
<code class="docutils literal notranslate"><span class="pre">-fdump-ada-spec</span></code>. We’ll discuss details by revisiting our previous
example.</p>
<p>This was the C header file that we had:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span> <span class="kt">int</span> <span class="n">func_cnt</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>In order to create bindings, we’ll call the compiler like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>gcc -c -fdump-ada-spec -C ./test.h
</pre></div>
</div>
<p>This will create an Ada specification file called <code class="docutils literal notranslate"><span class="pre">test_h.ads</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma</span> <span class="cp">Ada_2005</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Style_Checks</span> <span class="p">(</span><span class="n">Off</span><span class="p">);</span>

<span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">test_h</span> <span class="kr">is</span>

   <span class="n">func_cnt</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.h:3</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">func_cnt</span><span class="p">,</span> <span class="s">&quot;func_cnt&quot;</span><span class="p">);</span>

   <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.h:5</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">my_func</span><span class="p">,</span> <span class="s">&quot;my_func&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">test_h</span><span class="p">;</span>
</pre></div>
</div>
<p>Now, we can simply refer to <code class="docutils literal notranslate"><span class="pre">test_h</span></code> package in the Ada application:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">test_h</span><span class="p">;</span>       <span class="kn">use</span> <span class="nn">test_h</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_C_Func</span> <span class="kr">is</span>
   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">3</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Function was called &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">func_cnt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; times&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_C_Func</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that, in addition to <code class="docutils literal notranslate"><span class="pre">fdump-ada-spec</span></code>, you can also specify the
parent unit for the bindings you’re creating. For example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>gcc -c -fdump-ada-spec -fada-spec-parent<span class="o">=</span>Ext_C_Code -C ./test.h
</pre></div>
</div>
<p>This will create the file <code class="docutils literal notranslate"><span class="pre">ext_c_code-test_h.ads</span></code>:</p>
<div class="ada-syntax-only highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Ext_C_Code.test_h</span> <span class="kr">is</span>

   <span class="c1">-- automatic generated bindings...</span>

<span class="kr">end</span> <span class="nf">Ext_C_Code.test_h</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="adapting-bindings">
<h3>Adapting bindings<a class="headerlink" href="#adapting-bindings" title="Permalink to this headline">¶</a></h3>
<p>When creating bindings for a C header file, the compiler tries to do the
best guess it can. However, the generated bindings do not always match the
expectations we might have. This can happen, for example, when creating
bindings for functions that deal with pointers. In this case, the compiler
may just use <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">System</span></span><span class="punctuation"><span class="pre">.</span></span><span class="keyword type"><span class="pre">Address</span></span></code> for the pointers. Although this approach
works fine (as we’ll see later), this is not necessarily how developers
would interpret the C header file. The following example will clarify this
problem.</p>
<p>Let’s start with the following C header file:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*% filename: test.h */</span>

<span class="k">struct</span> <span class="n">test</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">test</span> <span class="o">*</span> <span class="nf">test_create</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">test_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">test_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">test_set_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">test_set_address</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">address</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">test_display</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">);</span>
</pre></div>
</div>
<p>This is the corresponding implementation:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;test.h&quot;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">test</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">80</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">address</span><span class="p">[</span><span class="mi">120</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">size_t</span>
<span class="nf">strlcpy</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">dstsize</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">size_t</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">src</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dstsize</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">size_t</span> <span class="n">bl</span> <span class="o">=</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="n">dstsize</span><span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="nl">len</span> <span class="p">:</span> <span class="n">dstsize</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">bl</span><span class="p">))[</span><span class="n">bl</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">test</span> <span class="o">*</span> <span class="nf">test_create</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">malloc</span> <span class="p">(</span><span class="k">sizeof</span> <span class="p">(</span><span class="k">struct</span> <span class="n">test</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">free</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">t</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
  <span class="n">t</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_set_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">strlcpy</span><span class="p">(</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_set_address</span><span class="p">(</span><span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">address</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">strlcpy</span><span class="p">(</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_display</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">test</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Name:    %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Address: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, we’ll create our bindings by running gcc:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>gcc -c -fdump-ada-spec -C ./test.h
</pre></div>
</div>
<p>This creates the following specification in <code class="docutils literal notranslate"><span class="pre">test_h.ads</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma</span> <span class="cp">Ada_2005</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Style_Checks</span> <span class="p">(</span><span class="n">Off</span><span class="p">);</span>

<span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">System</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">test_h</span> <span class="kr">is</span>

   <span class="c1">--  skipped empty struct test</span>

   <span class="kd">function</span> <span class="nf">test_create</span> <span class="nf">return</span> <span class="nf">System</span><span class="p">.</span><span class="nf">Address</span><span class="p">;</span>  <span class="c1">-- ./test.h:5</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_create</span><span class="p">,</span> <span class="s">&quot;test_create&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">test_destroy</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">System</span><span class="p">.</span><span class="nv">Address</span><span class="p">);</span>  <span class="c1">-- ./test.h:7</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_destroy</span><span class="p">,</span> <span class="s">&quot;test_destroy&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">test_reset</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">System</span><span class="p">.</span><span class="nv">Address</span><span class="p">);</span>  <span class="c1">-- ./test.h:9</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_reset</span><span class="p">,</span> <span class="s">&quot;test_reset&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">test_set_name</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">System</span><span class="p">.</span><span class="nv">Address</span><span class="p">;</span> <span class="nv">arg2</span> <span class="p">: </span><span class="nv">Interfaces</span><span class="p">.</span><span class="nv">C</span><span class="p">.</span><span class="nv">Strings</span><span class="p">.</span><span class="nv">chars_ptr</span><span class="p">);</span>  <span class="c1">-- ./test.h:11</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_set_name</span><span class="p">,</span> <span class="s">&quot;test_set_name&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">test_set_address</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">System</span><span class="p">.</span><span class="nv">Address</span><span class="p">;</span> <span class="nv">arg2</span> <span class="p">: </span><span class="nv">Interfaces</span><span class="p">.</span><span class="nv">C</span><span class="p">.</span><span class="nv">Strings</span><span class="p">.</span><span class="nv">chars_ptr</span><span class="p">);</span>  <span class="c1">-- ./test.h:13</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_set_address</span><span class="p">,</span> <span class="s">&quot;test_set_address&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">test_display</span> <span class="p">(</span><span class="nv">arg1</span> <span class="p">: </span><span class="nv">System</span><span class="p">.</span><span class="nv">Address</span><span class="p">);</span>  <span class="c1">-- ./test.h:15</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">test_display</span><span class="p">,</span> <span class="s">&quot;test_display&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">test_h</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see, the bindings generator completely ignores the specification
of <code class="code c docutils literal notranslate"><span class="keyword"><span class="pre">struct</span></span> <span class="name"><span class="pre">test</span></span></code>. Also, all references to the <code class="docutils literal notranslate"><span class="pre">test</span></code> are replaced by
simple addresses (<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">System</span></span><span class="punctuation"><span class="pre">.</span></span><span class="keyword type"><span class="pre">Address</span></span></code>). Of course, these bindings are good
enough for creating a test application in Ada:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span>         <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>          <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">test_h</span><span class="p">;</span>               <span class="kn">use</span> <span class="nn">test_h</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">System</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Automatic_C_Struct_Bindings</span> <span class="kr">is</span>

   <span class="no">Name</span>    <span class="p">:</span> <span class="kr">constant</span> <span class="n">chars_ptr</span> <span class="p">:=</span> <span class="n">New_String</span> <span class="p">(</span><span class="s">&quot;John Doe&quot;</span><span class="p">);</span>
   <span class="kt">Address</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">chars_ptr</span> <span class="p">:=</span> <span class="n">New_String</span> <span class="p">(</span><span class="s">&quot;Small Town&quot;</span><span class="p">);</span>

   <span class="n">T</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="kt">Address</span> <span class="p">:=</span> <span class="n">test_create</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">test_reset</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">test_set_name</span> <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Name</span><span class="p">);</span>
   <span class="n">test_set_address</span> <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="kt">Address</span><span class="p">);</span>

   <span class="n">test_display</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">test_destroy</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Automatic_C_Struct_Bindings</span><span class="p">;</span>
</pre></div>
</div>
<p>Even though we can successfully bind our C code with Ada using the
automatic generated bindings, they are not ideal. Instead, we would like
to have Ada bindings that match our (human) interpretation of the C header
file. This will require manual analysis of the header file. The good news
are that, at least, we can use the automatic generated bindings as a
starting point and adapt them to our needs. For example, we can:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Define a <code class="docutils literal notranslate"><span class="pre">Test</span></code> type based on <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">System</span></span><span class="punctuation"><span class="pre">.</span></span><span class="keyword type"><span class="pre">Address</span></span></code> and use it in
all relevant function.</li>
<li>Remove the <code class="docutils literal notranslate"><span class="pre">test_</span></code> prefix in all operations on the <code class="docutils literal notranslate"><span class="pre">Test</span></code>
type.</li>
</ol>
</div></blockquote>
<p>This would be the resulting specification:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">System</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">adapted_test_h</span> <span class="kr">is</span>

   <span class="kd">type</span> <span class="kt">Test</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">System</span><span class="p">.</span><span class="kt">Address</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Create</span> <span class="nf">return</span> <span class="nf">Test</span><span class="p">;</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Create</span><span class="p">,</span> <span class="s">&quot;test_create&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Destroy</span> <span class="p">(</span><span class="nv">T</span> <span class="p">: </span><span class="nv">Test</span><span class="p">);</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Destroy</span><span class="p">,</span> <span class="s">&quot;test_destroy&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Reset</span> <span class="p">(</span><span class="nv">T</span> <span class="p">: </span><span class="nv">Test</span><span class="p">);</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Reset</span><span class="p">,</span> <span class="s">&quot;test_reset&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set_Name</span> <span class="p">(</span><span class="nv">T</span>    <span class="p">: </span><span class="nv">Test</span><span class="p">;</span>
                       <span class="nv">Name</span> <span class="p">: </span><span class="nv">Interfaces</span><span class="p">.</span><span class="nv">C</span><span class="p">.</span><span class="nv">Strings</span><span class="p">.</span><span class="nv">chars_ptr</span><span class="p">);</span>  <span class="c1">-- ./test.h:11</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Set_Name</span><span class="p">,</span> <span class="s">&quot;test_set_name&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Set_Address</span> <span class="p">(</span><span class="nv">T</span>       <span class="p">: </span><span class="nv">Test</span><span class="p">;</span>
                          <span class="nv">Address</span> <span class="p">: </span><span class="nv">Interfaces</span><span class="p">.</span><span class="nv">C</span><span class="p">.</span><span class="nv">Strings</span><span class="p">.</span><span class="nv">chars_ptr</span><span class="p">);</span>  <span class="c1">-- ./test.h:13</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Set_Address</span><span class="p">,</span> <span class="s">&quot;test_set_address&quot;</span><span class="p">);</span>

   <span class="kd">procedure</span> <span class="nf">Display</span> <span class="p">(</span><span class="nv">T</span> <span class="p">: </span><span class="nv">Test</span><span class="p">);</span>  <span class="c1">-- ./test.h:15</span>
   <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Display</span><span class="p">,</span> <span class="s">&quot;test_display&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">adapted_test_h</span><span class="p">;</span>
</pre></div>
</div>
<p>This would be the corresponding Ada application:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span>         <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C.Strings</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>          <span class="kn">use</span>  <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">adapted_test_h</span><span class="p">;</span>       <span class="kn">use</span>  <span class="nn">adapted_test_h</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">System</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Adapted_C_Struct_Bindings</span> <span class="kr">is</span>

   <span class="no">Name</span>    <span class="p">:</span> <span class="kr">constant</span> <span class="n">chars_ptr</span> <span class="p">:=</span> <span class="n">New_String</span> <span class="p">(</span><span class="s">&quot;John Doe&quot;</span><span class="p">);</span>
   <span class="kt">Address</span> <span class="p">:</span> <span class="kr">constant</span> <span class="n">chars_ptr</span> <span class="p">:=</span> <span class="n">New_String</span> <span class="p">(</span><span class="s">&quot;Small Town&quot;</span><span class="p">);</span>

   <span class="n">T</span> <span class="p">:</span> <span class="n">Test</span> <span class="p">:=</span> <span class="n">Create</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">Reset</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">Set_Name</span> <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Name</span><span class="p">);</span>
   <span class="n">Set_Address</span> <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="kt">Address</span><span class="p">);</span>

   <span class="n">Display</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">Destroy</span> <span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Adapted_C_Struct_Bindings</span><span class="p">;</span>
</pre></div>
</div>
<p>Now, we’re able to use the <code class="docutils literal notranslate"><span class="pre">Test</span></code> type and its operations in a clean,
readable way.</p>
</div>
</div>
<div class="section" id="interfacing-with-c">
<h2>Interfacing with C++<a class="headerlink" href="#interfacing-with-c" title="Permalink to this headline">¶</a></h2>
<p>All the previous examples focused on interfacing with C code. For C++, the
same methods apply. However, there are a few differences that we need to
take into account:</p>
<ul class="simple">
<li>When importing or exporting variables and subprograms, we replace ‘C’
by ‘Cpp’ in the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Convention</span></span></code> aspect of their declaration.</li>
<li>In the project file for <code class="docutils literal notranslate"><span class="pre">gprbuild</span></code>, we replace ‘C’ by ‘C++’ in the
<code class="docutils literal notranslate"><span class="pre">Languages</span></code> entry.</li>
</ul>
<p>There are other aspects specific to C++ that we also have to take into
account. This section will discuss them.</p>
<div class="section" id="c-symbol-mangling">
<h3>C++ symbol mangling<a class="headerlink" href="#c-symbol-mangling" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by adapting a previous example and <em>converting</em> it to C++
(actually, mainly just replacing the C compiler by a C++ compiler). The
header file is still basically the same:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span> <span class="kt">int</span> <span class="n">func_cnt</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
<p>And this is the corresponding implementation:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;test.hh&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="n">func_cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">func_cnt</span><span class="o">++</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the Ada application, as mentioned before, we need to replace ‘C’ by
‘Cpp’ in the <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Convention</span></span></code> of the declarations:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Cpp_Func</span> <span class="kr">is</span>

   <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">Cpp</span><span class="p">,</span>
       <span class="n">External_Name</span> <span class="p">=&gt;</span> <span class="s">&quot;_Z7my_funci&quot;</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>

   <span class="n">func_cnt</span> <span class="p">:</span> <span class="n">int</span>
     <span class="kn">with</span>
       <span class="nn">Import</span>        <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
       <span class="n">Convention</span>    <span class="p">=&gt;</span> <span class="n">Cpp</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="mi">3</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Function was called &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">func_cnt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; times&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Cpp_Func</span><span class="p">;</span>
</pre></div>
</div>
<p>Also, in the declaration of <code class="docutils literal notranslate"><span class="pre">my_func</span></code>, we need to include a reference to
the original name using <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">External_Name</span></span></code>. If we leave this out, the
linker won’t be able to find the original implementation of <code class="docutils literal notranslate"><span class="pre">my_func</span></code>,
so it won’t build the application. Note that the function name is not
<code class="docutils literal notranslate"><span class="pre">my_func</span></code> anymore (as it was the case for the C version). Instead, it is
now called <code class="docutils literal notranslate"><span class="pre">_Z7my_funci</span></code>.  This situation is caused by symbol mangling.</p>
<p>In C, the symbol names in object files match the symbol name in the
source-code. In C++, due to symbol mangling, the symbol names of
subprograms in the object files are different from the corresponding
source-code implementation. Also, because symbol mangling is not
standardized, different compilers might use different methods. The most
prominent example is the difference between the gcc and MSVC compilers.
However, since GNAT is based on gcc, we can build applications using Ada
and C++ code without issues — as long as we use the same compiler.</p>
<p>In order to retrieved the mangled symbol names, we can simply generate
bindings automatically by using <code class="docutils literal notranslate"><span class="pre">g++</span></code> with the <code class="docutils literal notranslate"><span class="pre">-fdump-ada-spec</span></code>
option:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>g++ -c -fdump-ada-spec -C ./test.hh
</pre></div>
</div>
<p>Alternatively, we could use binary examination tools to retrieve the
symbol names from a library. Examples of such tools are <code class="docutils literal notranslate"><span class="pre">nm</span></code> for Mac and
Linux, and <code class="docutils literal notranslate"><span class="pre">dumpbin.exe</span></code> for Windows.</p>
</div>
<div class="section" id="c-classes">
<h3>C++ classes<a class="headerlink" href="#c-classes" title="Permalink to this headline">¶</a></h3>
<p>We’ll now focus on binding object-oriented features of C++ into Ada.
Let’s adapt the previous example to make use of classes. This is adapted
header file:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span> <span class="n">Test</span> <span class="p">{</span>
<span class="nl">public</span><span class="p">:</span>
  <span class="n">Test</span><span class="p">();</span>
  <span class="kt">int</span> <span class="nf">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">);</span>
  <span class="kt">int</span> <span class="nf">get_cnt</span><span class="p">();</span>
<span class="nl">private</span><span class="p">:</span>
  <span class="kt">int</span> <span class="n">func_cnt</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>And this is the corresponding implementation:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;test.hh&quot;</span><span class="cp"></span>

<span class="n">Test</span><span class="o">::</span><span class="n">Test</span><span class="p">()</span> <span class="o">:</span>
  <span class="n">func_cnt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">};</span>

<span class="kt">int</span>
<span class="n">Test</span><span class="o">::</span><span class="n">my_func</span> <span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">func_cnt</span><span class="o">++</span><span class="p">;</span>

  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="n">Test</span><span class="o">::</span><span class="n">get_cnt</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">func_cnt</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Because of the more complex structure, the recommendation is to generate
bindings using <code class="docutils literal notranslate"><span class="pre">g++</span></code> and, if needed, adapt the file. Let’s first run
<code class="docutils literal notranslate"><span class="pre">g++</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>g++ -c -fdump-ada-spec -C ./test.hh
</pre></div>
</div>
<p>The generated bindings look like this:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma</span> <span class="cp">Ada_2005</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Style_Checks</span> <span class="p">(</span><span class="n">Off</span><span class="p">);</span>

<span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">test_hh</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Class_Test</span> <span class="kr">is</span>
      <span class="kd">type</span> <span class="kt">Test</span> <span class="kr">is</span> <span class="kr">limited</span> <span class="kr">record</span>
         <span class="n">func_cnt</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:7</span>
      <span class="kr">end record</span><span class="p">;</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">Test</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">New_Test</span> <span class="nf">return</span> <span class="nf">Test</span><span class="p">;</span>  <span class="c1">-- ./test.hh:3</span>
      <span class="kr">pragma</span> <span class="cp">CPP_Constructor</span> <span class="p">(</span><span class="n">New_Test</span><span class="p">,</span> <span class="s">&quot;_ZN4TestC1Ev&quot;</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">this</span> <span class="p">: </span><span class="nv">access</span> <span class="nv">Test</span><span class="p">;</span> <span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:4</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">my_func</span><span class="p">,</span> <span class="s">&quot;_ZN4Test7my_funcEi&quot;</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">get_cnt</span> <span class="p">(</span><span class="nv">this</span> <span class="p">: </span><span class="nv">access</span> <span class="nv">Test</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:5</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">get_cnt</span><span class="p">,</span> <span class="s">&quot;_ZN4Test7get_cntEv&quot;</span><span class="p">);</span>
   <span class="kr">end</span><span class="p">;</span>
   <span class="kn">use</span> <span class="nn">Class_Test</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">test_hh</span><span class="p">;</span>
</pre></div>
</div>
<p>As we can see, the original C++ class (<code class="docutils literal notranslate"><span class="pre">Test</span></code>) is represented as a
nested package (<code class="docutils literal notranslate"><span class="pre">test_hh.Class_Test</span></code>) in the Ada bindings.</p>
<p>The Ada application can then use the bindings:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">test_hh</span><span class="p">;</span>      <span class="kn">use</span> <span class="nn">test_hh</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Cpp_Class</span> <span class="kr">is</span>
   <span class="kn">use</span> <span class="nn">Class_Test</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>

   <span class="n">T</span>  <span class="p">:</span> <span class="kr">aliased</span> <span class="n">Test</span> <span class="p">:=</span> <span class="n">New_Test</span><span class="p">;</span>
   <span class="n">TA</span> <span class="p">:</span> <span class="kr">access</span> <span class="n">Test</span> <span class="p">:=</span> <span class="n">T</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="n">TA</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="n">TA</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">my_func</span> <span class="p">(</span><span class="n">TA</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Function was called &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">get_cnt</span> <span class="p">(</span><span class="n">TA</span><span class="p">))</span> <span class="o">&amp;</span> <span class="s">&quot; times&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Cpp_Class</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that, in the Ada application, we cannot use the prefixed notation.
This notation would be more similar to the corresponding syntax in C++.
This restriction is caused by the fact that the automatic generated
bindings don’t use tagged types. However, if we adapt the declaration of
<code class="docutils literal notranslate"><span class="pre">Test</span></code> and replace it by <code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">Test</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword reserved"><span class="pre">record</span></span> <span class="punctuation"><span class="pre">…</span></span></code>,
we’ll be able to write <code class="docutils literal notranslate"><span class="pre">TA.my_func(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">TA.get_cnt</span></code> in our
application.</p>
<p>Another correction we might want to make is in the visibility of the
<code class="docutils literal notranslate"><span class="pre">Test</span></code> record. In the original C++ class, the <code class="docutils literal notranslate"><span class="pre">func_cnt</span></code> element was
declared in the private part of the <code class="docutils literal notranslate"><span class="pre">Test</span></code> class. However, in the
generated bindings, this element has been exposed, so it could be accessed
directly in our application. In order to correct that, we can simply move
the type declaration to the private part of the <code class="docutils literal notranslate"><span class="pre">Class_Test</span></code> package and
indicate that in the public part of the package (by using
<code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">Test</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code>).</p>
<p>After these adaptations, we get the following bindings:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma</span> <span class="cp">Ada_2005</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Style_Checks</span> <span class="p">(</span><span class="n">Off</span><span class="p">);</span>

<span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">package</span> <span class="nc">test_hh</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Class_Test</span> <span class="kr">is</span>
      <span class="kd">type</span> <span class="kt">Test</span> <span class="kr">is</span> <span class="kr">tagged</span> <span class="kr">limited</span> <span class="kd">private</span><span class="p">;</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">Test</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">New_Test</span> <span class="nf">return</span> <span class="nf">Test</span><span class="p">;</span>  <span class="c1">-- ./test.hh:3</span>
      <span class="kr">pragma</span> <span class="cp">CPP_Constructor</span> <span class="p">(</span><span class="n">New_Test</span><span class="p">,</span> <span class="s">&quot;_ZN4TestC1Ev&quot;</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">my_func</span> <span class="p">(</span><span class="nv">this</span> <span class="p">: </span><span class="nv">access</span> <span class="nv">Test</span><span class="p">;</span> <span class="nv">a</span> <span class="p">: </span><span class="nv">int</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:4</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">my_func</span><span class="p">,</span> <span class="s">&quot;_ZN4Test7my_funcEi&quot;</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nf">get_cnt</span> <span class="p">(</span><span class="nv">this</span> <span class="p">: </span><span class="nv">access</span> <span class="nv">Test</span><span class="p">)</span> <span class="kr">return</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:5</span>
      <span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">CPP</span><span class="p">,</span> <span class="n">get_cnt</span><span class="p">,</span> <span class="s">&quot;_ZN4Test7get_cntEv&quot;</span><span class="p">);</span>
   <span class="kd">private</span>
      <span class="kd">type</span> <span class="kt">Test</span> <span class="kr">is</span> <span class="kr">tagged</span> <span class="kr">limited</span> <span class="kr">record</span>
         <span class="n">func_cnt</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="n">int</span><span class="p">;</span>  <span class="c1">-- ./test.hh:7</span>
      <span class="kr">end record</span><span class="p">;</span>
   <span class="kr">end</span><span class="p">;</span>
   <span class="kn">use</span> <span class="nn">Class_Test</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">test_hh</span><span class="p">;</span>
</pre></div>
</div>
<p>And this is the adapted Ada application:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Interfaces.C</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>  <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">test_hh</span><span class="p">;</span>      <span class="kn">use</span> <span class="nn">test_hh</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Cpp_Class</span> <span class="kr">is</span>
   <span class="kn">use</span> <span class="nn">Class_Test</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">int</span><span class="p">;</span>

   <span class="n">T</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="n">Test</span> <span class="p">:=</span> <span class="n">New_Test</span><span class="p">;</span>
   <span class="n">TA</span> <span class="p">:</span> <span class="kr">access</span> <span class="n">Test</span> <span class="p">:=</span> <span class="n">T</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">;</span>

<span class="kr">begin</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">TA</span><span class="p">.</span><span class="n">my_func</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">TA</span><span class="p">.</span><span class="n">my_func</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">V</span> <span class="p">:=</span> <span class="n">TA</span><span class="p">.</span><span class="n">my_func</span> <span class="p">(</span><span class="mi">3</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Result is &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">));</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Function was called &quot;</span> <span class="o">&amp;</span> <span class="n">int</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">TA</span><span class="p">.</span><span class="n">get_cnt</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; times&quot;</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Cpp_Class</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="object-oriented-programming">
<h1>Object oriented programming<a class="headerlink" href="#object-oriented-programming" title="Permalink to this headline">¶</a></h1>
<p>Object oriented programming is a large and blurrily defined concept in
programming languages that tends to encompass many different things. This is
due to the fact that many different languages implemented their own vision of
it, with similarities and differences.</p>
<p>However, there is a model that mostly “won” the battle of what object oriented
means, if only by sheer popularity. It’s the model of the Java programming
language, which is very similar to the one of the C++ language. Here are some
defining characteristics:</p>
<ul class="simple">
<li>Type derivation and extension: Most object oriented languages allow the user
to add fields to derived types.</li>
<li>Subtyping: Objects of a type derived from a base type are, in some instances,
substitutable to objects from the base type - in terms of static typing.</li>
<li>Runtime polymorphism: Calling a subprogram attached to an object type, which
is usually called a method, can dispatch at runtime depending on the exact
type of the object.</li>
<li>Encapsulation: Objects can hide some of their data.</li>
<li>Extensibility: People from the “outside” - of your package, or even your
whole library - can derive from your object types, and define their own
behaviors.</li>
</ul>
<p>Ada predates the popularity of object orientation, and since it aimed to be a
complete language from the start, has many mechanisms and concepts to fullfill
the above requirements.</p>
<ul class="simple">
<li>As we saw, encapsulation is not implemented at the type level in Ada, but at
the package level.</li>
<li>Subtyping can be implemented using, well, subtypes, which have a full and
permissive static substitability model. The substitution will fail at runtime
if the dynamic constraints of the subtype are not fulfilled.</li>
<li>Runtime polymorphism can be implemented using variant records.</li>
</ul>
<p>However, this lists leaves out type extension - if you don’t consider variant
records - and extensibility.</p>
<p>In the 1995 revision of Ada, a feature filling the gaps was added, so that
people can program following the object oriented paradigm in an easier fashion,
which is called tagged types.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is possible to program in Ada without ever creating tagged types. If
that’s your prefered style of programming, or you have no specific use for
tagged types, feel free to not use them, as for every feature of Ada.</p>
<p class="last">However, they can be the best way to express solutions to certain problems.
If that’s the case, read on!</p>
</div>
<div class="section" id="newtypes">
<h2>Newtypes<a class="headerlink" href="#newtypes" title="Permalink to this headline">¶</a></h2>
<p>Before going into tagged types, we should go into a topic we have brushed on,
but not really covered so far:</p>
<p>For every type in Ada, you can create a new type from it. Type derivation is
built-in into the language.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">Newtypes</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">Point</span> <span class="kr">is</span> <span class="kr">record</span>
       <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="kd">type</span> <span class="kt">New_Point</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Point</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Newtypes</span><span class="p">;</span>
</pre></div>
</div>
<p>It is useful to enforce strong typing, because the type system will treat the
two types as incompatible.</p>
<p>But it is not limited to that: You can inherit things from the type you derive
from. The representation of the data is one part, but you can also inherit
behavior.</p>
<p>When you inherit a type, what we call primitive operations are inherited. A
primitive is a subprogram attached to a type. Ada knows a primitive because it
is a subprogram defined in the same scope with the type.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>A subprogram will only become a primitive of the type if:</p>
<ol class="last arabic simple">
<li>The subprogram is declared in the same scope as the type</li>
<li>The type and its subprograms are declared in a package</li>
</ol>
</div>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Primitives</span> <span class="kr">is</span>
  <span class="kd">package</span> <span class="nc">Week</span> <span class="kr">is</span>
    <span class="kd">type</span> <span class="kt">Days</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Monday</span><span class="p">,</span> <span class="nv">Tuesday</span><span class="p">,</span> <span class="nv">Wednesday</span><span class="p">,</span> <span class="nv">Thursday</span><span class="p">,</span>
                  <span class="nv">Friday</span><span class="p">,</span> <span class="nv">Saturday</span><span class="p">,</span> <span class="nv">Sunday</span><span class="p">);</span>

     <span class="c1">--  Print day is a primitive of the type Days</span>
    <span class="kd">procedure</span> <span class="nf">Print_Day</span> <span class="p">(</span><span class="nv">D</span> <span class="p">: </span><span class="nv">Days</span><span class="p">);</span>
  <span class="kr">end</span> <span class="nf">Week</span><span class="p">;</span>

  <span class="kd">package</span> <span class="kd">body</span> <span class="nc">Week</span> <span class="kr">is</span>
    <span class="kd">procedure</span> <span class="nf">Print_Day</span> <span class="p">(</span><span class="nv">D</span> <span class="p">: </span><span class="nv">Days</span><span class="p">)</span> <span class="kr">is</span>
    <span class="kr">begin</span>
       <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Days</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">D</span><span class="p">));</span>
    <span class="kr">end</span> <span class="nf">Print_Day</span><span class="p">;</span>
  <span class="kr">end</span> <span class="nf">Week</span><span class="p">;</span>

  <span class="kn">use</span> <span class="nn">Week</span><span class="p">;</span>
  <span class="kd">type</span> <span class="kt">Weekend_Days</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Days</span> <span class="kr">range</span> <span class="n">Saturday</span> <span class="p">..</span> <span class="n">Sunday</span><span class="p">;</span>

  <span class="c1">--  A procedure Print_Day is automatically inherited here. It is like</span>
  <span class="c1">--  the procedure</span>
  <span class="c1">--</span>
  <span class="c1">--  procedure Print_Day (D : Weekend_Days);</span>
  <span class="c1">--</span>
  <span class="c1">--  Has been declared</span>

  <span class="n">Sat</span> <span class="p">:</span> <span class="n">Weekend_Days</span> <span class="p">:=</span> <span class="n">Saturday</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Print_Day</span> <span class="p">(</span><span class="n">Sat</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Primitives</span><span class="p">;</span>
</pre></div>
</div>
<p>While this kind of inheritance can be very useful, and has the advantage of not
being limited to record types (you can use it on discrete types as in the
example above), it is only superficially similar to object oriented
inheritance:</p>
<ul class="simple">
<li>Records cannot be extended this way. In general, it is imposible to specify a
new representation for the new type, it will <strong>always</strong> have the same
representation as the base type.</li>
<li>There is no facility for dynamic dispatch or polymorphism. Objects are of a
fixed, static type.</li>
</ul>
<p>The differences are more numerous, but it is not very useful to list them here.
Just remember that this is a kind of inheritance you can use if you just want
to statically inherit behavior without duplicating code or using composition,
but that you cannot use if you want any dynamic features that we usually
associate with OOP.</p>
</div>
<div class="section" id="tagged-types">
<h2>Tagged types<a class="headerlink" href="#tagged-types" title="Permalink to this headline">¶</a></h2>
<p>In the 1995 revision of the Ada language, tagged types were introduced to
fullfil the need for an unified solution to program in an object oriented style
similar to the one described at the beginning of this section.</p>
<p>Tagged types are much like regular records, except that some functionalities are
added:</p>
<ul class="simple">
<li>Types have a tag, that is stored inside instances, and that identifies the
<a class="reference external" href="https://fr.wikipedia.org/wiki/Run-time_type_information">runtime type</a> of
an object.</li>
<li>Primitives can dispatch. A primitive on a tagged type is what you would call
a method in Java or C++. If you derive a base type, and override a primitive
of it, then in some instances it will be possible to call it on an object
such that which primitive is called depends on the exact runtime type of the
object.</li>
<li>Subtyping rules are introduced, such that a tagged type derived from a base
type is statically compatible with the base type.</li>
</ul>
<p>Let’s see our first tagged type declaration:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">P</span> <span class="kr">is</span>
   <span class="kd">type</span> <span class="kt">My_Class</span> <span class="kr">is</span> <span class="kr">tagged</span> <span class="kr">null record</span><span class="p">;</span>
   <span class="c1">--  Just like a regular record, but with tagged qualifier</span>

   <span class="c1">--  Methods are outside of the type definition:</span>

   <span class="kd">procedure</span> <span class="nf">Foo</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">My_Class</span><span class="p">);</span>
   <span class="c1">--  If you define a procedure taking a My_Class argument,</span>
   <span class="c1">--  in the same package, it will be a method.</span>

   <span class="c1">--  Here is how you derive a tagged type:</span>

   <span class="kd">type</span> <span class="kt">Derived</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">My_Class</span> <span class="kr">with</span> <span class="kr">record</span>
       <span class="n">A</span> <span class="p">:</span> <span class="kt">Integer</span><span class="p">;</span>
       <span class="c1">--  You can add field in derived types.</span>
   <span class="kr">end record</span><span class="p">;</span>

   <span class="kr">overriding</span> <span class="kd">procedure</span> <span class="nf">Foo</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Derived</span><span class="p">);</span>
   <span class="c1">--  Overriding qualifier is optional, but if it is here,</span>
   <span class="c1">--  it must be valid.</span>
<span class="kr">end</span> <span class="nf">P</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">package</span> <span class="kd">body</span> <span class="nc">P</span> <span class="kr">is</span>
   <span class="kd">procedure</span> <span class="nf">Foo</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">My_Class</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In My_Class.Foo&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Foo</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Foo</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Derived</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;In Derived.Foo, A = &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Self</span><span class="p">.</span><span class="n">A</span><span class="p">));</span>
   <span class="kr">end</span> <span class="nf">Foo</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">P</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="classwide-types">
<h2>Classwide types<a class="headerlink" href="#classwide-types" title="Permalink to this headline">¶</a></h2>
<p>In order to stay coherent with the rest of the language, a new notation needs
to be introduced to be able to say: This object is of this type or any
descendent tagged type.</p>
<p>In Ada, this is called the classwide type. It is used in object oriented
programming as soon as you need polymorphism. For example, you cannot do the
following:</p>
<div class="ada-expect-compile-error highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>

   <span class="n">O1</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">;</span>
   <span class="c1">--  Declaring an object of type My_Class</span>

   <span class="n">O2</span> <span class="p">:</span> <span class="n">Derived</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">12</span><span class="p">);</span>
   <span class="c1">--  Declaring an object of type Derived</span>

   <span class="n">O3</span> <span class="p">:</span> <span class="n">My_Class</span> <span class="p">:=</span> <span class="n">O2</span><span class="p">;</span>
   <span class="c1">--  INVALID: Trying to assign a value of type derived to a variable of</span>
   <span class="c1">--  type My_Class.</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>Because, with tagged types as with other types, an object of a type <code class="docutils literal notranslate"><span class="pre">T</span></code> is
exactly of the type <code class="docutils literal notranslate"><span class="pre">T</span></code>. What you want to say as a programmer is “I want O3
to be able to hold an object of type <code class="docutils literal notranslate"><span class="pre">My_Class</span></code>, or any type descending from
<code class="docutils literal notranslate"><span class="pre">My_Class</span></code>”. Here is how you do that:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">O1</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">;</span>
   <span class="c1">--  Declaring an object of type My_Class</span>

   <span class="n">O2</span> <span class="p">:</span> <span class="n">Derived</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">12</span><span class="p">);</span>
   <span class="c1">--  Declaring an object of type Derived</span>

   <span class="n">O3</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O2</span><span class="p">;</span>
   <span class="c1">--  Now valid: My_Class&#39;Class designates the classwide type for</span>
   <span class="c1">--  My_Class, which is the set of all types descending from My_Class</span>
   <span class="c1">--  (including My_Class).</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>An object of a classwide type is hence of an unknown size, since it can be of
the size of any descendent of the base type. It is thus an indefinite type,
with the expected corollaries:</p>
<blockquote class="last">
<div><ul class="simple">
<li>It cannot be stored as a field/component of a record</li>
<li>An object of a classwide type needs to be initialized right away (you
cannot specify the constraints of the type in this case by any other
way than by initializing it).</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="dispatching-operations">
<h2>Dispatching operations<a class="headerlink" href="#dispatching-operations" title="Permalink to this headline">¶</a></h2>
<p>We saw above that it is possible to override operations in types derived from
another tagged type. The aim eventually is to be able to make a dispatching
call, that is, a call to the primitive/method that depends on the exact type of
the object.</p>
<p>But, if you think carefully about what is stated in the above paragraph, a
variable of type <code class="docutils literal notranslate"><span class="pre">My_Class</span></code> will always contain an object of exactly this
type. If you want to have a variable that can contain a <code class="docutils literal notranslate"><span class="pre">My_Class</span></code> or
any derived type, it has to be of type <code class="docutils literal notranslate"><span class="pre">My_Class'Class</span></code>.</p>
<p>It follows that, to make a dispatching call, you first have to have an object
that can be of a type, or any type derived from this type, that is, a classwide
type.</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">O1</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">;</span>
   <span class="c1">--  Declaring an object of type My_Class</span>

   <span class="n">O2</span> <span class="p">:</span> <span class="n">Derived</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">12</span><span class="p">);</span>
   <span class="c1">--  Declaring an object of type Derived</span>

   <span class="n">O3</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O2</span><span class="p">;</span>

   <span class="n">O4</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O1</span><span class="p">);</span>
   <span class="c1">--  Non dispatching: Calls My_Class.Foo</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O2</span><span class="p">);</span>
   <span class="c1">--  Non dispatching: Calls Derived.Foo</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O3</span><span class="p">);</span>
   <span class="c1">--  Dispatching: Calls Derived.Foo</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O4</span><span class="p">);</span>
   <span class="c1">--  Dispatching: Calls My_Class.Foo</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>It is possible to convert an object of type <code class="docutils literal notranslate"><span class="pre">Derived</span></code> to an object of
type <code class="docutils literal notranslate"><span class="pre">My_Class</span></code>. This is called a view conversion in Ada parlance, and is
useful, if you want to call a parent method for example.</p>
<p>In that case, the object is really converted to a <code class="docutils literal notranslate"><span class="pre">My_Class</span></code> object,
which means that its tag is changed. Since tagged objects are always passed
by reference, you can use this kind of conversion to modify the state of an
object: Mutations of the converted object will affect the original one.</p>
<div class="ada-run last highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">O1</span> <span class="p">:</span> <span class="n">Derived</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">12</span><span class="p">);</span>
   <span class="c1">--  Declaring an object of type Derived</span>

   <span class="n">O2</span> <span class="p">:</span> <span class="n">My_Class</span> <span class="p">:=</span> <span class="n">My_Class</span> <span class="p">(</span><span class="n">O1</span><span class="p">);</span>

   <span class="n">O3</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O2</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O1</span><span class="p">);</span>
   <span class="c1">--  Non dispatching: Calls Derived.Foo</span>
   <span class="n">Foo</span> <span class="p">(</span><span class="n">O2</span><span class="p">);</span>
   <span class="c1">--  Non dispatching: Calls My_Class.Foo</span>

   <span class="n">Foo</span> <span class="p">(</span><span class="n">O3</span><span class="p">);</span>
   <span class="c1">--  Dispatching: Calls My_Class.Foo</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dot-notation">
<h2>Dot notation<a class="headerlink" href="#dot-notation" title="Permalink to this headline">¶</a></h2>
<p>Primitives of tagged types can be called with a notation that is more familiar
to object oriented programmers. Given the Foo primitive above, you can also
write the above program as such:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="n">O1</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">;</span>
   <span class="c1">--  Declaring an object of type My_Class</span>

   <span class="n">O2</span> <span class="p">:</span> <span class="n">Derived</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">12</span><span class="p">);</span>
   <span class="c1">--  Declaring an object of type Derived</span>

   <span class="n">O3</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O2</span><span class="p">;</span>

   <span class="n">O4</span> <span class="p">:</span> <span class="n">My_Class</span><span class="p">&#39;</span><span class="na">Class</span> <span class="p">:=</span> <span class="n">O1</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">O1</span><span class="p">.</span><span class="n">Foo</span><span class="p">;</span>
   <span class="c1">--  Non dispatching: Calls My_Class.Foo</span>
   <span class="n">O2</span><span class="p">.</span><span class="n">Foo</span><span class="p">;</span>
   <span class="c1">--  Non dispatching: Calls Derived.Foo</span>
   <span class="n">O3</span><span class="p">.</span><span class="n">Foo</span><span class="p">;</span>
   <span class="c1">--  Dispatching: Calls Derived.Foo</span>
   <span class="n">O4</span><span class="p">.</span><span class="n">Foo</span><span class="p">;</span>
   <span class="c1">--  Dispatching: Calls My_Class.Foo</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
<p>If the dispatching parameter of a primitive is the first parameter, as is the
case in our examples, then you can call the primitive via the dot notation. Any
extra parameter will be passed normally:</p>
<div class="ada-run highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">P</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">P</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Main</span> <span class="kr">is</span>
   <span class="kd">package</span> <span class="nc">Extend</span> <span class="kr">is</span>
      <span class="kd">type</span> <span class="kt">D2</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Derived</span> <span class="kr">with</span> <span class="kr">null record</span><span class="p">;</span>

      <span class="kd">procedure</span> <span class="nf">Bar</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">D2</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Extend</span><span class="p">;</span>

   <span class="kd">package</span> <span class="kd">body</span> <span class="nc">Extend</span> <span class="kr">is</span>
      <span class="kd">procedure</span> <span class="nf">Bar</span> <span class="p">(</span><span class="nv">Self</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">D2</span><span class="p">;</span> <span class="nv">Val</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
      <span class="kr">begin</span>
         <span class="n">Self</span><span class="p">.</span><span class="n">A</span> <span class="p">:=</span> <span class="n">Self</span><span class="p">.</span><span class="n">A</span> <span class="o">+</span> <span class="n">Val</span><span class="p">;</span>
      <span class="kr">end</span> <span class="nf">Bar</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Extend</span><span class="p">;</span>

   <span class="kn">use</span> <span class="nn">Extend</span><span class="p">;</span>

   <span class="n">Obj</span> <span class="p">:</span> <span class="n">D2</span> <span class="p">:=</span> <span class="p">(</span><span class="n">A</span> <span class="p">=&gt;</span> <span class="mi">15</span><span class="p">);</span>
<span class="kr">begin</span>
   <span class="n">Obj</span><span class="p">.</span><span class="n">Bar</span> <span class="p">(</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">Obj</span><span class="p">.</span><span class="n">Foo</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Main</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="standard-library">
<h1>Standard library<a class="headerlink" href="#standard-library" title="Permalink to this headline">¶</a></h1>
<div class="section" id="standard-package">
<h2>Standard package<a class="headerlink" href="#standard-package" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="containers">
<h2>Containers<a class="headerlink" href="#containers" title="Permalink to this headline">¶</a></h2>
<p>Ada includes support for containers (such as vectors and sets) in its
standard library. This section presents an introduction to the topic. For
a list of all containers available in Ada, please refer to Appendix B.</p>
<div class="section" id="vectors">
<h3>Vectors<a class="headerlink" href="#vectors" title="Permalink to this headline">¶</a></h3>
<p>The following subsections present a general overview of vectors,
including instantiation, initialization, operations on vector elements
and operation on vectors.</p>
<div class="section" id="instantiation">
<h4>Instantiation<a class="headerlink" href="#instantiation" title="Permalink to this headline">¶</a></h4>
<p>The following example shows the instantiation and declaration of a vector
<code class="docutils literal notranslate"><span class="pre">V</span></code>:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Inst</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Integer_Vectors</span><span class="p">.</span><span class="n">Vector</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="kc">null</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Vector_Inst</span><span class="p">;</span>
</pre></div>
</div>
<p>After including the container package (<code class="code ada docutils literal notranslate"><span class="name"><span class="pre">Ada</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Containers</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Vectors</span></span></code> in
this case), we need to instantiate it. This is due to the fact that
containers are based on generic packages. Therefore, we cannot simply
declare a vector as we would declare an array of a specific type, e.g.:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span>   <span class="n">A</span> <span class="p">:</span> <span class="kr">array</span> <span class="p">(</span><span class="mi">1</span> <span class="p">..</span> <span class="mi">10</span><span class="p">)</span> <span class="kr">of</span> <span class="kt">Integer</span><span class="p">;</span>
</pre></div>
</div>
<p>Instead, we need to first create an instance of the generic package for
the specific type and declare it using the corresponding type from the
instantiated package. As indicated above, this instantiation needs to be
done for any container type from the standard library.</p>
<p>In the instantiation of <code class="docutils literal notranslate"><span class="pre">Integer_Vectors</span></code>, we define that the vector
contains elements of <code class="docutils literal notranslate"><span class="pre">Integer</span></code> type by specifying the <code class="docutils literal notranslate"><span class="pre">Element_Type</span></code>.
Also, by setting <code class="docutils literal notranslate"><span class="pre">Index_Type</span></code> to <code class="docutils literal notranslate"><span class="pre">Natural</span></code>, we specify that the
allowed range includes all natural numbers. We could, instead, use a more
restrict range if we wanted to.</p>
</div>
<div class="section" id="initialization">
<h4>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h4>
<p>In order to initialize a vector, we can use a concatenation of elements.
This is achieved by using the <code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">&amp;</span></span></code> operator, as shown in the following
example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Init</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span>
             <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Vector_Init</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that the example specifies <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span> <span class="name namespace"><span class="pre">Integer_Vectors</span></span></code>, so that we
have direct access to the types and operations from the instantiated
package. Also, the example introduces another operation on the vector:
<code class="docutils literal notranslate"><span class="pre">Length</span></code>, which retrieves the number of elements in the vector. Note
that the dot notation is possible because <code class="docutils literal notranslate"><span class="pre">Vector</span></code> is a tagged type,
so that we can simply write <code class="docutils literal notranslate"><span class="pre">V.Length</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Length(V)</span></code>.</p>
</div>
<div class="section" id="appending-and-prepending-elements">
<h4>Appending and prepending elements<a class="headerlink" href="#appending-and-prepending-elements" title="Permalink to this headline">¶</a></h4>
<p>We can also add elements to a vector by using the <code class="docutils literal notranslate"><span class="pre">Prepend</span></code> and
<code class="docutils literal notranslate"><span class="pre">Append</span></code> operations. As the name suggests, these operations add
elements to the beginning or to the end of the vector, respectively. For
example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Append</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Appending some elements to the vector...&quot;</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Append</span> <span class="p">(</span><span class="mi">20</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Append</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Append</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Append</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Finished appending.&quot;</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Prepending some elements to the vector...&quot;</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Prepend</span> <span class="p">(</span><span class="mi">30</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Prepend</span> <span class="p">(</span><span class="mi">40</span><span class="p">);</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Prepend</span> <span class="p">(</span><span class="mi">100</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Finished prepending.&quot;</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span>
             <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Vector_Append</span><span class="p">;</span>
</pre></div>
</div>
<p>This example fills the vector with elements in the following sequence:
(100, 40, 30, 20, 10, 0, 13).</p>
<p>According to the Reference Manual, the worst-case complexity should be:</p>
<ul class="simple">
<li>O(<span class="math notranslate">\(log N\)</span>) for the <code class="docutils literal notranslate"><span class="pre">Append</span></code> operation, and</li>
<li>O(<span class="math notranslate">\(N log N\)</span>) for the <code class="docutils literal notranslate"><span class="pre">Prepend</span></code> operation.</li>
</ul>
</div>
<div class="section" id="accessing-first-and-last-elements">
<h4>Accessing first and last elements<a class="headerlink" href="#accessing-first-and-last-elements" title="Permalink to this headline">¶</a></h4>
<p>We can access the first and last elements of a vector by using the
functions <code class="docutils literal notranslate"><span class="pre">First_Element</span></code> and <code class="docutils literal notranslate"><span class="pre">Last_Element</span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_First_Last_Element</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Img</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span>    <span class="kr">return</span> <span class="kt">String</span> <span class="kr">renames</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">;</span>
   <span class="kd">function</span> <span class="nf">Img</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Count_Type</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span> <span class="kr">renames</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>

   <span class="c1">--  Using V.First_Element to retrieve first element</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;First element is &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">First_Element</span><span class="p">));</span>

   <span class="c1">--  Using V.Last_Element to retrieve last element</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Last element is &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Last_Element</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Vector_First_Last_Element</span><span class="p">;</span>
</pre></div>
</div>
<p>Also, we can swap elements by calling the procedure <code class="docutils literal notranslate"><span class="pre">Swap</span></code>. In addition,
we can retrieve a reference (cursor) for the first and last elements of
the vector by calling the functions <code class="docutils literal notranslate"><span class="pre">First</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span></code>. A cursor
allows for iterating over a container and processing elements from the
container.</p>
<p>With these operations, we’re able to write some code that swaps the first
and last elements of a vector:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_First_Last_Element</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Img</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span> <span class="kr">renames</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Using V.First and V.Last to retrieve cursor for first and</span>
   <span class="c1">--  last elements.</span>
   <span class="c1">--  Using V.Swap to swap elements.</span>
   <span class="n">V</span><span class="p">.</span><span class="n">Swap</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">First</span><span class="p">,</span> <span class="n">V</span><span class="p">.</span><span class="n">Last</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;First element is now &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">First_Element</span><span class="p">));</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Last element is now &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Last_Element</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Vector_First_Last_Element</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating">
<h4>Iterating<a class="headerlink" href="#iterating" title="Permalink to this headline">¶</a></h4>
<p>The easiest way for iterating over a container is by using a
<code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">for</span></span> <span class="name"><span class="pre">E</span></span> <span class="keyword reserved"><span class="pre">of</span></span> <span class="name"><span class="pre">Our_Container</span></span></code> loop. This will give us a reference to the
element of the current position (<code class="docutils literal notranslate"><span class="pre">E</span></code>). We can then use <code class="docutils literal notranslate"><span class="pre">E</span></code> directly.
For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Iteration</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">function</span> <span class="nf">Img</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">Integer</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span> <span class="kr">renames</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Using for ... of loop to iterate:</span>
   <span class="c1">--</span>
   <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">V</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="n">Img</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Iteration</span><span class="p">;</span>
</pre></div>
</div>
<p>This code will display each element from the vector <code class="docutils literal notranslate"><span class="pre">V</span></code>.</p>
<p>Note that, in addition to displaying the value of an element, we can also
modify its value. For example, we could easily write a loop to add one to
each element of vector <code class="docutils literal notranslate"><span class="pre">V</span></code>:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span>   <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">V</span> <span class="kr">loop</span>
      <span class="n">E</span> <span class="p">:=</span> <span class="n">E</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
</pre></div>
</div>
<p>In case of vectors, we can also use indices to access elements. The format
is similar to a loop over array elements: we use a <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">for</span></span> <span class="name"><span class="pre">I</span></span> <span class="operator word"><span class="pre">in</span></span> <span class="operator"><span class="pre">&lt;</span></span><span class="keyword reserved"><span class="pre">range</span></span><span class="operator"><span class="pre">&gt;</span></span></code>
loop in this case. The range is provided by <code class="docutils literal notranslate"><span class="pre">V.First_Index</span></code> and
<code class="docutils literal notranslate"><span class="pre">V.Last_Index</span></code>. We can access the current element by using it as an
array index: <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">(I)</span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Index_Iteration</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Using indices in a &quot;for I in ...&quot; loop to iterate:</span>
   <span class="c1">--</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">V</span><span class="p">.</span><span class="n">First_Index</span> <span class="p">..</span> <span class="n">V</span><span class="p">.</span><span class="n">Last_Index</span> <span class="kr">loop</span>
      <span class="c1">--  Displaying current index I</span>
      <span class="n">Put</span> <span class="p">(</span><span class="s">&quot;- [&quot;</span>
           <span class="o">&amp;</span> <span class="n">Extended_Index</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
           <span class="o">&amp;</span> <span class="s">&quot;] &quot;</span><span class="p">);</span>

      <span class="n">Put</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span> <span class="p">(</span><span class="n">I</span><span class="p">)));</span>

      <span class="c1">--  We could also use V.Element (I) function to retrieve the</span>
      <span class="c1">--  element for the current index I</span>

      <span class="n">New_Line</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Index_Iteration</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that, in addition to displaying the vector elements, we’re also
displaying the index <code class="docutils literal notranslate"><span class="pre">I</span></code> itself, similar to what we can do with array
indices. Also, we can access the element by using the short form <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">(I)</span></code>
or the longer form <code class="docutils literal notranslate"><span class="pre">V.Element</span> <span class="pre">(I)</span></code>.</p>
<p>As mentioned in the previous section, we can use cursors to iterate over
containers. For this, we use the function <code class="docutils literal notranslate"><span class="pre">Iterate</span></code>, which retrieves
a cursor for each position of the vector. The corresponding loop has the
format <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">for</span></span> <span class="name"><span class="pre">C</span></span> <span class="operator word"><span class="pre">in</span></span> <span class="name"><span class="pre">V</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Iterate</span></span> <span class="keyword reserved"><span class="pre">loop</span></span></code>. Similar to the previous example
using indices, we can again access the current element by using the cursor
as an array index: <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">(C)</span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Cursor_Iteration</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Using cursor in a loop to iterate:</span>
   <span class="c1">--</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">V</span><span class="p">.</span><span class="n">Iterate</span> <span class="kr">loop</span>
      <span class="c1">--  Using To_Index function in order to retrieve index</span>
      <span class="c1">--  for the cursor position</span>
      <span class="n">Put</span> <span class="p">(</span><span class="s">&quot;- [&quot;</span>
           <span class="o">&amp;</span> <span class="n">Extended_Index</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">To_Index</span> <span class="p">(</span><span class="n">C</span><span class="p">))</span>
           <span class="o">&amp;</span> <span class="s">&quot;] &quot;</span><span class="p">);</span>

      <span class="n">Put</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span> <span class="p">(</span><span class="n">C</span><span class="p">)));</span>

      <span class="c1">--  We could use Element (C) to retrieve the vector</span>
      <span class="c1">--  element for the cursor position</span>

      <span class="n">New_Line</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

   <span class="c1">--  Alternatively, we could iterate with a while-loop:</span>
   <span class="c1">--</span>
   <span class="c1">--  declare</span>
   <span class="c1">--     C : Cursor := V.First;</span>
   <span class="c1">--  begin</span>
   <span class="c1">--     while C /= No_Element loop</span>
   <span class="c1">--        some processing here...</span>
   <span class="c1">--</span>
   <span class="c1">--        C := Next (C);</span>
   <span class="c1">--     end loop;</span>
   <span class="c1">--  end;</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Cursor_Iteration</span><span class="p">;</span>
</pre></div>
</div>
<p>Note that, instead of accessing an element in the loop using <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">(C)</span></code>,
we could also have used the longer form <code class="docutils literal notranslate"><span class="pre">Element</span> <span class="pre">(C)</span></code>. Also, we’re using
the function <code class="docutils literal notranslate"><span class="pre">To_Index</span></code> to retrieve the corresponding index for the
current cursor.</p>
<p>Moreover, as indicated above in the comments after the iteration loop, we
could also use a <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">while</span></span> <span class="punctuation"><span class="pre">…</span></span> <span class="keyword reserved"><span class="pre">loop</span></span></code> to iterate over the vector. In this
case, we would start with a cursor for the first element (retrieved by
calling <code class="docutils literal notranslate"><span class="pre">V.First</span></code>) and then call <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">(C)</span></code> to retrieve a cursor for
the next positions. <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">(C)</span></code> returns <code class="docutils literal notranslate"><span class="pre">No_Element</span></code> when the cursor
reaches the end of the vector.</p>
<p>As mentioned above, we can directly modify the elements using a reference.
This is how it looks like when dealing with indices and cursors:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span>   <span class="c1">--  Modify vector elements using index</span>
   <span class="kr">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">V</span><span class="p">.</span><span class="n">First_Index</span> <span class="p">..</span> <span class="n">V</span><span class="p">.</span><span class="n">Last_Index</span> <span class="kr">loop</span>
      <span class="n">V</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">:=</span> <span class="n">V</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

   <span class="c1">--  Modify vector elements using cursor</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">V</span><span class="p">.</span><span class="n">Iterate</span> <span class="kr">loop</span>
      <span class="n">V</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">:=</span> <span class="n">V</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
</pre></div>
</div>
<p>According to the Reference Manual, the worst-case complexity of accessing
an element should be O(<span class="math notranslate">\(log N\)</span>).</p>
<p>Another approach to modify elements of a vector is to use a process
procedure, which takes the individual elements and does some processing on
them. In this case, we can call <code class="docutils literal notranslate"><span class="pre">Update_Element</span></code> and pass a cursor
and an access to the process procedure. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Update</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Add_One</span> <span class="p">(</span><span class="nv">I</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Integer</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">I</span> <span class="p">:=</span> <span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Add_One</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">12</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--</span>
   <span class="c1">--  Using V.Update_Element to process elements</span>
   <span class="c1">--</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">V</span><span class="p">.</span><span class="n">Iterate</span> <span class="kr">loop</span>
      <span class="n">V</span><span class="p">.</span><span class="n">Update_Element</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Add_One</span><span class="p">&#39;</span><span class="na">Access</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Update</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="finding-and-changing-elements">
<h4>Finding and changing elements<a class="headerlink" href="#finding-and-changing-elements" title="Permalink to this headline">¶</a></h4>
<p>We can find a certain element in a vector by retrieving its index. This
can be achieved by using <code class="docutils literal notranslate"><span class="pre">Find_Index</span></code>, which retrieves the index of the
first element that matches the element we’re looking for. Alternatively,
we could use <code class="docutils literal notranslate"><span class="pre">Find</span></code> to retrieve the cursor for that element. For
example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Find_Vector_Element</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
   <span class="n">Idx</span> <span class="p">:</span> <span class="n">Extended_Index</span><span class="p">;</span>
   <span class="n">C</span>   <span class="p">:</span> <span class="kt">Cursor</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Using Find_Index to retrieve index of element with value 10</span>
   <span class="n">Idx</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find_Index</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Index of element with value 10 is &quot;</span>
             <span class="o">&amp;</span> <span class="n">Extended_Index</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Idx</span><span class="p">));</span>

   <span class="c1">--  Using Find to retrieve cursor for element with value 13</span>
   <span class="n">C</span>   <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>
   <span class="n">Idx</span> <span class="p">:=</span> <span class="n">To_Index</span> <span class="p">(</span><span class="n">C</span><span class="p">);</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Index of element with value 13 is &quot;</span>
             <span class="o">&amp;</span> <span class="n">Extended_Index</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">Idx</span><span class="p">));</span>
<span class="kr">end</span> <span class="nf">Show_Find_Vector_Element</span><span class="p">;</span>
</pre></div>
</div>
<p>As shown in the previous section about iteration, we can directly access
vector elements by using either an index or cursor. However, before
doing that, we should check whether the index or cursor is valid, since
<code class="docutils literal notranslate"><span class="pre">Find_Index</span></code> or <code class="docutils literal notranslate"><span class="pre">Find</span></code> might not have found the element in the vector.
An exception will be raised if we try to access an element with an invalid
index or cursor. We do this check by comparing the index to <code class="docutils literal notranslate"><span class="pre">No_Index</span></code>
and the cursor to <code class="docutils literal notranslate"><span class="pre">No_Element</span></code>. For example:</p>
<div class="ada-nocheck highlight-ada notranslate"><div class="highlight"><pre><span></span>   <span class="c1">--  Modify vector element using index</span>
   <span class="kr">if</span> <span class="n">Idx</span> <span class="o">/=</span> <span class="n">No_Index</span> <span class="kr">then</span>
      <span class="n">V</span> <span class="p">(</span><span class="n">Idx</span><span class="p">)</span> <span class="p">:=</span> <span class="mi">11</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  Modify vector element using cursor</span>
   <span class="kr">if</span> <span class="n">C</span> <span class="o">/=</span> <span class="n">No_Element</span> <span class="kr">then</span>
      <span class="n">V</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">:=</span> <span class="mi">14</span><span class="p">;</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
</pre></div>
</div>
<p>Alternatively, instead of writing <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">(C)</span> <span class="pre">:=</span> <span class="pre">14</span></code>, we could use the longer
form <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">V</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">Replace_Element</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">C</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="literal number integer"><span class="pre">14</span></span><span class="punctuation"><span class="pre">)</span></span></code>.</p>
</div>
<div class="section" id="inserting-elements">
<h4>Inserting elements<a class="headerlink" href="#inserting-elements" title="Permalink to this headline">¶</a></h4>
<p>In the previous sections, we’ve seen examples of how to insert elements
into a vector:</p>
<ul class="simple">
<li>using the concatenation operator (<code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">&amp;</span></span></code>) at the vector declaration,
or</li>
<li>calling the <code class="docutils literal notranslate"><span class="pre">Prepend</span></code> and <code class="docutils literal notranslate"><span class="pre">Append</span></code> procedures.</li>
</ul>
<p>In some cases, we want to insert an element at a specific position, e.g.
before a certain element in the vector. We can do this by calling
<code class="docutils literal notranslate"><span class="pre">Insert</span></code>. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Insert</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elements</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Vector</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span>
                <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>

      <span class="kr">if</span> <span class="ow">not</span> <span class="n">V</span><span class="p">.</span><span class="n">Is_Empty</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>
         <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">V</span> <span class="kr">loop</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
         <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_Elements</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">12</span><span class="p">;</span>
   <span class="n">C</span> <span class="p">:</span> <span class="kt">Cursor</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Adding element with value 9 (before 10)...&quot;</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Using V.Insert to insert element into vector</span>
   <span class="c1">--</span>
   <span class="n">C</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="kr">if</span> <span class="n">C</span> <span class="o">/=</span> <span class="n">No_Element</span> <span class="kr">then</span>
      <span class="n">V</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Insert</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we’re looking for an element with value 10. If we find
it, we then insert an element with value 9 before it.</p>
</div>
<div class="section" id="removing-elements">
<h4>Removing elements<a class="headerlink" href="#removing-elements" title="Permalink to this headline">¶</a></h4>
<p>We can remove elements from a vector by using the <code class="docutils literal notranslate"><span class="pre">Delete</span></code> procedure
with either a valid index or cursor. If we combine this with the functions
<code class="docutils literal notranslate"><span class="pre">Find_Index</span></code> and <code class="docutils literal notranslate"><span class="pre">Find</span></code> from the previous section, we’ll be able to
write a program that searches for a specific element and deletes it:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Remove_Vector_Element</span> <span class="kr">is</span>
   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
   <span class="n">Idx</span> <span class="p">:</span> <span class="n">Extended_Index</span><span class="p">;</span>
   <span class="n">C</span>   <span class="p">:</span> <span class="kt">Cursor</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="c1">--  Using Find_Index to retrieve index of element with value 10</span>
   <span class="n">Idx</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find_Index</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>

   <span class="c1">--  Checking whether index is valid</span>
   <span class="kr">if</span> <span class="n">Idx</span> <span class="o">/=</span> <span class="n">No_Index</span> <span class="kr">then</span>
      <span class="c1">--  Removing element using V.Delete</span>
      <span class="n">V</span><span class="p">.</span><span class="n">Delete</span> <span class="p">(</span><span class="n">Idx</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  Using Find to retrieve cursor for element with value 13</span>
   <span class="n">C</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="c1">--  Checking whether index is valid</span>
   <span class="kr">if</span> <span class="n">C</span> <span class="o">/=</span> <span class="n">No_Element</span> <span class="kr">then</span>
      <span class="c1">--  Removing element using V.Delete</span>
      <span class="n">V</span><span class="p">.</span><span class="n">Delete</span> <span class="p">(</span><span class="n">C</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Remove_Vector_Element</span><span class="p">;</span>
</pre></div>
</div>
<p>This approach can be extended to delete all elements that match a certain
value. We just need to keep searching for the element in a loop until we
get an invalid index or cursor. For example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Remove_Vector_Elements</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elements</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Vector</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span> <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>

      <span class="kr">if</span> <span class="ow">not</span> <span class="n">V</span><span class="p">.</span><span class="n">Is_Empty</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>
         <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">V</span> <span class="kr">loop</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
         <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_Elements</span><span class="p">;</span>

   <span class="n">V</span> <span class="p">:</span> <span class="n">Vector</span> <span class="p">:=</span> <span class="mi">20</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">13</span> <span class="o">&amp;</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">14</span> <span class="o">&amp;</span> <span class="mi">13</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Removing elements using an index</span>
   <span class="c1">--</span>
   <span class="kr">declare</span>
      <span class="no">E</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">10</span><span class="p">;</span>
      <span class="n">I</span> <span class="p">:</span> <span class="n">Extended_Index</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Removing all elements with value of &quot;</span>
                <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot;...&quot;</span><span class="p">);</span>
      <span class="kr">loop</span>
         <span class="n">I</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find_Index</span> <span class="p">(</span><span class="n">E</span><span class="p">);</span>
         <span class="kr">exit</span> <span class="kr">when</span> <span class="n">I</span> <span class="o">=</span> <span class="n">No_Index</span><span class="p">;</span>
         <span class="n">V</span><span class="p">.</span><span class="n">Delete</span> <span class="p">(</span><span class="n">I</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span><span class="p">;</span>

   <span class="c1">--</span>
   <span class="c1">--  Removing elements using a cursor</span>
   <span class="c1">--</span>
   <span class="kr">declare</span>
      <span class="no">E</span> <span class="p">:</span> <span class="kr">constant</span> <span class="kt">Integer</span> <span class="p">:=</span> <span class="mi">13</span><span class="p">;</span>
      <span class="n">C</span> <span class="p">:</span> <span class="kt">Cursor</span><span class="p">;</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Removing all elements with value of &quot;</span>
                <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot;...&quot;</span><span class="p">);</span>
      <span class="kr">loop</span>
         <span class="n">C</span> <span class="p">:=</span> <span class="n">V</span><span class="p">.</span><span class="n">Find</span> <span class="p">(</span><span class="n">E</span><span class="p">);</span>
         <span class="kr">exit</span> <span class="kr">when</span> <span class="n">C</span> <span class="o">=</span> <span class="n">No_Element</span><span class="p">;</span>
         <span class="n">V</span><span class="p">.</span><span class="n">Delete</span> <span class="p">(</span><span class="n">C</span><span class="p">);</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span><span class="p">;</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Remove_Vector_Elements</span><span class="p">;</span>
</pre></div>
</div>
<p>In this example, we remove all elements from the vector that have the
value 10 by retrieving their index. Likewise,  we remove all elements with
the value 13 by retrieving their cursor.</p>
</div>
<div class="section" id="other-operations">
<h4>Other Operations<a class="headerlink" href="#other-operations" title="Permalink to this headline">¶</a></h4>
<p>We’ve already seen some operations on vector elements in the last
sections. In this section, we’ll see operations on the vector as a
whole. The most prominent example is the concatenation of multiple
vectors. Also, we’ll see operations on a vector as a sequence of elements,
i.e. considering their relation to each other. Examples are sorting and
sorted merging operations.</p>
<p>Vector concatenation is done by using the <code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">&amp;</span></span></code> operator on vectors.
Let’s consider two vectors <code class="docutils literal notranslate"><span class="pre">V1</span></code> and <code class="docutils literal notranslate"><span class="pre">V2</span></code>. We can concatenate them with
the following statement: <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">V</span></span> <span class="punctuation"><span class="pre">:=</span></span> <span class="name"><span class="pre">V1</span></span> <span class="operator"><span class="pre">&amp;</span></span> <span class="name"><span class="pre">V2</span></span></code>. <code class="docutils literal notranslate"><span class="pre">V</span></code> will contain the
resulting vector.</p>
<p>The generic package <code class="docutils literal notranslate"><span class="pre">Generic_Sorting</span></code> is a child package of
<code class="docutils literal notranslate"><span class="pre">Ada.Containers.Vectors</span></code>. It contains sorting and merging operations.
Because it’s a generic package, we cannot use it directly, but have to
instantiate it, too. Also, in order to use these operations in our vector
of integer values (<code class="docutils literal notranslate"><span class="pre">Integer_Vectors</span></code>), we need to instantiate it
directly as a child from <code class="docutils literal notranslate"><span class="pre">Integer_Vectors</span></code>. The next example will make
this clear.</p>
<p>After the instantiation of <code class="docutils literal notranslate"><span class="pre">Generic_Sorting</span></code> is done, we can make all
operations available with the <code class="code ada docutils literal notranslate"><span class="keyword namespace"><span class="pre">use</span></span></code> statement. We can then proceed to
call <code class="docutils literal notranslate"><span class="pre">Sort</span></code> in order to sort the vector and <code class="docutils literal notranslate"><span class="pre">Merge</span></code> in order to merge
one vector into another one.</p>
<p>The following code example presents an application that operates on three
vectors (<code class="docutils literal notranslate"><span class="pre">V1</span></code>, <code class="docutils literal notranslate"><span class="pre">V2</span></code>, <code class="docutils literal notranslate"><span class="pre">V3</span></code>) and uses the concatenation, sorting and
sorted merging operations:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Vectors</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Vector_Ops</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span>
     <span class="p">(</span><span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Natural<span class="p">,</span>
      <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kd">package</span> <span class="nc">Integer_Vectors_Sorting</span> <span class="kr">is new</span> <span class="nc">Integer_Vectors.Generic_Sorting</span><span class="p">;</span>

   <span class="kn">use</span> <span class="nn">Integer_Vectors</span><span class="p">;</span>
   <span class="kn">use</span> <span class="nn">Integer_Vectors_Sorting</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elements</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Vector</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector has &quot;</span> <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>

      <span class="kr">if</span> <span class="ow">not</span> <span class="n">V</span><span class="p">.</span><span class="n">Is_Empty</span> <span class="kr">then</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Vector elements are: &quot;</span><span class="p">);</span>
         <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">V</span> <span class="kr">loop</span>
            <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
         <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
      <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_Elements</span><span class="p">;</span>

   <span class="n">V</span><span class="p">,</span> <span class="n">V1</span><span class="p">,</span> <span class="n">V2</span><span class="p">,</span> <span class="n">V3</span> <span class="p">:</span> <span class="n">Vector</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">V1</span> <span class="p">:=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="mi">12</span> <span class="o">&amp;</span> <span class="mi">18</span><span class="p">;</span>
   <span class="n">V2</span> <span class="p">:=</span> <span class="mi">11</span> <span class="o">&amp;</span> <span class="mi">13</span> <span class="o">&amp;</span> <span class="mi">19</span><span class="p">;</span>
   <span class="n">V3</span> <span class="p">:=</span> <span class="mi">15</span> <span class="o">&amp;</span> <span class="mi">19</span><span class="p">;</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- V1 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V1</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- V2 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V2</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- V3 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V3</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Concatenating V1, V2 and V3 into V:&quot;</span><span class="p">);</span>

   <span class="n">V</span> <span class="p">:=</span> <span class="n">V1</span> <span class="o">&amp;</span> <span class="n">V2</span> <span class="o">&amp;</span> <span class="n">V3</span><span class="p">;</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Sorting V:&quot;</span><span class="p">);</span>

   <span class="n">Sort</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Merging V2 into V1:&quot;</span><span class="p">);</span>

   <span class="n">Merge</span> <span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">V2</span><span class="p">);</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">V1</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Vector_Ops</span><span class="p">;</span>
</pre></div>
</div>
<p>According to the Reference Manual, the worst-case complexity of a call to
<code class="docutils literal notranslate"><span class="pre">Sort</span></code> should be O(<span class="math notranslate">\(N^2\)</span>), and the average complexity should be better
than O(<span class="math notranslate">\(N^2\)</span>).</p>
</div>
</div>
<div class="section" id="sets">
<h3>Sets<a class="headerlink" href="#sets" title="Permalink to this headline">¶</a></h3>
<p>Sets are another class of containers. While vectors allow for duplicated
elements to be inserted, sets ensure that no duplicated elements exist at
any moment.</p>
<p>In the following subsections, we’ll look into operations that can be
performed on sets. However, since many of the operations on vectors are
similar to the ones used for sets, we’ll cover them more quickly here.
Please refer to the section on vectors for a more detailed discussion.</p>
<div class="section" id="initialization-and-iteration">
<h4>Initialization and iteration<a class="headerlink" href="#initialization-and-iteration" title="Permalink to this headline">¶</a></h4>
<p>In order to initialize a set, we can call the <code class="docutils literal notranslate"><span class="pre">Insert</span></code> procedure.
However, we need to make sure that no duplicated element is being
inserted. Otherwise, we’ll get an exception. If we have less control
about the elements to be inserted (e.g.: when elements are being passed
as arguments and inserted into a set), we might want to use one of the
following options:</p>
<ul class="simple">
<li>use a version of <code class="docutils literal notranslate"><span class="pre">Insert</span></code> that provides an output Boolean value
indicating whether the insertion was successful;</li>
<li>use the <code class="docutils literal notranslate"><span class="pre">Include</span></code> procedure, which silently ignores any attempt to
insert a duplicated element.</li>
</ul>
<p>In order to iterate over a set, we can use a <code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">for</span></span> <span class="name"><span class="pre">E</span></span> <span class="keyword reserved"><span class="pre">of</span></span> <span class="name"><span class="pre">S</span></span></code> loop, as
we did for vectors. This will give us a reference to each element from
the set.</p>
<p>Let’s see an example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Ordered_Sets</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Set_Init</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Sets</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Ordered_Sets</span>
     <span class="p">(</span><span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Sets</span><span class="p">;</span>

   <span class="n">S</span> <span class="p">:</span> <span class="n">Set</span><span class="p">;</span>
   <span class="n">C</span> <span class="p">:</span> <span class="kt">Cursor</span><span class="p">;</span>
   <span class="n">Ins</span> <span class="p">:</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">20</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="c1">--  Calling S.Insert(0) now would raise Constraint_Error exception</span>
   <span class="c1">--  because this element is already in the set</span>
   <span class="c1">--  We can call a version of Insert that does not raise an exception,</span>
   <span class="c1">--  but returns a Boolean indicating the status</span>

   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Ins</span><span class="p">);</span>
   <span class="kr">if</span> <span class="ow">not</span> <span class="n">Ins</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Inserting 0 into set was not successful&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  We can also call S.Include instead</span>
   <span class="c1">--  If the element is already available, the set remains the same</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="mi">14</span><span class="p">);</span>

   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Set has &quot;</span> <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>

   <span class="c1">--</span>
   <span class="c1">--  Iterate over set using for .. of loop</span>
   <span class="c1">--</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Elements:&quot;</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">S</span> <span class="kr">loop</span>
       <span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">(</span><span class="n">E</span><span class="p">));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Show_Set_Init</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="operations-on-elements">
<h4>Operations on elements<a class="headerlink" href="#operations-on-elements" title="Permalink to this headline">¶</a></h4>
<p>In this section, we will briefly look into the following operations on
sets:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Delete</span></code> and <code class="docutils literal notranslate"><span class="pre">Exclude</span></code> to remove elements;</li>
<li><code class="docutils literal notranslate"><span class="pre">Contains</span></code> and <code class="docutils literal notranslate"><span class="pre">Find</span></code> to verify the existence of elements.</li>
</ul>
<p>In order to delete elements, we can call the procedure <code class="docutils literal notranslate"><span class="pre">Delete</span></code>.
However, similarly to the situation we’ve seen with <code class="docutils literal notranslate"><span class="pre">Insert</span></code>
in the previous section, <code class="docutils literal notranslate"><span class="pre">Delete</span></code> raises an exception when
the element to be deleted doesn’t exist in the set. Therefore, in case
an element might not exist in a set, we can call <code class="docutils literal notranslate"><span class="pre">Exclude</span></code>, which
silently ignores any attempt to delete a non-existent element.</p>
<p><code class="docutils literal notranslate"><span class="pre">Contains</span></code> returns a Boolean value indicating whether a value is
contained in the set. <code class="docutils literal notranslate"><span class="pre">Find</span></code> also looks for an element in a set, but
returns a cursor to the element or <code class="docutils literal notranslate"><span class="pre">No_Element</span></code> in case the element
doesn’t exist in the set. Both functions can be used to search for
elements in a set.</p>
<p>Let’s look at an example that makes use of these operations:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Ordered_Sets</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Set_Element_Ops</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Sets</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Ordered_Sets</span>
     <span class="p">(</span><span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Sets</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elements</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Set</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Set has &quot;</span> <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Elements:&quot;</span><span class="p">);</span>
      <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">S</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_Elements</span><span class="p">;</span>

   <span class="n">S</span> <span class="p">:</span> <span class="n">Set</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">20</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="n">S</span><span class="p">.</span><span class="n">Delete</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="c1">--  Calling S.Delete (13) again raises a Constraint_Error</span>
   <span class="c1">--  exception because the element does not exist anymore</span>
   <span class="c1">--  in the set, so it cannot be deleted.</span>
   <span class="c1">--  We can call V.Exclude instead:</span>
   <span class="n">S</span><span class="p">.</span><span class="n">Exclude</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="kr">if</span> <span class="n">S</span><span class="p">.</span><span class="n">Contains</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Found element 20 in set&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  Alternatively, we could use S.Find instead of S.Contains</span>
   <span class="kr">if</span> <span class="n">S</span><span class="p">.</span><span class="n">Find</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/=</span> <span class="n">No_Element</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Found element 0 in set&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">Show_Set_Element_Ops</span><span class="p">;</span>
</pre></div>
</div>
<p>In addition to ordered sets used in the examples above, the standard
library also offers hashed sets. According to the Reference Manual, this
is the average complexity of some operations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="35%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operations</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">Ordered_Sets</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">Hashed_Sets</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>Insert</li>
<li>Include</li>
<li>Replace</li>
<li>Delete</li>
<li>Exclude</li>
<li>Find</li>
</ul>
</td>
<td>O(<span class="math notranslate">\((log N)^2)\)</span>
or better</td>
<td><span class="math notranslate">\(O(log N)\)</span></td>
</tr>
<tr class="row-odd"><td>Subprogram using
cursor</td>
<td>O(<span class="math notranslate">\(1\)</span>)</td>
<td>O(<span class="math notranslate">\(1\)</span>)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h4>Other Operations<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>The previous sections dealt with operations on individual elements of a
set. We’ll now look into typical set operations: union, intersection,
difference and symmetric difference. In contrast to some vector
operations we’ve seen before (e.g. <code class="docutils literal notranslate"><span class="pre">Merge</span></code>), we can use built-in
operators, such as <code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">-</span></span></code>. The following table lists the operations and
the associated operator:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Set Operation</th>
<th class="head">Operator</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Union</td>
<td><code class="code ada docutils literal notranslate"><span class="operator word"><span class="pre">and</span></span></code></td>
</tr>
<tr class="row-odd"><td>Intersection</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">or</span></span></code></td>
</tr>
<tr class="row-even"><td>Difference</td>
<td><code class="code ada docutils literal notranslate"><span class="operator"><span class="pre">-</span></span></code></td>
</tr>
<tr class="row-odd"><td>Symmetric difference</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword reserved"><span class="pre">xor</span></span></code></td>
</tr>
</tbody>
</table>
<p>The following example makes use of these operators:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Containers</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Containers.Ordered_Sets</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Set_Ops</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Sets</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Ordered_Sets</span>
     <span class="p">(</span><span class="nv">Element_Type</span> <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Sets</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Elements</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Set</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Elements:&quot;</span><span class="p">);</span>
      <span class="kr">for</span> <span class="n">E</span> <span class="kr">of</span> <span class="n">S</span> <span class="kr">loop</span>
         <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;- &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">E</span><span class="p">));</span>
      <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
   <span class="kr">end</span> <span class="nf">Show_Elements</span><span class="p">;</span>

   <span class="kd">procedure</span> <span class="nf">Show_Op</span> <span class="p">(</span><span class="nv">S</span>       <span class="p">: </span><span class="nv">Set</span><span class="p">;</span>
                      <span class="nv">Op_Name</span> <span class="p">: </span><span class="nv">String</span><span class="p">)</span> <span class="kr">is</span>
   <span class="kr">begin</span>
      <span class="n">New_Line</span><span class="p">;</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Op_Name</span> <span class="o">&amp;</span> <span class="s">&quot;(set #1, set #2) has &quot;</span>
                <span class="o">&amp;</span> <span class="n">Count_Type</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">S</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; elements&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="nf">Show_Op</span><span class="p">;</span>

   <span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span> <span class="p">:</span> <span class="n">Set</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">S1</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S1</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">S1</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">13</span><span class="p">);</span>

   <span class="n">S2</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S2</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>
   <span class="n">S2</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">14</span><span class="p">);</span>

   <span class="n">S3</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">0</span><span class="p">);</span>
   <span class="n">S3</span><span class="p">.</span><span class="n">Insert</span> <span class="p">(</span><span class="mi">10</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- Set #1 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S1</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- Set #2 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S2</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;---- Set #3 ----&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S3</span><span class="p">);</span>

   <span class="n">New_Line</span><span class="p">;</span>
   <span class="kr">if</span> <span class="n">S3</span><span class="p">.</span><span class="n">Is_Subset</span> <span class="p">(</span><span class="n">S1</span><span class="p">)</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;S3 is a subset of S1&quot;</span><span class="p">);</span>
   <span class="kr">else</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;S3 is not a subset of S1&quot;</span><span class="p">);</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="n">S3</span> <span class="p">:=</span> <span class="n">S1</span> <span class="ow">and</span> <span class="n">S2</span><span class="p">;</span>
   <span class="n">Show_Op</span> <span class="p">(</span><span class="n">S3</span><span class="p">,</span> <span class="s">&quot;Union&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S3</span><span class="p">);</span>

   <span class="n">S3</span> <span class="p">:=</span> <span class="n">S1</span> <span class="kr">or</span> <span class="n">S2</span><span class="p">;</span>
   <span class="n">Show_Op</span> <span class="p">(</span><span class="n">S3</span><span class="p">,</span> <span class="s">&quot;Intersection&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S3</span><span class="p">);</span>

   <span class="n">S3</span> <span class="p">:=</span> <span class="n">S1</span> <span class="o">-</span> <span class="n">S2</span><span class="p">;</span>
   <span class="n">Show_Op</span> <span class="p">(</span><span class="n">S3</span><span class="p">,</span> <span class="s">&quot;Difference&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S3</span><span class="p">);</span>

   <span class="n">S3</span> <span class="p">:=</span> <span class="n">S1</span> <span class="kr">xor</span> <span class="n">S2</span><span class="p">;</span>
   <span class="n">Show_Op</span> <span class="p">(</span><span class="n">S3</span><span class="p">,</span> <span class="s">&quot;Symmetric difference&quot;</span><span class="p">);</span>
   <span class="n">Show_Elements</span> <span class="p">(</span><span class="n">S3</span><span class="p">);</span>

<span class="kr">end</span> <span class="nf">Show_Set_Ops</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="indefinite-maps">
<h3>Indefinite maps<a class="headerlink" href="#indefinite-maps" title="Permalink to this headline">¶</a></h3>
<p>In the previous sections, we dealt with containers for elements of
definite types. In most source-code examples of those sections, we’ve
seen <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">Integer</span></span></code> types as element type of the containers. An
example of indefinite type is a <code class="code ada docutils literal notranslate"><span class="keyword type"><span class="pre">String</span></span></code> type. Indefinite types
require a different kind of containers specially designed for them.</p>
<p>Also, we will be looking into a different class of containers: maps. They
allow for associating a key to a specific value. An example of a map is
the one-to-one association between a person and its age. If we consider
a person’s name to be the key, the value would be the person’s age.</p>
<div class="section" id="hashed-maps">
<h4>Hashed maps<a class="headerlink" href="#hashed-maps" title="Permalink to this headline">¶</a></h4>
<p>Hashed maps are maps that make use of a hash as a key. The hash itself is
calculated by a function indicated by the programmer.</p>
<div class="admonition-in-other-languages admonition">
<p class="first admonition-title">In other languages</p>
<p class="last">Hashed maps are similar to dictionaries in Python and hashes in Perl.
One of the main differences is that these scripting languages allow
for using different types for the values contained in a map, while in
Ada, the type of both key and value is specified in the package
instantiation and cannot be changed for that specific map. In order
to use multiple types, different maps need to be specified.</p>
</div>
<p>When instantiating a hashed map from
<code class="docutils literal notranslate"><span class="pre">Ada.Containers.Indefinite_Hashed_Maps</span></code>, we need to specify following
elements:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Key_Type</span></code>: type of the key</li>
<li><code class="docutils literal notranslate"><span class="pre">Element_Type</span></code>: type of the element</li>
<li><code class="docutils literal notranslate"><span class="pre">Hash</span></code>: hash function for the <code class="docutils literal notranslate"><span class="pre">Key_Type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Equivalent_Keys</span></code>: an equality operator (e.g. <code class="docutils literal notranslate"><span class="pre">=</span></code>) that is used
to determine if two keys are equal.<ul>
<li>If the type specified in <code class="docutils literal notranslate"><span class="pre">Key_Type</span></code> has a standard operator, we
might use it.</li>
</ul>
</li>
</ul>
<p>In the next example, we’ll use a string as a key type. Also, we’ll use the
<code class="docutils literal notranslate"><span class="pre">Hash</span></code> function provided by the standard library for strings (in the
<code class="docutils literal notranslate"><span class="pre">Ada.Strings</span></code> package).</p>
<p>We can include elements into a hashed map by calling <code class="docutils literal notranslate"><span class="pre">Insert</span></code>. If an
element is already contained in a map <code class="docutils literal notranslate"><span class="pre">M</span></code>, we can access it directly by
using its key. For example, we may change the value of an element by
calling <code class="code ada docutils literal notranslate"><span class="name"><span class="pre">M</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="literal string"><span class="pre">“My_Key”</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="punctuation"><span class="pre">:=</span></span> <span class="literal number integer"><span class="pre">10</span></span></code>. If the key is not found, however, an
exception is raised. In order to verify if a key is available, we can use
the function <code class="docutils literal notranslate"><span class="pre">Contains</span></code> (as we’ve seen in the section about sets).</p>
<p>Let’s see an example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Indefinite_Hashed_Maps</span><span class="p">;</span>
<span class="kn">with</span> <span class="nn">Ada.Strings.Hash</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Hashed_Map</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Hashed_Maps</span> <span class="kr">is new</span>
     <span class="nc">Ada.Containers.Indefinite_Hashed_Maps</span>
       <span class="p">(</span><span class="nv">Key_Type</span>        <span class="p">=&gt;</span> String<span class="p">,</span>
        <span class="nv">Element_Type</span>    <span class="p">=&gt;</span> Integer<span class="p">,</span>
        <span class="nv">Hash</span>            <span class="p">=&gt;</span> Ada.Strings.Hash<span class="p">,</span>
        <span class="nv">Equivalent_Keys</span> <span class="p">=&gt;</span> &quot;<span class="o">=</span>&quot;<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Hashed_Maps</span><span class="p">;</span>

   <span class="n">M</span> <span class="p">:</span> <span class="n">Map</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;John&quot;</span><span class="p">,</span>  <span class="mi">40</span><span class="p">);</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;Bob&quot;</span><span class="p">,</span>   <span class="mi">28</span><span class="p">);</span>

   <span class="kr">if</span> <span class="n">M</span><span class="p">.</span><span class="n">Contains</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Alice&#39;s age is &quot;</span>
                <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">M</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  Update Alice&#39;s age</span>
   <span class="c1">--  Key must already exist in M.</span>
   <span class="c1">--  Otherwise, an exception will be raised.</span>
   <span class="n">M</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)</span> <span class="p">:=</span> <span class="mi">25</span><span class="p">;</span>

   <span class="n">New_Line</span><span class="p">;</span> <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Name &amp; Age:&quot;</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">M</span><span class="p">.</span><span class="n">Iterate</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Key</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot;: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">M</span> <span class="p">(</span><span class="n">C</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Hashed_Map</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="ordered-maps">
<h4>Ordered maps<a class="headerlink" href="#ordered-maps" title="Permalink to this headline">¶</a></h4>
<p>Ordered maps share many features with hashed maps. The main differences
are:</p>
<ul class="simple">
<li>A hash function is not needed. Instead, you need to provide an ordering
function (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code> operator). The ordered map will then use it to order
elements, and allow pretty fast access — O (log n) using a binary
search.<ul>
<li>If the type specified in <code class="docutils literal notranslate"><span class="pre">Key_Type</span></code> has a standard <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> operator,
we might use it.</li>
</ul>
</li>
</ul>
<p>Let’s see an example:</p>
<div class="highlight-ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Containers.Indefinite_Ordered_Maps</span><span class="p">;</span>

<span class="kn">with</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span> <span class="kn">use</span> <span class="nn">Ada.Text_IO</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Show_Ordered_Map</span> <span class="kr">is</span>

   <span class="kd">package</span> <span class="nc">Integer_Ordered_Maps</span> <span class="kr">is new</span>
     <span class="nc">Ada.Containers.Indefinite_Ordered_Maps</span>
       <span class="p">(</span><span class="nv">Key_Type</span>        <span class="p">=&gt;</span> String<span class="p">,</span>
        <span class="nv">Element_Type</span>    <span class="p">=&gt;</span> Integer<span class="p">);</span>

   <span class="kn">use</span> <span class="nn">Integer_Ordered_Maps</span><span class="p">;</span>

   <span class="n">M</span> <span class="p">:</span> <span class="n">Map</span><span class="p">;</span>
<span class="kr">begin</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;John&quot;</span><span class="p">,</span>  <span class="mi">40</span><span class="p">);</span>
   <span class="n">M</span><span class="p">.</span><span class="n">Include</span> <span class="p">(</span><span class="s">&quot;Bob&quot;</span><span class="p">,</span>   <span class="mi">28</span><span class="p">);</span>

   <span class="kr">if</span> <span class="n">M</span><span class="p">.</span><span class="n">Contains</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)</span> <span class="kr">then</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Alice&#39;s age is &quot;</span>
                <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">M</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

   <span class="c1">--  Update Alice&#39;s age</span>
   <span class="c1">--  Key must already exist in M</span>
   <span class="n">M</span> <span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">)</span> <span class="p">:=</span> <span class="mi">25</span><span class="p">;</span>

   <span class="n">New_Line</span><span class="p">;</span> <span class="n">Put_Line</span> <span class="p">(</span><span class="s">&quot;Name &amp; Age:&quot;</span><span class="p">);</span>
   <span class="kr">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">M</span><span class="p">.</span><span class="n">Iterate</span> <span class="kr">loop</span>
      <span class="n">Put_Line</span> <span class="p">(</span><span class="n">Key</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot;: &quot;</span> <span class="o">&amp;</span> <span class="kt">Integer</span><span class="p">&#39;</span><span class="na">Image</span> <span class="p">(</span><span class="n">M</span> <span class="p">(</span><span class="n">C</span><span class="p">)));</span>
   <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">Show_Ordered_Map</span><span class="p">;</span>
</pre></div>
</div>
<p>There is a great similarity between the example above and the one from the
previous section. In fact, since maps share many operations, we
don’t need to make extensive adaptations in order to change our example
to use ordered maps instead of hashed maps. The main difference we notice
here is when we run the applications: while the output of a hashed map
is usually unordered, the output of a ordered map is always ordered, as
its name implies.</p>
</div>
<div class="section" id="complexity">
<h4>Complexity<a class="headerlink" href="#complexity" title="Permalink to this headline">¶</a></h4>
<p>Hashed maps are generally the fastest data structure available to you in
Ada if you need to associate heterogeneous keys to values and search for
them quickly. In most cases, they are slightly faster than ordered maps.
Therefore, if you don’t need ordering, prefer hashed maps.</p>
<p>According to the Reference Manual, this is the average complexity of some
operations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="35%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operations</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">Ordered_Maps</span></code></th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">Hashed_Maps</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>Insert</li>
<li>Include</li>
<li>Replace</li>
<li>Delete</li>
<li>Exclude</li>
<li>Find</li>
</ul>
</td>
<td>O(<span class="math notranslate">\((log N)^2)\)</span>
or better</td>
<td><span class="math notranslate">\(O(log N)\)</span></td>
</tr>
<tr class="row-odd"><td>Subprogram using
cursor</td>
<td>O(<span class="math notranslate">\(1\)</span>)</td>
<td>O(<span class="math notranslate">\(1\)</span>)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="dates-times">
<h2>Dates &amp; Times<a class="headerlink" href="#dates-times" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="strings">
<h2>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="files-and-streams">
<h2>Files and streams<a class="headerlink" href="#files-and-streams" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="dynamic-allocation-and-reclamation">
<h2>Dynamic allocation and reclamation<a class="headerlink" href="#dynamic-allocation-and-reclamation" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="appendices">
<h1>Appendices<a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="appendix-a-generic-formal-types">
<h2>Appendix A: Generic Formal Types<a class="headerlink" href="#appendix-a-generic-formal-types" title="Permalink to this headline">¶</a></h2>
<p>The following reference tables contain examples of available formal types
for generics.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="55%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Formal Type</th>
<th class="head">Format</th>
<th class="head">Actual type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Incomplete type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type</td>
</tr>
<tr class="row-odd"><td>Incomplete type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;);</span></span></code></td>
<td>Any type</td>
</tr>
<tr class="row-even"><td>Discrete type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;);</span></span></code></td>
<td>Any integer, modular or
enumeration type</td>
</tr>
<tr class="row-odd"><td>Range type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">range</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
<td>Any signed integer type</td>
</tr>
<tr class="row-even"><td>Modular type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="operator word"><span class="pre">mod</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
<td>Any modular type</td>
</tr>
<tr class="row-odd"><td>Floating-point type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">digits</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
<td>Any floating-point type</td>
</tr>
<tr class="row-even"><td>Binary fixed-point type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">delta</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
<td>Any binary fixed-point
type</td>
</tr>
<tr class="row-odd"><td>Decimal fixed-point
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">delta</span></span> <span class="punctuation"><span class="pre">&lt;&gt;</span></span> <span class="keyword reserved"><span class="pre">digits</span></span> <span class="punctuation"><span class="pre">&lt;&gt;;</span></span></code></td>
<td>Any decimal fixed-point
type</td>
</tr>
<tr class="row-even"><td>Definite nonlimited
private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any nonlimited,
definite type</td>
</tr>
<tr class="row-odd"><td>Indefinite nonlimited
private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any nonlimited type
indefinite or definite</td>
</tr>
<tr class="row-even"><td>Unlimited private type
with discriminant</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="name variable"><span class="pre">D</span></span> <span class="punctuation"><span class="pre">:</span> </span><span class="name variable"><span class="pre">DT</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any nonlimited type
with discriminant</td>
</tr>
<tr class="row-odd"><td>Access type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">A</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">access</span></span> <span class="name"><span class="pre">T</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any access type for
type T</td>
</tr>
<tr class="row-even"><td>Definite derived
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete type
derived from base type
B</td>
</tr>
<tr class="row-odd"><td>Limited private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any definite type,
limited or not</td>
</tr>
<tr class="row-even"><td>Incomplete tagged
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete, definite,
tagged type</td>
</tr>
<tr class="row-odd"><td>Definite
tagged private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete, definite,
tagged type</td>
</tr>
<tr class="row-even"><td>Definite
tagged limited private
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete definite
tagged type, limited or
not</td>
</tr>
<tr class="row-odd"><td>Definite abstract
tagged private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any nonlimited,
definite tagged type,
abstract or concrete</td>
</tr>
<tr class="row-even"><td>Definite abstract
tagged limited private
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any definite tagged
type, limited or not,
abstract or concrete</td>
</tr>
<tr class="row-odd"><td>Definite derived
tagged type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete tagged
type derived from base
type B</td>
</tr>
<tr class="row-even"><td>Definite abstract
derived tagged type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any tagged
type derived from base
type B
abstract or concrete</td>
</tr>
<tr class="row-odd"><td>Array type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">A</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">array</span></span> <span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">R</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="keyword reserved"><span class="pre">of</span></span> <span class="name"><span class="pre">T</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any array type with
range R containing
elements of type T</td>
</tr>
<tr class="row-even"><td>Interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">interface</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any interface type T</td>
</tr>
<tr class="row-odd"><td>Limited
interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword reserved"><span class="pre">interface</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any limited interface
type T</td>
</tr>
<tr class="row-even"><td>Task interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">task</span></span> <span class="keyword reserved"><span class="pre">interface</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any task interface
type T</td>
</tr>
<tr class="row-odd"><td>Synchronized interface
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">synchronized</span></span> <span class="keyword reserved"><span class="pre">interface</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any synchronized
interface type T</td>
</tr>
<tr class="row-even"><td>Protected interface
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword declaration"><span class="pre">protected</span></span> <span class="keyword reserved"><span class="pre">interface</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any protected
interface type T</td>
</tr>
<tr class="row-odd"><td>Derived interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
base type B and
interface I</td>
</tr>
<tr class="row-even"><td>Derived type
with multiple
interfaces</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I1</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I2</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
base type B and
interfaces I1 and I2</td>
</tr>
<tr class="row-odd"><td>Abstract derived
interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
abstract base type B
and interface I</td>
</tr>
<tr class="row-even"><td>Limited derived
interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
limited base type B and
limited interface I</td>
</tr>
<tr class="row-odd"><td>Abstract limited
derived interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">and</span></span> <span class="name"><span class="pre">I</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
abstract limited base
type B and limited
interface I</td>
</tr>
<tr class="row-even"><td>Synchronized interface
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">synchronized</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">SI</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
synchronized interface
SI</td>
</tr>
<tr class="row-odd"><td>Abstract synchronized
interface type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">synchronized</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">SI</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type T derived from
synchronized interface
SI</td>
</tr>
</tbody>
</table>
<div class="section" id="indefinite-version">
<h3>Indefinite version<a class="headerlink" href="#indefinite-version" title="Permalink to this headline">¶</a></h3>
<p>Many of the examples above can be used for formal indefinite types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="55%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Formal Type</th>
<th class="head">Format</th>
<th class="head">Actual type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Indefinite limited
private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any type, limited or
not, indefinite or
definite</td>
</tr>
<tr class="row-odd"><td>Incomplete indefinite
tagged private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete tagged
type,
indefinite or definite</td>
</tr>
<tr class="row-even"><td>Indefinite
tagged private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete, limited
tagged type,
indefinite or definite</td>
</tr>
<tr class="row-odd"><td>Indefinite
tagged limited private
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any concrete tagged
type, limited or not,
indefinite or definite</td>
</tr>
<tr class="row-even"><td>Indefinite abstract
tagged private type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any nonlimited tagged
type, indefinite or
definite, abstract or
concrete</td>
</tr>
<tr class="row-odd"><td>Indefinite abstract
tagged limited private
type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">tagged</span></span> <span class="keyword reserved"><span class="pre">limited</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any tagged type,
limited or not,
indefinite or definite
abstract or concrete</td>
</tr>
<tr class="row-even"><td>Indefinite derived
tagged type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any tagged type derived
from base type B,
indefinite or definite</td>
</tr>
<tr class="row-odd"><td>Indefinite abstract
derived tagged type</td>
<td><code class="code ada docutils literal notranslate"><span class="keyword declaration"><span class="pre">type</span></span> <span class="keyword type"><span class="pre">T</span></span> <span class="punctuation"><span class="pre">(&lt;&gt;)</span></span> <span class="keyword reserved"><span class="pre">is</span></span> <span class="keyword reserved"><span class="pre">abstract</span></span> <span class="keyword reserved"><span class="pre">new</span></span> <span class="name"><span class="pre">B</span></span> <span class="keyword reserved"><span class="pre">with</span></span> <span class="keyword declaration"><span class="pre">private</span></span><span class="punctuation"><span class="pre">;</span></span></code></td>
<td>Any tagged type derived
from base type B,
indefinite or definite
abstract or concrete</td>
</tr>
</tbody>
</table>
<p>The same examples could also contain discriminants. In this case, <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">(&lt;&gt;)</span></span></code>
is replaced by a list of discriminants, e.g.: <code class="code ada docutils literal notranslate"><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">D</span></span><span class="punctuation"><span class="pre">:</span></span> <span class="name"><span class="pre">DT</span></span><span class="punctuation"><span class="pre">)</span></span></code>.</p>
</div>
</div>
<div class="section" id="appendix-b-containers">
<h2>Appendix B: Containers<a class="headerlink" href="#appendix-b-containers" title="Permalink to this headline">¶</a></h2>
<p>The following reference table shows all containers available in Ada,
including their versions (standard, bounded, unbounded, indefinite).</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="43%" />
<col width="6%" />
<col width="11%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Container</th>
<th class="head">Std</th>
<th class="head">Bounded</th>
<th class="head">Unbounded</th>
<th class="head">Indefinite</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Vector</td>
<td><code class="docutils literal notranslate"><span class="pre">Vectors</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>List</td>
<td><code class="docutils literal notranslate"><span class="pre">Doubly_Linked_Lists</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>Map</td>
<td><code class="docutils literal notranslate"><span class="pre">Hashed_Maps</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>Map</td>
<td><code class="docutils literal notranslate"><span class="pre">Ordered_Maps</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>Set</td>
<td><code class="docutils literal notranslate"><span class="pre">Hashed_Sets</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>Set</td>
<td><code class="docutils literal notranslate"><span class="pre">Ordered_Sets</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>Tree</td>
<td><code class="docutils literal notranslate"><span class="pre">Multiway_Trees</span></code></td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-odd"><td>Generic</td>
<td><code class="docutils literal notranslate"><span class="pre">Holders</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>Queue</td>
<td><code class="docutils literal notranslate"><span class="pre">Synchronized_Queue_Interfaces</span></code></td>
<td>Y</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Queue</td>
<td><code class="docutils literal notranslate"><span class="pre">Synchronized_Queues</span></code></td>
<td>&#160;</td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Queue</td>
<td><code class="docutils literal notranslate"><span class="pre">Priority_Queues</span></code></td>
<td>&#160;</td>
<td>Y</td>
<td>Y</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The following table presents the prefixing applied to the container name
according to its version. As indicated in the table, the standard version
does not have a prefix associated with it.</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Naming prefix</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Std</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Bounded</td>
<td><code class="docutils literal notranslate"><span class="pre">Bounded_</span></code></td>
</tr>
<tr class="row-even"><td>Unbounded</td>
<td><code class="docutils literal notranslate"><span class="pre">Unbounded_</span></code></td>
</tr>
<tr class="row-odd"><td>Indefinite</td>
<td><code class="docutils literal notranslate"><span class="pre">Indefinite_</span></code></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to intro-to-ada" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Raphaël Amiard, Gustavo Hoffman.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>